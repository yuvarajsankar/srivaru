define("modules/clean/react/previews/archive/api",["require","exports","external/lodash","modules/clean/react/previews/archive/constants","modules/clean/api_v2/client","modules/clean/filepath","modules/core/exception"],function(e,t,r,i,n,s,o){"use strict";function a(e){return r.keyBy(r.values(e.map(l)),"name")}function l(e){return{name:e.name,size:void 0!==e.size?parseInt(e.size,10):void 0,isDir:e.isDir,children:e.children?a(e.children):{}}}function c(e){return{rootEntry:l(e),isPasswordProtected:!!e.isEncrypted}}function u(e){return r.keyBy(e,"subpath")}function p(e){var t=s.file_extension(e);if(!i.COMPRESSED_EXTENSIONS.includes(t))return!1;var r=s.filename_without_extension(e),n=s.file_extension(r);return!i.COMPRESSED_CONTAINER_EXTENSIONS.includes(n)}function d(e){return{isDir:!0,isEncrypted:!1,children:[{isDir:!1,isEncrypted:!1,name:s.filename_without_extension(e)}],name:"/",size:"0"}}function v(e){return new Promise(function(t,r){var i=function(e){t(c(e))};if(p(e.filename)){return void i(d(e.filename))}var n=new XMLHttpRequest;n.open("GET",e.url),n.withCredentials=!0,n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)if(200===n.status){var e=n.response,t=JSON.parse(e);i(t)}else{o.reportException({err:new Error("Failed to retrieve entry tree"),tags:["archivePreviews"],severity:o.SEVERITY.NONCRITICAL}),r("Failed to retrieve entry tree")}},n.send()})}function h(e){var t=e.rootFile,r=e.subpathInfos,i=e.user,s=e.sharedLinkUrl,o={ns_id:t.ns_id,sj_id:t.sjid,url:s},a={root_file_info:o,subpaths:r.map(function(e){return e.subpath}),subpath_sizes:r.some(function(e){return void 0===e.size})?void 0:r.map(function(e){return e.size})},l=(new n.ApiV2Client).ns("previews");return(i?l.rpc("get_archive_files",a,{subjectUserId:i.id}):l.rpc("logged_out/get_archive_files",a,{subjectUserId:null})).then(function(e){return u(e.archive_files)})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldMockRootArchiveEntry=p,t.generateRootArchiveEntry=d,t.fetchRootArchiveEntry=v,t.fetchArchiveFiles=h}),define("modules/clean/react/previews/archive/app",["require","exports","tslib","external/react","modules/clean/previews/util","modules/clean/loggers/file_preview_logger","modules/clean/react/file_viewer/logging","modules/clean/file_store/utils","modules/clean/react/file_viewer/file_preview_event_emitter","modules/clean/react/file_viewer/constants","modules/clean/file_store/utils","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/archive_entry_watcher","modules/clean/react/previews/archive/keyboard_binding_connector","modules/clean/react/previews/archive/utils","modules/clean/react/previews/archive/view","modules/clean/web_timing_logger"],function(e,t,r,i,n,s,o,a,l,c,u,p,d,v,h,f,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.onFetchSuccess=function(){if(t.markWebTiming(),t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadSucceeded),t.logFilePreviewTimeline(c.EventType.FilePreviewRenderSucceeded),t.props.entry){var e=h.scanEntryContents(t.props.entry);t.logArchivePreviewEvent(c.EventType.ArchivePreviewContentsScanned,e)}},t.onFetchFailure=function(){t.logFilePreviewTimeline(c.EventType.FilePreviewDownloadFailed),t.props.onError&&t.props.onError()},t.handleEntryRowClick=function(e,r){e.preventDefault();var i=t.props.fileSubpath,n=p.addToFileSubpath(i,r.name);t.setState({currentSubpath:n}),p.updateFileSubpathQuery(n),t.logUserAction(r,c.UserAction.ArchiveNavigation,c.UserActionContext.PreviewContentMain)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.setUpLogger(),this.logFilePreviewTimeline(c.EventType.FilePreviewSupportConfirmed),this.props.setRenderStatusSuccess(),this.fetchArchiveContents()},t.prototype.componentWillUnmount=function(){this.teardownLogger(),this.props.resetState(),p.updateFileSubpathQuery(null)},t.prototype.fetchArchiveContents=function(){if(!this.props.file.preview_url)return void(this.props.onError&&this.props.onError());this.logFilePreviewTimeline(c.EventType.FilePreviewDownloadAttempted);var e=h.getPreviewUrl(this.props.file.preview_url),t=a.getFilename(this.props.file);this.props.fetchRootArchiveEntry({url:e,filename:t},this.onFetchFailure).then(this.onFetchSuccess)},t.prototype.setUpLogger=function(){this.logger&&this.teardownLogger(),this.logger=new s.FilePreviewArchiveLogger,this.logger.listenTo(l.filePreviewEventEmitter)},t.prototype.teardownLogger=function(){this.logger.unlistenTo(l.filePreviewEventEmitter),delete this.logger},t.prototype.logFilePreviewTimeline=function(e){this.props.filePreviewSession&&this.props.filePreviewSession.recordEvent(e)},t.prototype.logArchivePreviewEvent=function(e,t){void 0===t&&(t={}),l.filePreviewEventEmitter.emit(e,this.props.filePreviewSession,t)},t.prototype.logUserAction=function(e,t,r){o.logUserAction(t,r,{isDir:e.isDir,extension:e.isDir?"":n.getWhitelistedExtension(e.name)})},t.prototype.markWebTiming=function(){this.props.filePreviewSession&&this.props.filePreviewSession.markPrimaryEvent(),m.mark_time_to_view(),m.mark_time_to_interactive()},t.prototype.render=function(){return i.createElement("div",null,i.createElement(f.View,{entry:this.props.entry,fileExtension:u.getExtension(this.props.file),isPasswordProtected:this.props.isPasswordProtected,onEntryRowClick:this.handleEntryRowClick,currentSubpath:this.state.currentSubpath}),i.createElement(d.ArchiveEntryWatcher,{file:this.props.file,fileSubpath:this.props.fileSubpath,sharedLinkUrl:this.props.sharedLinkUrl,user:this.props.user}),i.createElement(v.ArchiveKeyboardBindingConnector,{fileSubpath:this.props.fileSubpath}))},t})(i.Component);t.App=_}),define("modules/clean/react/previews/archive/archive_entry_watcher",["require","exports","tslib","external/react","external/react-redux","modules/clean/react/previews/archive/data/actions","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils"],function(e,t,r,i,n,s,o,a){"use strict";function l(e,t){var r=t.file,i=t.fileSubpath,n=u(e,{fileSubpath:i,rootFile:r});return{neededSubpathInfos:a.getNeededArchiveFileSubpathInfos(i,n).filter(function(t){return o.getShouldFetchArchiveFiles(e,{subpath:t.subpath})})}}Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fetchArchiveFiles=function(e){var r=t.props;(0,r.fetchArchiveFiles)({rootFile:r.file,subpathInfos:e,sharedLinkUrl:r.sharedLinkUrl,user:r.user})},t}return r.__extends(t,e),t.prototype.componentDidUpdate=function(){var e=this.props.neededSubpathInfos;e.length&&this.fetchArchiveFiles(e)},t.prototype.render=function(){return null},t})(i.Component);t.UnconnectedArchiveEntryWatcher=c;var u=o.makeGetArchiveEntry(),p={fetchArchiveFiles:s.fetchArchiveFiles};t.ArchiveEntryWatcher=n.connect(l,p)(c)}),define("modules/clean/react/previews/archive/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_NUM_ROWS=10,t.MAX_ROW_WIDTH_IN_EMS=17,t.COMPRESSED_EXTENSIONS=["bz","bz2","gz","lz","lzma","xz","z"],t.COMPRESSED_CONTAINER_EXTENSIONS=["tar","xar"]}),define("modules/clean/react/previews/archive/data/actions",["require","exports","modules/clean/react/previews/archive/api"],function(e,t,r){"use strict";function i(){return{type:d.GetTreeApiFetch}}function n(e){var t=e.entry,r=e.isPasswordProtected;return{type:d.GetTreeApiSuccess,payload:{entry:t,isPasswordProtected:r}}}function s(e){return{type:d.GetTreeApiError,payload:{error:e}}}function o(e){var t=e.subpaths;return{type:d.GetArchiveFilesApiFetch,meta:{subpaths:t}}}function a(e){return{type:d.GetArchiveFilesApiSuccess,payload:{archiveFiles:e}}}function l(e,t){var r=t.subpaths;return{type:d.GetArchiveFilesApiError,meta:{subpaths:r},error:e}}function c(){return{type:d.ResetState}}function u(e,t){return function(o){return o(i()),new Promise(function(i,a){r.fetchRootArchiveEntry(e).then(function(e){var t=e.rootEntry;o(n({entry:t,isPasswordProtected:e.isPasswordProtected})),i(t)}).catch(function(e){o(s(e)),t&&t(),a(e)})})}}function p(e){var t=e.rootFile,i=e.sharedLinkUrl,n=e.subpathInfos,s=e.user,c=n.map(function(e){return e.subpath});return function(e){return e(o({subpaths:c})),r.fetchArchiveFiles({rootFile:t,sharedLinkUrl:i,subpathInfos:n,user:s}).then(function(t){return e(a(t)),t}).catch(function(t){return e(l(t,{subpaths:c})),t})}}Object.defineProperty(t,"__esModule",{value:!0});var d;(function(e){e.ResetState="ArchivePreviewResetState",e.GetTreeApiFetch="ArchivePreviewGetTreeApiFetch",e.GetTreeApiSuccess="ArchivePreviewGetTreeApiSuccess",e.GetTreeApiError="ArchivePreviewGetTreeApiError",e.GetArchiveFilesApiFetch="ArchivePreviewGetArchiveFilesApiFetch",e.GetArchiveFilesApiSuccess="ArchivePreviewGetArchiveFilesApiSuccess",e.GetArchiveFilesApiError="ArchivePreviewGetArchiveFilesApiError"})(d=t.Actions||(t.Actions={})),t.getTreeApiFetch=i,t.getTreeApiSuccess=n,t.getTreeApiError=s,t.getArchiveFilesApiFetch=o,t.getArchiveFilesApiSuccess=a,t.getArchiveFilesApiError=l,t.resetState=c,t.fetchRootArchiveEntry=u,t.fetchArchiveFiles=p}),define("modules/clean/react/previews/archive/data/reducer",["require","exports","tslib","modules/clean/react/previews/archive/data/actions","modules/clean/redux/types","external/lodash"],function(e,t,r,i,n,s){"use strict";function o(e,o){switch(void 0===e&&(e=t.initialState),o.type){case i.Actions.GetTreeApiFetch:return r.__assign({},e,{treeApiStatus:n.ApiClientStatus.Fetch});case i.Actions.GetTreeApiSuccess:return r.__assign({},e,{rootEntry:o.payload.entry,isPasswordProtected:o.payload.isPasswordProtected,treeApiStatus:n.ApiClientStatus.Success});case i.Actions.GetTreeApiError:return r.__assign({},e,{treeApiStatus:n.ApiClientStatus.Error,error:o.payload.error});case i.Actions.GetArchiveFilesApiFetch:return r.__assign({},e,{archiveFiles:r.__assign({},e.archiveFiles,o.meta.subpaths.reduce(function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Fetch},e},{}))});case i.Actions.GetArchiveFilesApiSuccess:return r.__assign({},e,{archiveFiles:r.__assign({},e.archiveFiles,s.mapValues(o.payload.archiveFiles,function(e){return{archiveFile:e,apiStatus:n.ApiClientStatus.Success}}))});case i.Actions.GetArchiveFilesApiError:return r.__assign({},e,{archiveFiles:r.__assign({},o.meta.subpaths.reduce(function(e,t){return e[t]={archiveFile:void 0,apiStatus:n.ApiClientStatus.Error,error:o.error},e},{}))});case i.Actions.ResetState:return t.initialState;default:return e}}Object.defineProperty(t,"__esModule",{value:!0}),t.initialState={archiveFiles:{},rootEntry:void 0,treeApiStatus:void 0,error:void 0},t.previewArchiveReducer=o}),define("modules/clean/react/previews/archive/data/selectors",["require","exports","external/lodash","external/reselect","modules/clean/react/previews/archive/data/utils","modules/clean/redux/types","modules/clean/redux/selectors"],function(e,t,r,i,n,s,o){"use strict";function a(e){return e[s.PREVIEW_ARCHIVE_NAMESPACE_KEY]}function l(e,t,r){var i=r.fileSubpath,s=r.rootFile;if(!e)return e;var o=i?n.walkEntryTree(e,i):e;return n.getEntryWithArchiveFiles({subpath:i,rootFile:s,entry:o,archiveFilesMap:t})}function c(){return i.createSelector([d,v,o.getOptions],l)}Object.defineProperty(t,"__esModule",{value:!0}),t.getEncryptedStatus=function(e){return a(e).isPasswordProtected};var u=function(e,t){var r=a(e).archiveFiles;if(r)return r[t]},p=function(e,t){var r=t.subpath,i=u(e,r);if(i)return i.apiStatus},d=r.flow(a,r.property("rootEntry")),v=r.flow(a,function(e){return r.get(e,"archiveFiles",{})});t.makeGetArchiveEntry=c,t.getShouldFetchArchiveFiles=function(e,t){var r=t.subpath;if(!r)return!1;var i=p(e,{subpath:r});return!i||![s.ApiClientStatus.Fetch,s.ApiClientStatus.Error].includes(i)},t.isErrorStateForSubpath=function(e,t){var r=t.subpath;return!!r&&p(e,{subpath:r})===s.ApiClientStatus.Error}}),define("modules/clean/react/previews/archive/data/store",["require","exports","modules/clean/react/previews/archive/data/reducer","modules/clean/redux/types","modules/clean/redux/store"],function(e,t,r,i,n){"use strict";function s(){return o||(o=n.getStoreAndRegisterReducers((e={},e[i.PREVIEW_ARCHIVE_NAMESPACE_KEY]=r.previewArchiveReducer,e))),o;var e}Object.defineProperty(t,"__esModule",{value:!0});var o;t.getStoreForPreviewArchive=s}),define("modules/clean/react/previews/archive/data/utils",["require","exports","tslib","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/react/previews/archive/utils"],function(e,t,r,i,n,s){"use strict";function o(e,t){for(var r=t.substring(1).split("/"),i=e,s="";r.length;){var o=r.shift(),a=o?i.children[o]:void 0;if(!a)return s!==t&&n.updateFileSubpathQuery(s),i;i=a,s+="/"+o}return i}function a(e){var t=e.subpath,i=e.entry,n=e.rootFile,o=e.archiveFilesMap;if(i.isDir||!t)return i;var a=o[t]&&o[t].archiveFile;return r.__assign({},i,{file:s.createFileFromEntryAndApi(i,n,a)})}function l(e){var t=e.subpath,s=e.entry,o=e.rootFile,l=e.archiveFilesMap,c=i.mapValues(s.children,function(e,r){return a({subpath:n.addToFileSubpath(t,r),entry:e,rootFile:o,archiveFilesMap:l})});return r.__assign({},s,{children:c})}function c(e){return e.entry.isDir?l(e):a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.walkEntryTree=o,t.getEntryWithArchiveFiles=c}),define("modules/clean/react/previews/archive/entry_row",["require","exports","tslib","external/react","spectrum/file_icon","spectrum/icon_content","spectrum/media_table","modules/clean/display_format","modules/clean/em_string","modules/clean/react/previews/archive/constants","modules/clean/react/previews/archive/utils","modules/clean/react/thumbnail"],function(e,t,r,i,n,s,o,a,l,c,u,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e,t.props.entry)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,r=t.entry,n=t.shouldHideSize,s=t.topOffset;return this.props.onClick?i.createElement(o.CulledMediaRow,{topOffset:s,onClick:this.handleClick,doubleLine:!0},function(t){return v({entry:r,highlight:t.isHovered,onClick:e.handleClick,shouldHideSize:n})}):i.createElement(o.CulledMediaRow,{topOffset:s,doubleLine:!0},v({entry:r,shouldHideSize:n}))},t})(i.Component);t.EntryRow=d;var v=function(e){var t=e.entry,r=e.onClick,n=e.highlight,s=e.shouldHideSize,u=l.Emstring.em_snippet(t.name,c.MAX_ROW_WIDTH_IN_EMS),p=[i.createElement(o.MediaCell,{key:"rowname",title:r?i.createElement("button",{className:"entry-row-button",onClick:r,"aria-label":t.name},u):u,icon:i.createElement(h,{displayName:t.name,file:t.file,isDir:t.isDir}),highlight:n})];return t.size&&!s&&p.push(i.createElement(o.MediaCell,{key:"rowsize",title:a.format_bytes(t.size)})),p},h=function(e){return e.isDir?i.createElement(s.IconContent,{name:"folder-small"}):e.file&&u.shouldAllowVisualFolderIcons()?i.createElement(p.ThumbnailIcon,{className:"entry-row-icon",file:e.file,alt:e.displayName}):i.createElement(n.FileIcon,{path:e.displayName})}}),define("modules/clean/react/previews/archive/file_entry_view",["require","exports","external/react","external/classnames","modules/clean/react/file_viewer/data/selectors","modules/clean/react/previews/loading_indicator","modules/clean/react/file_viewer/file_preview","modules/clean/react/file_viewer/constants","modules/clean/react/size_class/size_class","modules/clean/react/previews/constants","modules/clean/previews/constants","external/react-redux","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/utils","modules/clean/react/size_class/constants"],function(e,t,r,i,n,s,o,a,l,c,u,p,d,v,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PreviewTypeWhitelist=[u.PreviewType.Doc,u.PreviewType.Excel,u.PreviewType.HTML,u.PreviewType.Photo,u.PreviewType.Text],t._FileEntryView=function(e){var i=e.entry,n=e.isErrorState,s=e.isFullscreen,l=e.isSidebarOpen,u=e.sizeClass,p=i.file,d=u!==h.SizeClass.Small,f={canCopyToDropboxRoles:[],canDownloadRoles:[],canPrintRoles:[],canRemoveLinkUids:[],canSyncToDropboxRoles:[],canViewContextMenuRoles:[],canViewMetadataRoles:[]};return p?r.createElement(o.FilePreviewWithLogging,{file:p,isFullscreen:s,isSidebarOpen:l,sourceAction:c.PreviewSourceAction.Click,sourceContext:c.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:a.SizeClassFilenameLengthMap[u],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:f,shouldDisplayToolbar:d,sizeClass:u}):n?r.createElement(o.FilePreview,{file:v.createFileFromEntry(i),isFullscreen:s,isSidebarOpen:l,sourceAction:c.PreviewSourceAction.Click,sourceContext:c.PreviewSourceContext.ArchiveFile,maxFilenameEmLength:a.SizeClassFilenameLengthMap[u],previewTypeWhitelist:t.PreviewTypeWhitelist,sharePermission:f,shouldDisplayToolbar:d,sizeClass:u}):r.createElement(m,null)};var f=l.withSizeClass(t._FileEntryView,{responsiveClassName:"preview-content--full-height"});t.FileEntryView=p.connect(function(e,t){return{isFullscreen:n.getIsFullScreen(e),isSidebarOpen:n.getIsSidebarOpen(e),isErrorState:d.isErrorStateForSubpath(e,{subpath:t.currentSubpath})}})(f);var m=function(){return r.createElement("div",{className:i("preview-content","preview-content--center","preview-content--full-height")},r.createElement(s.LoadingIndicator,null))}}),define("modules/clean/react/previews/archive/folder_entry_view",["require","exports","tslib","external/react","external/classnames","external/lodash","spectrum/icon_content","spectrum/dimensions","spectrum/table","modules/clean/react/previews/archive/entry_row","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/core/i18n"],function(e,t,r,i,n,s,o,a,l,c,u,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FolderEntryView=function(e){var t=e.entry,r=e.onEntryRowClick,n=e.shouldAllowFileNavigation,o=s.values(t.children);return o.length?i.createElement(h,{entries:o,onRowClick:r,shouldAllowFileNavigation:n}):i.createElement(f,null)};var v=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderEntryRow=function(e,r,n){var s=t.props.shouldAllowFileNavigation||e.isDir?t.props.onRowClick:void 0;return i.createElement(c.EntryRow,{entry:e,onClick:s,shouldHideSize:t.props.sizeClass===p.SizeClass.Small,topOffset:n})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this;return i.createElement(a.Dimensions,{className:"preview-archive__table"},function(t){var r=(t.width,t.height);return i.createElement(l.Table,null,i.createElement(l.FixedTableHead,null,i.createElement(l.TableHeadCell,null,d._("Name")),e.props.sizeClass===p.SizeClass.Small?null:i.createElement(l.TableHeadCell,null,d._("Size"))),i.createElement(l.CulledTableBody,{items:e.props.entries,listItemHeight:72,renderRow:e.renderEntryRow,viewportHeight:r,shouldUseWindowAsScrollContainer:!1}))})},t})(i.Component),h=u.withSizeClass(v,{responsiveClassName:"preview-content--full-height"}),f=function(){return i.createElement("div",{className:n("preview-content","preview-content--center","preview-content--column","preview-content--full-height","preview-archive--empty")},i.createElement(o.IconContent,{name:"folder-small"}),i.createElement("div",{className:"empty-text u-pad-top-s"},d._("This folder is empty")))}}),define("modules/clean/react/previews/archive/keyboard_binding_connector",["require","exports","tslib","external/react","modules/clean/keycode","modules/clean/react/file_viewer/location_utils","modules/clean/react/keyboard_binding/keyboard_binding","modules/clean/react/keyboard_binding/keyboard_binding_connector"],function(e,t,r,i,n,s,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleKeyPress=function(e){var r=s.shortenFileSubpathBy(t.props.fileSubpath,1);return s.updateFileSubpathQuery(r),!0},t.keyboardBindings=[{keyboardEventCriteria:o.generateUnmodifiedKeyboardEventCriteria(n.KeyCode.ESC),callback:t.handleKeyPress}],t}return r.__extends(t,e),t.prototype.render=function(){return i.createElement(a.KeyboardBindingConnector,{keyboardBindings:this.keyboardBindings})},t})(i.Component);t.ArchiveKeyboardBindingConnector=l}),define("modules/clean/react/previews/archive/preview_archive",["require","exports","tslib","external/react","external/react-redux","modules/clean/react/previews/archive/app","modules/clean/react/previews/archive/data/selectors","modules/clean/react/previews/archive/data/store","modules/clean/react/previews/archive/data/actions","modules/clean/react/css"],function(e,t,r,i,n,s,o,a,l,c){"use strict";function u(e,t){return{entry:p(e,{fileSubpath:t.fileSubpath,rootFile:t.file}),isPasswordProtected:o.getEncryptedStatus(e)}}Object.defineProperty(t,"__esModule",{value:!0});var p=o.makeGetArchiveEntry(),d={fetchRootArchiveEntry:l.fetchRootArchiveEntry,resetState:l.resetState},v=n.connect(u,d)(s.App),h=a.getStoreForPreviewArchive(),f=function(e){return i.createElement(n.Provider,{store:h},i.createElement(v,r.__assign({},e)))},m=c(f,["/static/css/preview_archive-vfl0t4JZm.css"]);t.PreviewArchive=m}),define("modules/clean/react/previews/archive/utils",["require","exports","external/lodash","modules/clean/react/file_viewer/location_utils","modules/clean/previews/util","modules/constants/file_viewer","modules/core/uri"],function(e,t,r,i,n,s,o){"use strict";function a(e){var t=o.URI.parse(e.toString()),r=t.toString();return"//"===r.slice(0,2)&&(r="https:"+r),r}function l(e){var t=s.DOCPREVIEW_ARCHIVE;return!("M"!==t[0]||t.length<2)&&parseInt(t.substring(1),10)>=e}function c(e){for(var t={},i=[e];i.length;){var s=i.shift();if(s.isDir)i.push.apply(i,r.values(s.children));else{var o=n.getWhitelistedExtension(s.name);t[o]=++t[o]||1}}return t}function u(e,t){return{subpath:e.name,is_dir:!1,filename:e.name,ns_id:r.get(t,"ns_id"),sjid:r.get(t,"sjid"),bytes:e.size,beacon_context:void 0,preview_type:null,sort_key:void 0,href:void 0,ts:void 0,file_id:void 0,revision_id:void 0,is_symlink:!1}}function p(e,t,r){if(r)return{beacon_context:void 0,bytes:e.size,direct_blockserver_link:r.direct_blockserver_link,file_id:void 0,filename:r.filename,href:void 0,htmlified_link:r.htmlified_link,is_dir:!1,ns_id:t.ns_id,preview_ssr_image_url_tmpl:r.preview_ssr_image_url_tmpl,preview_ssr_refresh_url:r.preview_ssr_refresh_url,preview_ssr_text_url_tmpl:r.preview_ssr_text_url_tmpl,preview_thumbnail_url:r.preview_thumbnail_url,preview_type:r.preview_type?r.preview_type:null,preview_url:r.preview_url,revision_id:void 0,sjid:t.sjid,sort_key:void 0,subpath:r.subpath,thumbnail_url_tmpl:r.thumbnail_url_tmpl,ts:void 0,is_symlink:!1}}function d(e,t){return t?t.isDir||t.file||!e?r.values(t.children).filter(function(e){return!e.isDir&&!e.file}).map(function(t){return{subpath:i.addToFileSubpath(e,t.name),size:t.size}}):[{subpath:e,size:t.size}]:[]}Object.defineProperty(t,"__esModule",{value:!0}),t.getPreviewUrl=a,t.checkVariantVersion=l,t.shouldAllowVisualFolderIcons=function(){return l(4)},t.scanEntryContents=c,t.createFileFromEntry=u,t.createFileFromEntryAndApi=p,t.getNeededArchiveFileSubpathInfos=d}),define("modules/clean/react/previews/archive/view",["require","exports","external/react","spectrum/media_table_skeleton","spectrum/snackbar","modules/clean/react/async/loadable","modules/clean/react/previews/archive/folder_entry_view","modules/clean/react/previews/archive/constants","modules/core/i18n"],function(e,t,r,i,n,s,o,a,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.Loadable({loader:function(){return new Promise(function(t,r){e(["modules/clean/react/previews/archive/file_entry_view"],t,r)}).then(function(e){return e.FileEntryView})}});t.View=function(e){var t=e.entry,i=e.fileExtension,s=e.isPasswordProtected,o=e.onEntryRowClick;return r.createElement("div",{className:"preview-archive"},r.createElement("div",{className:"preview-archive__content"},t?r.createElement(u,{entry:t,shouldAllowFileNavigation:!s,onEntryRowClick:o}):r.createElement(p,null),s?r.createElement(n.Snackbar,{title:l._("Can’t preview items in password-protected %(extension)s files.",{comment:"Like 'Can’t preview items in password-protected .zip files.'"}).format({extension:"."+i}),variant:"warn"}):null))};var u=function(e){return e.entry.isDir?r.createElement(o.FolderEntryView,{entry:e.entry,onEntryRowClick:e.onEntryRowClick,shouldAllowFileNavigation:e.shouldAllowFileNavigation}):r.createElement(c,{entry:e.entry,currentSubpath:e.currentSubpath})},p=function(){return r.createElement("div",{className:"preview-archive__table"},r.createElement(i.MediaTableSkeleton,{numRows:a.DEFAULT_NUM_ROWS}))}});
//# sourceMappingURL=pkg-file_viewer_archive.min.js-vflP2MAlz.map