define("modules/clean/account_page/tabs/billing",["require","exports","tslib","modules/clean/event_handler","modules/core/browser","modules/clean/payments/billing_info_modal","modules/clean/dbmodal_stack","modules/clean/deprecated/dbmodal_loading","external/react","external/react-redux","modules/clean/react/css","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/account_page/util","modules/clean/teams/admin/lib/billing_history","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader","modules/clean/growth/rebill_upsell/rebill_upsell_top_notification","modules/clean/account_page/components/key_value_block","modules/clean/account_page/widgets/billing/views/license_keys","modules/clean/account_page/components/loading","modules/clean/payments/skus/constants","modules/constants/trademark","modules/clean/analytics","modules/clean/payments/skus/subscription_status","modules/clean/account_page/widgets/billing/views/invoice_details","modules/clean/account_page/widgets/billing/views/billing_history"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C,T,N,x,I,k,L,A,D,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var B=function(e,t){return{browserUpdateRequired:t.browserUpdateRequired,billingInfo:e.billingInfo.billingInfo,loadingState:e.billingInfo.loadingState,dataLoadedForTTI:"ready"===e.billingInfo.loadingState}},O=function(e){return{loadBillingInfo:function(t){return void 0===t&&(t=!1),e(g.loadDataIfNecessary(t))},loadPlanDataIfNecessary:function(t){return void 0===t&&(t=!1),e(f.loadDataIfNecessary(t))},loadEvhInfoIfNecessary:function(t){return void 0===t&&(t=!1),e(b.loadEvhInfoIfNecessary(t))}}},R=(function(e){function t(t){var a=e.call(this,t)||this;return a.browserUpdateRequired=function(){return!!a.props.browserUpdateRequired&&(y.BrowserUpdateModalLoader.showInstance(),!0)},a.handlePaymentUpdate=function(){a.browserUpdateRequired()||(L.ProEventsLogger.log("de_billing_tab_update_payment_method_click"),a.props.billingInfo.scheduled_for_downgrade?S.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):w.IndividualUpdateBillingModalLoader.showInstance())},a.handlePaymentAdd=function(){a.browserUpdateRequired()||(L.ProEventsLogger.log("de_billing_tab_add_payment_method_click"),l.DBModalStack.push(new o({element_id:"add_billing_info",endpoint_url:"/add_billing_info_modal",html_in_error_msg:!0})))},a.handlePaymentAddToResubscribe=function(){a.browserUpdateRequired()||(L.ProEventsLogger.log("de_billing_tab_add_payment_method_resubscribe_click"),l.DBModalStack.push(new o({element_id:"update_billing_info",endpoint_url:"/billing_info_modal",html_in_error_msg:!0,parameters:{resubscribe:!0}})))},a.reloadData=function(){var e=a.props,t=e.loadBillingInfo,n=e.loadPlanDataIfNecessary,i=e.loadEvhInfoIfNecessary;t(!0),i(!0),n(!0)},a.handleBillingChange=function(){L.ProEventsLogger.log("de_billing_tab_change_billing_modal_open");var e=a.props.billingInfo,t=e.payment_info;e.scheduled_for_downgrade?S.CancelChangesModalConfirmation.showInstance({transitionPerformed:a.reloadData,subStatus:a.subStatus}):v.ChangeScheduleModalView.showInstance({transitionPerformed:a.reloadData,paymentInfo:t,browserUpdateRequired:a.props.browserUpdateRequired})},a.handleRebillUpsell=function(e){e&&(e.showChangePlanConfirm&&E.ChangePlanModalView.showInstance({mode:E.ChangePlanMode.CONFIRM,transitionPerformed:a.reloadData}),e.showProUpsell&&C.showRebillUpsellTopNotification())},a.onEditInvoiceDetailsClick=function(){L.ProEventsLogger.log("de_billing_tab_edit_invoice_modal_open"),P.EditInvoiceAddressModalLoader.showUpdateTaxProfileModal(!1,a.onInvoiceDetailsUpdated)},a.onInvoiceDetailsUpdated=function(){a.props.loadBillingInfo(!0)},a.renderLicenseKeys=function(){return s.createElement("div",{className:"account-page-block"},s.createElement(N.LicenseKeys,{licenseKeys:a.props.billingInfo.license_keys}))},a.renderBillingHistory=function(){var e=a.props.billingInfo,t=e.transactions,n=e.show_edit_invoice_modal,i=e.edit_past_invoices,r=n&&i,l=!1;if(null!==t&&t.transactions.length>0){l=h.getHistoryData(t.transactions).length>3}return s.createElement(M.BillingHistory,{showEditInvoiceModal:r,transactions:t.transactions,filters:t.filters,hasMore:l})},a.renderPaymentMethod=function(){if(a.user.paid){var e=a.props.billingInfo.payment_info,t=e.gateway_id,n=e.expiration_date,i=e.description,r=e.is_reseller_billing,l=e.end_date,o=e.deactivated,c=e.is_on_trial,u=e.reseller_name,p=e.reseller_link;if(r){var m=d._("Go to %(reseller_name)s to view or make changes to your account details").format({reseller_name:u}),h=s.createElement("a",{href:p,target:"_blank",rel:"noopener noreferrer"},m);return s.createElement(T.KeyValueBlock,{keyText:h})}if(t!==-1){if(!_.shouldHidePaymentMethod(t)&&!a.props.billingInfo.payment_method)return s.createElement(T.KeyValueBlock,{className:"add-payment",keyText:d._("You can add your payment information now to have           your subscription automatically renew when it expires"),linkText:d._("Add"),onLinkClick:a.handlePaymentAddToResubscribe});if(_.isLicenseKey(t))return s.createElement("div",{className:"account-page-block"},s.createElement(T.KeyValueBlock,{keyText:d._("Payment method"),subtext:d._("Add your payment information now to have           your subscription automatically renew when it expires"),linkText:d._("Add payment method"),onLinkClick:a.handlePaymentAdd}));if(_.shouldHidePaymentMethod(t)){var g=_.getPaymentMethodDisabledMessage(t,r,k.TRADEMARK_PLUS,l,o,c);return s.createElement(T.KeyValueBlock,{keyText:g})}var f=i;return null!==n&&(f=d._("%(payment_description)s, exp: %(expiration_date)s").format({payment_description:i,expiration_date:n,comment:'Payment description is a card information, already translated           (ex> Visa ending in 2543). Date is in format MM / YYYY ( ex> 08 / 2017 ).           An example translated string is "Visa ending in 2543, exp: 08 / 2017 ).'})),s.createElement(T.KeyValueBlock,{keyText:d._("Payment method"),valueText:f,linkText:d._("Update"),onLinkClick:a.handlePaymentUpdate})}}},a.renderBillingPeriod=function(){if(a.user.paid){var e=a.props.billingInfo,t=e.payment_info,n=e.scheduled_for_downgrade;if(!_.shouldHideBillingChange(t.gateway_id,t.is_reseller_billing)&&t.period){if(!t.schedule_switchable&&!n&&!a.isProfessionalTrialPlan)return s.createElement(T.KeyValueBlock,{keyText:d._("Sorry, you cannot change your billing schedule at this time.")});var i=d._("Plan billed %(period)s").format({period:t.period});return s.createElement(T.KeyValueBlock,{keyText:d._("Billing period"),valueText:i,linkText:d._("Change"),onLinkClick:a.handleBillingChange,disabled:t&&t.is_in_grace_period})}}},a.renderInvoiceDetails=function(){var e=a.props.billingInfo,t=e.show_edit_invoice_modal,n=e.payment_info,i=e.payment_method,r=e.has_invoice_details;if(a.user.paid&&t&&!_.shouldHideBillingChange(n.gateway_id,n.is_reseller_billing)&&n.period)return s.createElement(D.InvoiceDetails,{onLinkClick:a.onEditInvoiceDetailsClick,has_invoice_details:r,country_code:i?i.country_code:void 0})},a.user=m.getCurrentUser(),l.DBModalStack.register(r.BILLING_INFO_UPDATED,function(e,t){L.ProEventsLogger.log("de_payment_modal_save_click"),a.props.loadBillingInfo(!0),a.props.loadPlanDataIfNecessary(!0),a.handleRebillUpsell(t)}),a}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.loadBillingInfo(),this.checkTTIstate(),L.ProEventsLogger.log("de_billing_tab_view"),this.events.on(window,"hashchange",function(){e.displayResubscribeBillingModal(),e.displayUpdateBillingModal()}),this.displayResubscribeBillingModal(),this.displayUpdateBillingModal();var t=i.get_hash(),a=i.get_uri().getQuery().exp_renewals_pro_mobile_payment_page;void 0!==t&&t.search("billing_info")!==-1&&t.search("resubscribe_billing_info")===-1&&i.is_supported_mobile_browser()&&["V1","V2"].includes(a)&&L.ProEventsLogger.log("exp_renewals_pro_mobile_payment_page_"+a)},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.displayUpdateBillingModal=function(){var e=i.get_hash();if(void 0!==e&&e.search("billing_info")!==-1&&e.search("resubscribe_billing_info")===-1){if(!this.user.paid)return;if(this.browserUpdateRequired())return;w.IndividualUpdateBillingModalLoader.showInstance()}},t.prototype.displayResubscribeBillingModal=function(){var e=i.get_hash();if(void 0!==e&&e.search("resubscribe_billing_info")!==-1){if(this.browserUpdateRequired())return;w.IndividualUpdateBillingModalLoader.showInstance()}},Object.defineProperty(t.prototype,"subStatus",{get:function(){var e=this.props.billingInfo.serialized_sub_status;if(e)return A.SubscriptionStatus.deserialize(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&this.subStatus.subState.plan.productType===I.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!0,configurable:!0}),t.prototype.checkTTIstate=function(){this.props.dataLoadedForTTI&&(p.mark_time_to_view(),p.mark_time_to_interactive())},t.prototype.isLoading=function(){return"ready"!==this.props.loadingState},t.prototype.render=function(){return this.isLoading()?s.createElement(x.Loading,null):s.createElement("div",{className:"account-page-tab"},this.renderPaymentMethod(),this.renderBillingPeriod(),this.renderInvoiceDetails(),this.renderLicenseKeys(),this.renderBillingHistory())},t=a.__decorate([n.eventHandler],t)})(s.Component),U=c.connect(B,O)(R);t.BillingTab=u(U,["/static/css/account/pagelet/billing_tab-vflAaq25-.css","/static/css/plan_management-vflKGEz1N.css"])}),define("modules/clean/account_page/tabs/plan",["require","exports","tslib","external/react","modules/clean/account_page/widgets/plan/views/plan_container"],function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.createElement(i.PlanContainer,{browserUpdateRequired:this.props.browserUpdateRequired})},t})(n.Component);t.PlanTab=r}),define("modules/clean/account_page/widgets/billing/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/billing/api","modules/clean/account_page/util"],function(e,t,a,n,i){"use strict";function r(e){var t=this;return void 0===e&&(e=!1),function(r,l){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return"never_loaded"===l().billingInfo.loadingState||e?(r({type:"billing_info_load"}),[4,n.getBillingInfo(i.getCurrentUser().id)]):[3,2];case 1:return t=a.sent(),r({type:"billing_info_loaded",billingInfo:t}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=r}),define("modules/clean/account_page/widgets/billing/api",["require","exports","modules/clean/ajax_as_promised"],function(e,t,a){"use strict";function n(e){return a.WebRequest({url:"/account/ajax_billing_tab_model",subject_user:e,dataType:"json"})}Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingInfo=n}),define("modules/clean/account_page/widgets/billing/billing_history/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,a,n){"use strict";function i(e,t,i,r){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){return[2,n.WebRequest({url:"/account/ajax_load_more_billing_history/",data:{block:t,filter_type:i,filter_change:r},subject_user:e,dataType:"json"})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getBillingHistory=i}),define("modules/clean/account_page/widgets/billing/billing_history/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.BillingHistoryOrder||(t.BillingHistoryOrder={}))}),define("modules/clean/account_page/widgets/billing/views/billing_history",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/account_page/util","modules/clean/teams/admin/widgets/billing_history/billing_history_table","modules/clean/teams/admin/lib/billing_history","modules/clean/analytics","modules/clean/account_page/widgets/billing/billing_history/api","modules/clean/account_page/widgets/billing/billing_history/types","modules/clean/static_urls"],function(e,t,a,n,i,r,l,o,s,c,u,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(t){var n=e.call(this,t)||this;return n.loadMoreBillingHistory=function(e){return a.__awaiter(n,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return this.setState({isLoading:!0}),s.ProEventsLogger.log("de_billing_history_view_more_click"),e.preventDefault(),[4,c.getBillingHistory(r.getCurrentUser().id,this.state.numBlocksLoaded,this.state.filter,!1)];case 1:return t=a.sent(),this.setState(function(e){return{transactions:e.isInitialLoad?t.transactions:e.transactions.concat(t.transactions),hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded+1,isInitialLoad:!1}}),[2,!1]}})})},n.changeFilter=function(e){return a.__awaiter(n,void 0,void 0,function(){var t,n;return a.__generator(this,function(a){switch(a.label){case 0:return this.setState({isLoading:!0,filter:e}),s.ProEventsLogger.log("de_billing_history_change_filter_click"),[4,c.getBillingHistory(r.getCurrentUser().id,this.state.numBlocksLoaded,e,!0)];case 1:return t=a.sent(),this.state.isInitialLoad&&(n=o.getHistoryData(t.transactions),t.hasMore=n.length>3),this.setState(function(e){return{transactions:t.transactions,hasMore:t.hasMore,isLoading:!1,numBlocksLoaded:e.numBlocksLoaded,isInitialLoad:e.isInitialLoad}}),[2,!1]}})})},n.changeOrder=function(){n.setState(function(e){return{order:e.order===u.BillingHistoryOrder.ASCENDING?u.BillingHistoryOrder.DESCENDING:u.BillingHistoryOrder.ASCENDING}}),s.ProEventsLogger.log("de_billing_history_change_order_click")},n.handlePopoverSelection=function(e){n.state.filter!==e&&n.state.order!==e&&(e===u.BillingHistoryOrder.ASCENDING||e===u.BillingHistoryOrder.DESCENDING?n.changeOrder():n.changeFilter(e))},n.state={transactions:n.props.transactions?n.props.transactions.slice():[],hasMore:n.props.hasMore,isLoading:!1,numBlocksLoaded:0,isInitialLoad:!0,filter:"all_time",order:u.BillingHistoryOrder.ASCENDING},n}return a.__extends(t,e),t.prototype.render=function(){return n.createElement("div",{className:"account-page-block"},n.createElement("span",{className:"account-page-block__heading"},i._("Billing history")),n.createElement("p",{className:"account-page-block__subtext"},i._("View invoices and receipts for all payments made on your Dropbox account.")),n.createElement("div",{className:"billing-table-container"},n.createElement(l.BillingHistoryTable,{billingHistoryRecords:this.getHistory(),amountLabel:i._("Amount"),displayNoTransactionsOnEmptyRecords:!0,showEditInvoiceModal:this.props.showEditInvoiceModal,noTransactionLabel:i._("No transaction history"),footer:this.buildFooter(),logAccountBillingTabEvents:!0,isTeam:!1,filter:this.state.filter,order:this.state.order,onSelection:this.handlePopoverSelection,filters:this.props.filters})))},t.prototype.getHistory=function(){var e=[];return this.state.transactions.length>0&&(e=o.getHistoryData(this.state.transactions),this.state.isInitialLoad&&(e=e.slice(0,3))),this.state.order===u.BillingHistoryOrder.ASCENDING?e:e.reverse()},t.prototype.buildFooter=function(){if(this.state.isLoading)return n.createElement("tr",{className:"billing-history-row"},n.createElement("td",{colSpan:4,className:"billing-history-col"},n.createElement("img",{src:d.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:i._("Loading")})));if(this.state.hasMore)return n.createElement("tr",{className:"billing-history-row"},n.createElement("td",{colSpan:4,className:"billing-history-col"},n.createElement("a",{href:"#",rel:"noopener noreferrer",onClick:this.loadMoreBillingHistory},i._("View more billing history"))))},t})(n.Component);t.BillingHistory=p}),define("modules/clean/account_page/widgets/billing/views/invoice_details",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/account_page/components/key_value_block","modules/clean/payments/validation"],function(e,t,a,n,i,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.country_code,a=e.has_invoice_details,o=i._("Add details to your invoice, such as company name and address.");t&&l.hasVat(t)&&(o=i._("Add details to your invoice, such as company name, address, and VAT ID."));var s=a?i._("Update"):i._("Add invoice details");return n.createElement(r.KeyValueBlock,{keyText:i._("Invoice details"),linkText:s,subtext:o,onLinkClick:this.props.onLinkClick})},t})(n.Component);t.InvoiceDetails=o}),define("modules/clean/account_page/widgets/billing/views/license_keys",["require","exports","tslib","modules/core/i18n","modules/core/browser","external/react","modules/clean/react/css","modules/clean/account_page/components/account_table","modules/clean/account_page/components/key_value_block"],function(e,t,a,n,i,r,l,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var a=e.call(this,t)||this;return a.licenseRowsIncrement=3,a.handleRedeemClick=function(){i.redirect("/pro/redeem_key")},a.buildLicenseFooter=function(){if(a.state.showViewMore)return r.createElement("tr",{className:"license-footer-row"},r.createElement("td",{colSpan:4},r.createElement("a",{onClick:a.showMoreLicense,href:"",rel:"noopener noreferrer"},n._("View more license keys"))))},a.showMoreLicense=function(e){e.preventDefault(),a.setState(function(e,t){var n=e.maxShow+a.licenseRowsIncrement;return{maxShow:n,showViewMore:n<t.licenseKeys.length}})},a.buildStatus=function(e){return e.activated?n._("Activated on %(activated_date)s").format({activated_date:e.activated_date}):n._("Scheduled for future use")},a.buildDuration=function(e){return e.duration?e.duration:n._("N/A")},a.buildLicenseKeyTable=function(){var e=a.props.licenseKeys;if(0!==e.length)return r.createElement("div",{className:"license-table-container"},r.createElement(o.Table,{className:"license-table"},r.createElement(o.TableHead,null,r.createElement(o.HeaderRow,{className:"license-header-row"},r.createElement(o.HeaderCell,{className:"license-key-header"},n._("Key")),r.createElement(o.HeaderCell,{className:"license-redeemed-header"},n._("Redeemed")),r.createElement(o.HeaderCell,{className:"license-duration-header"},n._("Duration")),r.createElement(o.HeaderCell,{className:"license-status-header"},n._("Status")))),r.createElement(o.TableFooter,{className:"license-footer"},a.buildLicenseFooter()),r.createElement(o.TableBody,null,e.map(function(e,t){if(!(t>=a.state.maxShow))return r.createElement(o.BodyRow,{className:"license-body-row "+(e.activated?"activated":"unused"),key:e.key},r.createElement(o.BodyCell,{className:"license-key"},e.key),r.createElement(o.BodyCell,{className:"license-redeemded"},e.redeemed_date),r.createElement(o.BodyCell,{className:"license-duration"},a.buildDuration(e)),r.createElement(o.BodyCell,{className:"license-status"},a.buildStatus(e)))}))))},a.state={maxShow:3,showViewMore:!1},a}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.setState(function(e,t){return{showViewMore:e.maxShow<t.licenseKeys.length}})},t.prototype.render=function(){return r.createElement("div",{className:"license-keys"},r.createElement(s.KeyValueBlock,{className:"redeem-license-key",keyText:n._("License keys"),linkText:n._("Redeem a license key"),onLinkClick:this.handleRedeemClick,subtext:n._("License keys will be applied before any other form of payment method")}),this.buildLicenseKeyTable())},t})(r.Component);t.LicenseKeys=l(c,["/static/css/account/pagelet/license_keys-vfltd2Jh8.css"])}),define("modules/clean/account_page/widgets/plan/action_creators",["require","exports","tslib","modules/clean/account_page/widgets/plan/api","modules/clean/account_page/util"],function(e,t,a,n,i){"use strict";function r(e){var t=this;return function(r,l){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return"never_loaded"===l().planTab.loadingState||e?(r({type:"plan_tab_load_info"}),[4,n.getPlanInfo(i.getCurrentUser().id)]):[3,2];case 1:return t=a.sent(),r({type:"plan_tab_info_loaded",planInfo:t}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadDataIfNecessary=r}),define("modules/clean/account_page/widgets/plan/add_ons/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/add_ons/api"],function(e,t,a,n,i){"use strict";function r(e){var t=this;return function(r,l){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return"never_loaded"===l().planTab.evhLoadingState||e?(r({type:"load_evh_info"}),[4,i.getEvhInfo(n.getCurrentUser().id)]):[3,2];case 1:return t=a.sent(),r({type:"evh_info_loaded",evhInfo:t}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadEvhInfoIfNecessary=r}),define("modules/clean/account_page/widgets/plan/add_ons/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,a,n){"use strict";function i(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,n.WebRequest({url:"/account/ajax_get_evh_info",subject_user:e,dataType:"json"})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getEvhInfo=i}),define("modules/clean/account_page/widgets/plan/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,a,n){"use strict";function i(e){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(t){return[2,n.WebRequest({url:"/account/ajax_plan_tab_model",subject_user:e,dataType:"json"})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getPlanInfo=i}),define("modules/clean/account_page/widgets/plan/constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGE_IND_PLAN_MODAL_UPDATED="change_inv_plan_modal:updated"}),define("modules/clean/account_page/widgets/plan/plan_spectrum/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/growth/gating"],function(e,t,a,n,i){"use strict";function r(e){var t=this;return function(r,l){return a.__awaiter(t,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return"never_loaded"===l().planTab.planSpectrumLoadingState||e?(r({type:"plan_spectrum_load_info"}),[4,i.growthCheckGating(n.getCurrentUser(),"uj_plan_spectrum_upsell")]):[3,2];case 1:return t=a.sent(),r({type:"plan_spectrum_info_loaded",planSpectrumInfo:t}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadPlanSpectrum=r}),define("modules/clean/account_page/widgets/plan/plan_spectrum/types",["require","exports","tslib","modules/clean/growth/user_action/tracker"],function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.BasicView="uj_plan_spectrum_upsell_basic_user_view",e.BasicPlusClick="uj_plan_spectrum_upsell_basic_user_plus_click",e.BasicProClick="uj_plan_spectrum_upsell_basic_user_pro_click",e.BasicUpgradeClick="uj_plan_spectrum_upsell_basic_user_upgrade_click",e.PlusView="uj_plan_spectrum_upsell_plus_user_view",e.PlusProClick="uj_plan_spectrum_upsell_plus_user_pro_click",e.PlusChangePlanClick="uj_plan_spectrum_upsell_plus_user_change_plan_click"})(t.PlanSpectrumActions||(t.PlanSpectrumActions={}));(function(e){e.Basic="basic",e.Plus="plus",e.Professional="pro"})(t.PlanType||(t.PlanType={}));var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.project="uj_plan_spectrum_upsell",t}return a.__extends(t,e),t})(n.GrowthUserActionTracker);t.PlanSpectrumTracker=i}),define("modules/clean/account_page/widgets/plan/referral_history/action_creators",["require","exports","tslib","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/referral_history/api"],function(e,t,a,n,i){"use strict";function r(e,t){var r=this;return function(l,o){return a.__awaiter(r,void 0,void 0,function(){var r;return a.__generator(this,function(a){switch(a.label){case 0:return"never_loaded"===o().planTab.referralLoadingState||e?(l({type:"load_referral_history"}),[4,i.getReferralHistory(n.getCurrentUser().id,t)]):[3,2];case 1:return r=a.sent(),l({type:"referral_history_loaded",history:r}),[2,!0];case 2:return[2,!1]}})})}}Object.defineProperty(t,"__esModule",{value:!0}),t.loadReferralHistoryIfNecessary=r}),define("modules/clean/account_page/widgets/plan/referral_history/api",["require","exports","tslib","modules/clean/ajax_as_promised"],function(e,t,a,n){"use strict";function i(e,t){return a.__awaiter(this,void 0,void 0,function(){return a.__generator(this,function(a){return[2,n.WebRequest({url:"/account/bonus_page/"+t,subject_user:e,dataType:"json"})]})})}Object.defineProperty(t,"__esModule",{value:!0}),t.getReferralHistory=i}),define("modules/clean/account_page/widgets/plan/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.MONTHLY=1]="MONTHLY",e[e.YEARLY=2]="YEARLY",e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL",e[e.ADD_EVH=5]="ADD_EVH",e[e.REMOVE_EVH=6]="REMOVE_EVH"})(t.PerformPlanTransition||(t.PerformPlanTransition={}))}),define("modules/clean/account_page/widgets/plan/views/add_ons",["require","exports","tslib","modules/core/i18n","modules/clean/react/css","external/react","modules/clean/static_urls","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/account_page/widgets/plan/views/evh_modal","modules/clean/analytics"],function(e,t,a,n,i,r,l,o,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.openEvhModal=function(e){var n=t.props.scheduledForDowngrade;e.stopPropagation(),n?s.CancelChangesModalConfirmation.showInstance({transitionPerformed:t.props.transitionPerformed,subStatus:t.props.subStatus}):c.EvhModalView.showInstance(a.__assign({},t.props))},t}return a.__extends(t,e),Object.defineProperty(t.prototype,"evhTitle",{get:function(){return this.props.evhInfo.is_unlimited_evh?n._("Unlimited version history"):n._("Extended version history")},enumerable:!0,configurable:!0}),t.prototype.isLoading=function(){return"ready"!==this.props.evhLoadingState},t.prototype.evhLink=function(){var e=this.props.evhInfo,t=e.purchased,a=e.scheduled_to_remove,i=e.is_free_evh;if(!a&&!i){var l=t?n._("Remove EVH"):n._("Add EVH");return t?u.ProEventsLogger.log("de_plan_tab_evh_remove_link_click"):u.ProEventsLogger.log("de_plan_tab_evh_add_link_click"),r.createElement("a",{className:"evh-link",href:"#",onClick:this.openEvhModal},l)}},t.prototype.showExtendedVersionHistory=function(){var e=this.props,t=e.subStatus,a=e.evhInfo;if(t.subState.billingSchedule){var i=n._("One year file version history for %(evh_price)s per %(billing_period)s").format({evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});if(t.subState.addons.peekSkus())switch(t.subState.addons.sku.adminCxId){case o.AdminCxId.UNLIMITED_FREE_VERSION_HISTORY:i=n._("Free unlimited file version history");break;case o.AdminCxId.UNLIMITED_MONTHLY_VERSION_HISTORY:case o.AdminCxId.UNLIMITED_YEARLY_VERSION_HISTORY:case o.AdminCxId.UNLIMITED_PAID_VERSION_HISTORY:i=n._("Unlimited file version history for %(evh_price)s per %(billing_period)s").format({evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});break;case o.AdminCxId.ONE_YEAR_PAID_VERSION_HISTORY:i=n._("One year file version history for %(evh_price)s per %(billing_period)s").format({evh_price:a.evh_price,billing_period:t.subState.billingSchedule.scheduleDescriptionNoun});break;case o.AdminCxId.ONE_YEAR_FREE_VERSION_HISTORY:i=n._("Free one year file version history");break;case o.AdminCxId.FREE_120_DAYS_VERSION_HISTORY:i=n._("Free 120 days file version history");break;default:throw new Error("Unknown extended version history add-on")}return r.createElement("div",{className:"evh-container"},r.createElement("div",{className:"evh-body"},r.createElement("div",{className:"evh-text"},r.createElement("p",{className:"evh-title"},this.evhTitle),r.createElement("p",{className:"evh-content"},i)),this.evhLink()))}},t.prototype.render=function(){return this.props.evhInfo.is_available?this.isLoading()?r.createElement("div",{className:"loading-indicator"},r.createElement("img",{src:l.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:n._("Loading")})):r.createElement("div",{className:"add-ons"},r.createElement("p",{className:"header"},n._("Available add-ons")),r.createElement("p",{className:"context"},n._("Extend the functionality of your Dropbox plan with add-ons")),this.showExtendedVersionHistory()):r.createElement("noscript",null)},t})(r.Component);t.AddOns=i(d,["/static/css/account/pagelet/add_ons-vflZFLEQS.css"])}),define("modules/clean/account_page/widgets/plan/views/cancel_changes_modal",["require","exports","tslib","external/react","modules/clean/ajax","modules/clean/account_page/widgets/plan/constants","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/subscription_service","modules/constants/trademark","modules/core/i18n","modules/clean/dbmodal_stack","modules/clean/account_page/util","modules/core/notify"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.cancellationType;a.cancelScheduledChange(e)},new c.SubscriptionService,a.state={submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){o.Modal.showInstance(n.createElement(t,a.__assign({},e)))},t.prototype.submittingRequest=function(){this.setState(function(e){return e.submitting=!0,e})},t.prototype.doneSubmittingRequest=function(){this.setState(function(e){return e.submitting=!1,e})},t.prototype.cancelScheduledChange=function(e){var t=this,a=this.props.transitionPerformed;this.submittingRequest(),i.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:e},subject_user:m.getCurrentUser().id,success:function(n){h.Notify.success(d._("You’ve cancelled your change!")),e===l.CancellationType.SCHEDULE&&s.ProEventsLogger.log("de_change_billing_cancel_change"),e===l.CancellationType.EVH_ADDON&&s.ProEventsLogger.log("de_evh_modal_cancel_change"),a&&a(),t.doneSubmittingRequest(),o.Modal.close(),t.props.reOpenModalDialogAfterCancellation&&p.DBModalStack.trigger(r.CHANGE_IND_PLAN_MODAL_UPDATED,null)},error:function(){h.Notify.error(d._("Failed to cancel changes.")),t.doneSubmittingRequest(),o.Modal.close(),
t.props.reOpenModalDialogAfterCancellation&&p.DBModalStack.trigger(r.CHANGE_IND_PLAN_MODAL_UPDATED,null)}})},t.prototype.render=function(){var e=this.props,t=e.cancellationType,a=e.subStatus;if(!a.subState.plan||!a.subState.billingSchedule)return n.createElement("noscript",null);var i,r=d._("Confirm cancelling change");switch(t){case l.CancellationType.PLAN:i=d._("You’re cancelling your scheduled plan change. Your Dropbox %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({trademark_plus:u.TRADEMARK_PLUS,plan:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.finalSubState.billingSchedule.scheduleDescriptionAdjective});break;case l.CancellationType.SCHEDULE:i=d._("You’re cancelling your scheduled billing change. Your Dropbox %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({plan:a.finalSubState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.subState.billingSchedule.scheduleDescriptionAdjective});break;case l.CancellationType.EVH_ADDON:i=d._("You’re cancelling your EVH changes. Your Dropbox %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({plan:a.finalSubState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.finalSubState.billingSchedule.scheduleDescriptionAdjective});break;case l.CancellationType.IND_SUBSCRIPTION:r=d._("Confirmation"),i=d._("By confirming, your downgrade to Dropbox Basic scheduled change will be cancelled.");break;case l.CancellationType.ALL:r=d._("Confirmation"),i=d._("By confirming, all existing scheduled changes will be cancelled.");break;default:r=d._("Confirmation"),i=d._("By confirming, the scheduled change will be cancelled.")}return n.createElement(o.Modal,{acceptButtonDisabled:this.state.submitting,acceptButtonText:d._("Confirm"),autoClose:!1,dismissButtonText:d._("Don’t cancel"),onAccept:this.onAccept,title:r,submitting:this.state.submitting},n.createElement("p",null,i))},t})(n.Component);t.CancelChangesModalConfirmationView=_}),define("modules/clean/account_page/widgets/plan/views/cancel_plan",["require","exports","tslib","external/react","modules/core/uri","modules/core/i18n","modules/clean/display_format","modules/clean/payments/skus/constants","modules/clean/analytics","modules/clean/payments/skus/sku_content"],function(e,t,a,n,i,r,l,o,s,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.cancelPlanClick=function(e){s.ProEventsLogger.log("de_cancel_plan_subscription_click")},t}return a.__extends(t,e),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cancelURL",{get:function(){return new i.URI({path:"/downgrade",query:{oqa:"acc_cancel"}}).toString()},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.subStatus,a=e.eligibleFor1tb,i=e.basicSkuContent;if(!t||!t.subState.plan||t.subState.plan.productType===o.ProductPlanType.FREE)return n.createElement("noscript",null);var s=c.SkuContentClient.deserialize(i);return n.createElement("div",{className:"cancel-plan"},n.createElement("span",{className:"cancel-plan__header"},r._("Cancel %(plan)s plan").format({plan:t.subState.plan.displayName(a)})),n.createElement("div",null,n.createElement("p",{className:"cancel-plan__desc"},r._("If you cancel your plan, your account will drop from %(quota)s             to %(basic_space_short_form_gb)s of space (plus any bonus space earned previously)").format({quota:l.format_bytes(this.quota),basic_space_short_form_gb:s.spaceShortFormGb()})),n.createElement("span",{className:"cancel-plan__downgrade-link"},n.createElement("a",{href:this.cancelURL,onClick:this.cancelPlanClick},r._("Cancel plan")))))},t})(n.Component);t.CancelPlan=u}),define("modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal",["require","exports","tslib","modules/clean/ajax","modules/clean/react/css","modules/core/notify","external/react","modules/core/i18n","modules/clean/account_page/util","modules/clean/static_urls","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/react/modal","spectrum/button"],function(e,t,a,n,i,r,l,o,s,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(t){var a=e.call(this,t)||this;return a.onDismiss=function(e){e.preventDefault(),d.Modal.close()},a.onAccept=function(){a.cancelScheduledChange()},a.state={submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){d.Modal.showInstance(l.createElement(t.cancelChangesModalConfirmationView,a.__assign({},e)))},t.prototype.submittingRequest=function(){this.setState(function(e){return e.submitting=!0,e})},t.prototype.doneSubmittingRequest=function(){this.setState(function(e){return e.submitting=!1,e})},t.prototype.cancelScheduledChange=function(){var e=this,t=this.props,a=t.transitionPerformed,i=t.userIdOverride,l=null;l=i?i:s.getCurrentUser().id,this.submittingRequest(),n.WebRequest({url:"/account/ajax_cancel_scheduled_change",data:{scheduled_change_type:u.CancellationType.IND_SUBSCRIPTION},subject_user:l,success:function(t){r.Notify.success(o._("You’ve cancelled your change!")),a&&a(),e.doneSubmittingRequest(),d.Modal.close()},error:function(){r.Notify.error(o._("Failed to cancel changes.")),e.doneSubmittingRequest(),d.Modal.close()}})},t.prototype.render=function(){var e=this.props.subStatus,t=this.state.submitting;if(!e)return l.createElement("noscript",null);var a=l.createElement("div",{className:"loading-indicator"},l.createElement("img",{src:c.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:o._("Loading")})),n=t?a:l.createElement("div",null,l.createElement("div",{className:"cancel-subscription-warning-modal__cancel-btn"},l.createElement(p.Button,{variant:"primary",onClick:this.onAccept,disabled:t},o._("Cancel downgrade"))),l.createElement("div",{className:"cancel-subscription-warning-modal__dismiss-btn"},l.createElement("a",{href:"#",onClick:this.onDismiss},o._("Dismiss"))));return l.createElement(d.Modal,{acceptButtonDisabled:this.state.submitting,autoClose:!1,className:"cancel-subscription-warning-modal",buttonComponent:l.createElement(d.ModalButtons,null),submitting:this.state.submitting},l.createElement("div",null,l.createElement("p",{className:"cancel-subscription-warning-modal__title"},o._("Plan downgrade scheduled")),l.createElement("p",{className:"cancel-subscription-warning-modal__desc"},o._("Your plan is scheduled to be downgraded to Dropbox Basic on %(date)s.               If you want to make any changes, first cancel your scheduled downgrade.").format({date:e.subState.formattedNextBillingDate})),n))},t.cancelChangesModalConfirmationView=i(t,["/static/css/account/pagelet/cancel_subs_warning-vfl-s2mqh.css"]),t})(l.Component);t.CancelChangesModalConfirmation=m}),define("modules/clean/account_page/widgets/plan/views/cancellable_notifications_view",["require","exports","tslib","external/react","external/react-dom-factories","modules/clean/react/css","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/teams/admin/widgets/billing_notifications/cancellable_item","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/payments/skus/constants","modules/clean/react_format","modules/constants/trademark","modules/clean/account_page/widgets/plan/views/cancel_changes_modal"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleCancelSubscriptionAction=function(){t.handleCancelActions(c.CancellationType.IND_SUBSCRIPTION)},t.handleCancelPlanAction=function(){t.handleCancelActions(c.CancellationType.PLAN)},t.handleCancelScheduleAction=function(){t.handleCancelActions(c.CancellationType.SCHEDULE)},t.handleCancelEvhAction=function(){t.handleCancelActions(c.CancellationType.EVH_ADDON)},t.handleCancelActions=function(e){var a=t.props,n=a.subStatus,i=a.transitionPerformed,r=a.reOpenModalDialogAfterCancellation;n&&m.CancelChangesModalConfirmationView.showInstance({subStatus:n,transitionPerformed:i,cancellationType:e,reOpenModalDialogAfterCancellation:r})},t}return a.__extends(t,e),t.prototype.renderCancelSubscriptionNotification=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t)return a?n.createElement(s.CancellableItemView,{title:l._("Scheduled plan change"),description:l._("Dropbox Basic"),handleAction:this.handleCancelSubscriptionAction,useCTA:!0}):void 0},t.prototype.renderDowngradePlanNotification=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t&&!a){var i=t.scheduledSubState;if(i){var r=t.subState.plan,o=i.plan;if(r&&o&&(r.productType!==o.productType||r.productType===o.productType&&r.productSpec!==o.productSpec)){var c=l._("Dropbox %(scheduled_plan)s").format({trademark_plus:p.TRADEMARK_PLUS,scheduled_plan:o.displayName()});return n.createElement(s.CancellableItemView,{title:l._("Scheduled plan change"),description:c,handleAction:this.handleCancelPlanAction,useCTA:!0,className:"cancel-plan-schedule"})}}}},t.prototype.renderScheduledChange=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t&&!a){var i=t.scheduledSubState;if(i&&i.billingSchedule&&t.subState.billingSchedule&&t.subState.billingSchedule.id!==i.billingSchedule.id){var r=i.billingSchedule.scheduleDescriptionAdjective;return n.createElement(s.CancellableItemView,{title:l._("Scheduled billing period"),description:l._("%(billing)s billing").format({billing:r.charAt(0).toUpperCase()+r.slice(1)}),handleAction:this.handleCancelScheduleAction,useCTA:!0,className:"cancel-billing-schedule"})}}},t.prototype.renderEvhChange=function(){var e=this.props,t=e.subStatus,a=e.scheduledForDowngrade;if(t&&!a){var i=t.scheduledSubState;if(i)return t.subState.addons.skus.length>0&&1===t.subState.quantityForEvhAddOn()&&0===i.quantityForEvhAddOn()?n.createElement(s.CancellableItemView,{title:l._("Scheduled add-on change"),description:l._("Remove extended version history"),handleAction:this.handleCancelEvhAction,useCTA:!0,className:"cancel-evh-schedule"}):void 0}},t.prototype.appendAllCancellationTypes=function(e){e.push(this.renderCancelSubscriptionNotification()),e.push(this.renderDowngradePlanNotification()),e.push(this.renderScheduledChange()),e.push(this.renderEvhChange())},t.prototype.render=function(){var e=this.props,t=e.displaySingleChangeCancellationItem,a=e.scheduledForDowngrade,r=e.subStatus,s=e.paymentInfo,p=e.hasLicenseKey,m=e.displayNewTotal;if(!r)return n.createElement("noscript",null);if(!s||o.shouldHideBillingChange(s.gateway_id,s.is_reseller_billing))return n.createElement("noscript",null);var h=[];if(!r.finalSubState.plan)return n.createElement("noscript",null);if(t)switch(t){case c.CancellationType.IND_SUBSCRIPTION:h.push(this.renderCancelSubscriptionNotification());break;case c.CancellationType.PLAN:h.push(this.renderDowngradePlanNotification());break;case c.CancellationType.SCHEDULE:h.push(this.renderScheduledChange());break;case c.CancellationType.EVH_ADDON:h.push(this.renderEvhChange());break;case c.CancellationType.ALL:this.appendAllCancellationTypes(h)}if(h=h.filter(function(e){return void 0!==e}),!h.length)return n.createElement("noscript",null);var _="";!a&&m&&(_=l._("Your new %(schedule)s total will be %(total)s.").format({schedule:u.productScheduleToProductScheduleDescription(r.finalSubState.plan.schedule),total:r.nextBillingSummary.total}));var g=n.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__header"},d.reactFormat(l._("Changes are scheduled for <strong>%(date)s</strong>.").format({date:r.subState.formattedNextBillingDate}),{strong:i.strong()})," ",_);return n.createElement("div",{className:"cancellable-scheduled-notifications personal-cancellable-scheduled-notifications"},g,!p&&n.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__items"},h))},t})(n.Component);t.CancellableNotificationsViewControl=h,t.CancellableNotificationsView=r(h,["/static/css/teams/admin/widgets/billing_notifications/cancellable_scheduled_notifications-vflQdegLi.css"])}),define("modules/clean/account_page/widgets/plan/views/change_plan_modal",["require","exports","tslib","modules/core/browser","modules/clean/react/image","modules/core/notify","external/react","modules/clean/ajax","modules/clean/react/css","modules/clean/react/badge","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/account_page/widgets/plan/constants","modules/constants/individual_invoice_modal","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/payments/validation","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/payments/cash","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_status","modules/constants/trademark","modules/core/i18n","modules/clean/account_page/util","modules/clean/react_format","modules/clean/static_urls","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/account_page/widgets/plan/views/pro_upsell_modal_content","modules/clean/account_page/widgets/plan/views/exp_change_plans_modal_redesign","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader","modules/clean/payments/billing_info_modal"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C,T,N,x,I,k,L,A,D,M,B,O){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var R;(function(e){e.DEFAULT="default",e.CONFIRM="confirm"})(R=t.ChangePlanMode||(t.ChangePlanMode={}));var U;(function(e){e[e.MONTHLY=1]="MONTHLY",e[e.YEARLY=2]="YEARLY",e[e.PLUS=3]="PLUS",e[e.PROFESSIONAL=4]="PROFESSIONAL"})(U=t.PerformPlanTransition||(t.PerformPlanTransition={}));var V=(function(e){function t(a){var i=e.call(this,a)||this;return i.onAccept=function(){var e,t,a=i.getSubChangePlan();if(a){a.finalSubState.planSku.productType!==P.ProductPlanType.PLUS&&a.finalSubState.planSku.productType!==P.ProductPlanType.STANDARD||(t=U.PROFESSIONAL,e=U.PLUS),a.finalSubState.planSku.productType===P.ProductPlanType.PROFESSIONAL&&(t=U.PLUS,e=U.PROFESSIONAL),i.setState(function(e){return{showErrors:!0}});var l=i.state,s=l.vat,c=l.paymentMethod;if(c&&c.country_code&&i.vatValidator(c.country_code,s))if(E.ProEventsLogger.log("de_change_plan_modal_confirm_change_click"),e&&t){i.setState(function(e){return{submitting:!0}});var u={transition_change_type:e};s&&(u.vat=s,E.ProEventsLogger.log("vat_provided_on_upgrade")),o.WebRequest({url:"/account/perform_personal_transition",data:u,subject_user:i.getUserId(),success:function(l){if(r.Notify.success(N._("You’ve changed your plan!")),i.removeShowModalParams(),i.logChangePlan(t,e),i.props.transitionPerformed&&i.props.transitionPerformed(),a.finalSubState.planSku.productType===P.ProductPlanType.PROFESSIONAL){if(i.state.expSubgrowthProConfirmationPage)return n.redirect("/professional_onboarding");i.setState({displayUpgradedToProfessionalContent:!0,loadingContent:!1,submitting:!1})}else i.closeModals()},error:function(){r.Notify.error(N._("There was an error changing the plan!")),i.setState(function(e){return{submitting:!1}})}})}else r.Notify.error(N._("There was an error changing the plan!"))}},i.onDismiss=function(){E.ProEventsLogger.log("de_change_plan_modal_cancel_click"),i.closeProPlansRedesignModal()},i.closeModals=function(){v.Modal.close(),i.closeProPlansRedesignModal()},i.renderVat=function(){var e=null;if(!i.vatDisplayEnabled)return e;var t=i.state,a=t.vat,n=t.paymentMethod,r=t.showErrors,o=n&&n.country_code?n.country_code:void 0;if(o){var s=_.getVatPrefix(o),c=N._("Please enter a valid VAT number, e.g. %(examples)s.").format({examples:_.getVatExamples(o).join(", ")});e=l.createElement(L.ArborTextInput,{name:"vat",placeholderText:s,labelText:N._("VAT number (optional)"),isValid:!r||i.vatValidator(o,a),errorText:c,value:a,onChange:i.onVatChange})}return e},i.onVatChange=function(e,t,a){var n=a;i.setState(function(e){return{vat:n,loadingChangeSummary:!0,showErrors:!1}});var r=i.state.paymentMethod;r&&r.country_code&&i.repriceTransitions(_.validateVat(r.country_code,n)?n:"")},i.renderPaymentMethod=function(){var e=i.state.paymentMethod;if(!i.isPlanScheduledToChange())return l.createElement("div",{className:"upgrade-payment-method-link"},l.createElement(S.IndividualInlinePaymentMethodView,{paymentMethod:e,paymentErrorMessage:N._("Please update your billing information to change your plan."),updateBillingCTA:i.updateBillingInfo}))},i.updateBillingInfo=function(e){v.Modal.close(),y.DBModalStack.register(O.BILLING_INFO_UPDATED,function(){t.showInstance(i.props)}),i.props.browserUpdateRequired?M.BrowserUpdateModalLoader.showInstance():B.IndividualUpdateBillingModalLoader.showInstance()},i.handleCancelScheduleAction=function(e){i.handleCancelActions(f.CancellationType.SCHEDULE),e.preventDefault()},i.handleCancelActions=function(e){var t=i.state.subStatus;return t&&h.CancelChangesModalConfirmationView.showInstance({subStatus:t,transitionPerformed:i.props.transitionPerformed,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},i.transitionPerformedClosure=function(e){if(i.props.transitionPerformed)return i.props.transitionPerformed()},i.getStartedClick=function(){n.redirect("/professional_onboarding")},i.closeProPlansRedesignModal=function(){var e=i.state.expProPlansModalV2;e&&"V1"===e&&i.setState({open:!1})},i.state={loadingContent:!0,schedule:P.ScheduleId.MONTHLY,subChangePlans:[],submitting:!1,type:P.ProductPlanType.STANDARD,displayUpgradedToProfessionalContent:!1,showErrors:!1,vat:"",loadingChangeSummary:!1,open:!0,expUjRebillUpsellVariant:"OFF"},i}return a.__extends(t,e),t.prototype.getUrlOption=function(e){var t=e,a=n.get_href().match(/option=([a-zA-Z_]*)/);if(a&&a.length>1){var i=a[1];"plus"===i&&(t=e===P.ProductPlanType.PROFESSIONAL?P.ProductPlanType.PLUS:e),"pro"===i&&(t=P.ProductPlanType.PROFESSIONAL)}return t},t.showInstance=function(e){v.Modal.showInstance(l.createElement(t.ChangePlanModal,a.__assign({},e)))},t.prototype.componentDidMount=function(){this.loadPlanTransitions()},t.prototype.onLoadPlanTransitions=function(e){var t=this;this.setState(function(a){var n=C.SubscriptionStatus.deserialize(e.serializedSubStatus),i=e.paymentMethod,r=n.finalSubState;if(!r.billingSchedule||!r.plan)throw"A base plan is required, in order to change it.";var l=n.subState.billingSchedule.id,o=e.serializedSubChangePlans.map(function(e){return w.SubscriptionChangePlan.deserialize(e)}),s=o.map(function(e){return e});s.push(n);var c=t.getUrlOption(n.subState.plan.productType),u=t.props.mode||R.DEFAULT,d=e.exp_subgrowth_pro_plans_modal_simplification||"OFF",p=e.exp_subgrowth_pro_change_plans_redesign_v2||"OFF";return(["V1","V2","V3"].includes(d)||["V1","V2"].includes(p))&&u===R.DEFAULT&&(c=P.ProductPlanType.PROFESSIONAL),{loadingContent:!1,subStatus:n,paymentMethod:i,schedule:l,subChangePlans:o,allSubStatuses:s,type:c,expProPlansModal:d,expProPlansModalV2:p,expSubgrowthProConfirmationPage:e.exp_subgrowth_pro_confirmation_page||!1,mode:u,expUjRebillUpsellVariant:e.exp_uj_rebill_upsell_variant||"OFF"}})},t.prototype.loadPlanTransitions=function(){var e=this;this.retrieveViewModel(function(t){e.onLoadPlanTransitions(t)},this.onLoadTransitionsError)},t.prototype.onLoadTransitionsError=function(){r.Notify.error(N._("Failed to load modal.")),this.closeModals()},t.prototype.onRepriceTransitions=function(e){this.setState(function(t){var a=C.SubscriptionStatus.deserialize(e.serializedSubStatus),n=e.serializedSubChangePlans.map(function(e){return w.SubscriptionChangePlan.deserialize(e)}),i=n.map(function(e){return e});i.push(a);return{subStatus:a,subChangePlans:n,allSubStatuses:i,loadingChangeSummary:!1}})},t.prototype.onRepriceError=function(){r.Notify.error(N._("Request failed")),this.closeModals()},t.prototype.repriceTransitions=function(e){var t=this;this.retrieveViewModel(function(e){t.onRepriceTransitions(e)},this.onRepriceError,e)},t.prototype.getUserId=function(){return this.props.userIdOverride?this.props.userIdOverride:x.getCurrentUser().id},t.prototype.retrieveViewModel=function(e,t,a){var n=this,i=this.state,r=i.withVat,l=i.withoutVat,s=a?{vat:a}:void 0,c=a?r:l;c?e(c):o.WebRequest({url:"/account/ajax_change_plan",data:s,subject_user:this.getUserId(),success:function(t){var i=JSON.parse(t);n.setState(function(e){return a?{withVat:i}:{withoutVat:i}}),e(i)},error:t})},t.prototype.getSubChangePlan=function(e){return void 0===e&&(e=this.state.type),this.state.subChangePlans.filter(function(t){var a=t.finalSubState;return!(!a.plan||!a.billingSchedule)&&a.plan.productType===e}).pop()},Object.defineProperty(t.prototype,"hasTypeChanged",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.plan&&e.finalSubState.plan.productType!==this.state.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentPlanChanged",{get:function(){return this.hasTypeChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:P.ScheduleId.MONTHLY},enumerable:!0,configurable:!0}),t.prototype.logChangePlan=function(e,t){var a=this.state.subStatus;a&&a.subState.billingSchedule&&E.ProEventsLogger.log("de_change_plan_modal_change_plan",{from:e===U.PLUS?T.TRADEMARK_PLUS:"Professional",to:t===U.PROFESSIONAL?"Professional":T.TRADEMARK_PLUS})},t.prototype.removeShowModalParams=function(){var e=n.get_href().match(/modal=([a-zA-Z_]*)/);if(e&&e.length>1){"plan"===e[1]&&window.history.replaceState({},document.title,n.get_href().split("?")[0])}},t.prototype.changeProductPlanAndScheduleType=function(e,t){e===P.ProductPlanType.PROFESSIONAL?E.ProEventsLogger.log("de_change_plan_modal_professional_section_click"):E.ProEventsLogger.log("de_change_plan_modal_plus_section_click"),this.setState(function(a){return{type:e,schedule:t}})},t.prototype.getPlanDescription=function(e){var t=e.content&&e.content.spaceShortFormTb();switch(e.productType){case P.ProductPlanType.STANDARD:case P.ProductPlanType.PLUS:return t?N._("Stress-free sharing, offline folders on mobile, and %(plan_space)s storage.").format({plan_space:t}):N._("Stress-free sharing and offline folders on mobile.");case P.ProductPlanType.PROFESSIONAL:return t?N._("Smart Sync, Showcase, shared link controls, and %(plan_space)s storage.").format({plan_space:t}):N._("Smart Sync, Showcase, and shared link controls.")}return""},t.prototype.changeProductPlanAndScheduleTypeClosure=function(e,t){var a=this;return function(){a.changeProductPlanAndScheduleType(e,t)}},t.prototype.renderPlanItems=function(){var e=this,t=this.state,a=t.type,n=t.allSubStatuses,i=t.subStatus,r=[P.ProductPlanType.STANDARD,P.ProductPlanType.PLUS,P.ProductPlanType.PROFESSIONAL];if(n&&i)return n.filter(function(t){return!!(t.finalSubState.plan&&i.subState.plan&&i.finalSubState.plan&&i.subState.planSku&&i.finalSubState.planSku&&i.subState.billingSchedule&&t.finalSubState.billingSchedule)&&(!e.isBillingScheduleToChange()||t.subState.billingSchedule.id===i.subState.billingSchedule.id)}).sort(function(e,t){return e.finalSubState.plan&&t.finalSubState.plan?r.indexOf(e.finalSubState.plan.productType)-r.indexOf(t.finalSubState.plan.productType):0}).map(function(t){var n=t.finalSubState.plan,r=t.finalSubState.billingSchedule;if(n&&r&&!(i&&i.subState&&i.subState.plan&&i.subState.plan.isLegacyPlan&&n.isAdvancePlan)&&i.scheduledSubState&&i.scheduledSubState.billingSchedule&&t&&t.subState.billingSchedule&&t.finalSubState.plan&&t.finalSubState.billingSchedule&&i.subState.billingSchedule&&i.subState.plan){var o,s=void 0,u=i.isOnTrial?i.finalSubState.plan:i.subState.plan;u&&n.productType===u.productType&&(o=N._("(current plan)"));var p=l.createElement("span",null,l.createElement("br",null),l.createElement("a",{href:"/plans",target:"_blank",rel:"noreferrer noopener"},N._("See plan details"))),m=N._("Dropbox %(plan_name)s").format({plan_name:n.displayName()}),h=void 0;e.state.expUjRebillUpsellVariant&&"V1"===e.state.expUjRebillUpsellVariant&&e.props.mode===R.CONFIRM&&n.productType===P.ProductPlanType.PROFESSIONAL&&(h={variant:c.BadgeVariant.NEW,color:c.BadgeColor.NEON_GREEN});var _=u&&n.productType===u.productType?e.getPlanDescription(u):e.getPlanDescription(n);return l.createElement(d.AdminPricedListItem,{key:n.code,isSelected:a===n.productType,title:m,titleWarningText:s,titleSecondaryText:o,description:_,detailsLink:p,price:n.displayCost,unit:n.billingSchedule.id===P.ScheduleId.MONTHLY?N._("per month"):N._("per year"),onClick:e.changeProductPlanAndScheduleTypeClosure(n.productType,r.id),disableItem:e.isPlanScheduledToChange(),badge:h})}})},t.prototype.getProfessionalPlanSkuForModalExperiments=function(){var e=this,t=this.state,a=t.allSubStatuses,n=t.subStatus;if(!a||!n)return null;for(var i,r=a.filter(function(t){return!!(t.finalSubState.plan&&n.subState.plan&&n.finalSubState.plan&&n.subState.planSku&&n.finalSubState.planSku&&n.subState.billingSchedule&&t.finalSubState.billingSchedule)&&(!e.isBillingScheduleToChange()||t.subState.billingSchedule.id===n.subState.billingSchedule.id)}),l=0,o=r;l<o.length;l++){var s=o[l];s.finalSubState.plan.productType===P.ProductPlanType.PROFESSIONAL&&(i=s)}return i&&i.finalSubState.plan?i.finalSubState.plan:null},t.prototype.renderSubgrowthProPlansModalSimplificationExperiment=function(){var e=this.state,t=e.expProPlansModal,a=e.expProPlansModalV2,n=this.getProfessionalPlanSkuForModalExperiments();return t&&n?l.createElement(A.ProUpsellModalContent,{expProPlansModalVariant:t,expProPlansModalV2Variant:a,price:n.displayCost,unit:n.billingSchedule.id===P.ScheduleId.MONTHLY?N._("per month"):N._("per year"),quota:n.content&&n.content.spaceLongFormRounded()}):null},t.prototype.renderBillingSection=function(){var e=this.props.mode||R.DEFAULT;return l.createElement("div",null,this.state.expProPlansModal&&e===R.DEFAULT&&["V1","V2","V3"].indexOf(this.state.expProPlansModal)>-1?this.renderSubgrowthProPlansModalSimplificationExperiment():l.createElement(u.AdminPricedList,null,this.renderPlanItems()),this.renderVat())},t.prototype.vatValidator=function(e,t){return!t||_.validateVat(e,t)},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.state.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isPlanScheduledToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isBillingScheduleToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.getPlanNameWithEvhText=function(e){var t=this.state.subStatus;return t&&t.scheduledSubState&&t.scheduledSubState.quantityForEvhAddOn()>0?e+" "+N._("+ extended version history"):e},t.prototype.renderScheduleTransitionText=function(){var e=this.state.subStatus,t=this.getSubChangePlan();if(e&&e.subState.plan){var a=l.createElement("a",{href:"#",onClick:this.handleCancelScheduleAction},N._("Cancel change"));if(this.isPlanScheduledToChange())return l.createElement("span",{className:"plan-transition"},N._("You’ve already requested a change to your plan. If you want           to choose a different plan or billing period, first cancel your pending change.")," ",a);if((!t||e.subState.planSku.productType===t.finalSubState.planSku.productType)&&e.subState.billingSchedule&&e.currentBillingSummary){if(!this.isScheduledToChange())return l.createElement("span",{className:"plan-transition"},N._("Your Dropbox %(plan)s plan will renew on %(date)s.                 Your current %(schedule)s total is %(recurring_total)s.").format({plan:this.getPlanNameWithEvhText(e.subState.plan.displayName()),schedule:e.subState.billingSchedule.scheduleDescriptionAdjective,recurring_total:b.Cash.formatWithTaxLabels(e.currentBillingSummary.total,e.currentBillingSummary),date:e.subState.formattedNextBillingDate}));if(e.scheduledSubState&&e.scheduledSubState.plan)return l.createElement("div",null,l.createElement("span",{className:"change-summary"},N._("Change summary")),l.createElement("p",{className:"plan-transition"},I.reactFormat(N._("Starting on %(date)s, we’ll bill you once a %(schedule_noun)s for your Dropbox                     %(plan)s. Your new %(schedule)s total will be %(scheduled_total)s.").format({plan:this.getPlanNameWithEvhText(e.scheduledSubState.plan.displayName()),date:e.subState.formattedNextBillingDate,schedule:e.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:e.scheduledSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:b.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)}),{strong:l.createElement("strong",null)})))}if(t&&t.finalSubState.plan){var n=void 0!==t.tvm;return t&&t.tvm&&n?l.createElement("div",null,l.createElement("span",{className:"change-summary"},N._("Change summary")),l.createElement("p",{className:"plan-transition"},I.reactFormat(N._("You’re upgrading your plan to Dropbox %(plan)s.                 <strong>We’ll charge you %(prorated_price)s now</strong>, which is prorated for the current                 billing period. Starting on %(date)s and until you <cancelLink>cancel</cancelLink>, we’ll bill you once a %(schedule_noun)s and your new                 %(schedule)s total will be %(scheduled_total)s. If you cancel, previous charges won’t be refunded                 <legalLink>unless it’s legally required</legalLink>.").format({plan:this.getPlanNameWithEvhText(t.finalSubState.plan.displayName()),prorated_price:b.Cash.formatWithTaxLabels(t.tvm.getTotalPrice(),t.nextBillingSummary),date:t.subState.formattedNextBillingDate,schedule_noun:t.finalSubState.billingSchedule.scheduleDescriptionNoun,schedule:t.finalSubState.billingSchedule.scheduleDescriptionAdjective,scheduled_total:b.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}),{strong:l.createElement("strong",null),cancelLink:l.createElement("a",{href:"/help/billing/cancel-dropbox-plus"}),legalLink:l.createElement("a",{href:"/help/billing/plus-refund"})}))):n?void 0:l.createElement("div",null,l.createElement("span",{className:"change-summary"},N._("Change summary")),l.createElement("p",{className:"plan-transition"},I.reactFormat(N._("Starting on %(date)s, your plan will be downgraded to Dropbox %(plan)s                 and your new %(schedule)s total will be %(scheduled_total)s. Charges will                 continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded                 <legalLink>unless it’s legally required</legalLink>.").format({plan:this.getPlanNameWithEvhText(t.finalSubState.plan.displayName()),date:e.subState.formattedNextBillingDate,schedule:t.finalSubState.billingSchedule.scheduleDescriptionAdjective,
scheduled_total:b.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}),{strong:l.createElement("strong",null),cancelLink:l.createElement("a",{href:"/help/billing/cancel-dropbox-plus"}),legalLink:l.createElement("a",{href:"/help/billing/plus-refund"})})))}}},t.prototype.renderChangeFooter=function(){var e;return this.state.loadingChangeSummary?l.createElement("div",{className:"loading-indicator"},l.createElement("img",{src:k.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:N._("Loading")})):(this.isPlanScheduledToChange()||(e=this.renderPaymentMethod()),l.createElement("div",{className:"plan-footer u-font-meta"},this.renderScheduleTransitionText(),e))},Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.state.paymentMethod,t=this.state,a=t.loadingContent,n=t.loadingChangeSummary,i=t.submitting;return!(!(a||n||i)&&e)||!this.hasUserSelectedDifferentPlan()},enumerable:!0,configurable:!0}),t.prototype.isValidVatCountry=function(){var e=this.state.paymentMethod;return e&&e.country_code&&_.hasVat(e.country_code)},t.prototype.isUserOnPlus=function(){var e=this.state.subStatus;return e&&e.subState&&e.subState.plan&&e.subState.plan.productType===P.ProductPlanType.PLUS},t.prototype.hasUserSelectedDifferentPlan=function(){return!this.isPlanScheduledToChange()&&this.hasTypeChanged},Object.defineProperty(t.prototype,"vatDisplayEnabled",{get:function(){var e=this.state,t=e.loadingContent,a=e.submitting;return m.INDIVIDUAL_INVOICE_MODAL&&!t&&!a&&this.isValidVatCountry()&&this.isUserOnPlus()&&this.hasUserSelectedDifferentPlan()},enumerable:!0,configurable:!0}),t.prototype.getPlanStrings=function(){var e=this.getProfessionalPlanSkuForModalExperiments();if(e){var t=void 0,a=void 0;e.displayCost&&(t=e.displayCost.toString(),a=e.billingSchedule.id===P.ScheduleId.MONTHLY?N._("Monthly cost"):N._("Yearly cost"));return{priceString:t,scheduleString:a,quotaString:e.content&&e.content.spaceLongFormRounded()}}return null},t.prototype.getBillingSummaryStrings=function(){var e=this.getSubChangePlan();if(e&&e.finalSubState.plan&&e.tvm){return{scheduledPriceString:e.nextBillingSummary.total.toString(),proratedPriceString:e.tvm.getTotalPrice().toString(),changeSummaryString:I.reactFormat(N._("You’re upgrading to Dropbox %(plan)s.           <strong>We’ll charge you %(prorated_price)s now</strong>,           which has been prorated for the current billing period.           Your plan will renew on %(date)s. Your new %(schedule)s total           will be %(scheduled_total)s.").format({plan:this.getPlanNameWithEvhText(e.finalSubState.plan.displayName()),prorated_price:b.Cash.formatWithTaxLabels(e.tvm.getTotalPrice(),e.nextBillingSummary),date:e.subState.formattedNextBillingDate,schedule:e.finalSubState.billingSchedule.scheduleDescriptionAdjective,scheduled_total:b.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)}),{strong:l.createElement("strong",null)})}}return null},t.prototype.render=function(){var e,n=this,r=this.props,o=r.transitionPerformed,s=r.paymentInfo,c=r.mode,u=this.state,d=u.subStatus,m=u.displayUpgradedToProfessionalContent,h=u.loadingContent,_=u.submitting,b=u.type,S=u.expProPlansModal,E=u.expProPlansModalV2,P=N._("Change plan"),w=N._("Cancel"),C=N._("Confirm change");if(d&&m)C="",w="",e=l.createElement("div",{className:"upgrade-to-professional"},l.createElement(i.Image,{className:"upgrade-to-professional__img",src:k.static_url("/static/images/account_page/successful-upgrade-conf-vfljF71a-.png"),srcHiRes:k.static_url("/static/images/account_page/successful-upgrade-conf@2x-vflKbwL4c.png"),alt:N._("")}),l.createElement("h3",{className:"upgrade-to-professional__title"},N._("Congrats! You’ve upgraded to Dropbox Professional")),l.createElement("p",{className:"upgrade-to-professional__desc"},N._("Get ready to take advantage of advanced features like Smart Sync, Showcase, and more support options.")),l.createElement("button",{className:"button-primary upgrade-to-professional_cta_btn",onClick:this.getStartedClick},N._("Got it")));else if(h)P=N._("Loading account details..."),e=l.createElement("div",{className:"loading-indicator"},l.createElement("img",{src:k.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:N._("Loading")}));else{var T=void 0;if(d&&o){y.DBModalStack.clear(),y.DBModalStack.register(p.CHANGE_IND_PLAN_MODAL_UPDATED,function(){t.showInstance(a.__assign({},n.props,{transitionPerformed:n.transitionPerformedClosure}))}),T=l.createElement(g.CancellableNotificationsView,{subStatus:d,transitionPerformed:this.transitionPerformedClosure,displaySingleChangeCancellationItem:f.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:s,displayNewTotal:!1})}if(e=l.createElement("div",null,T,this.renderBillingSection(),this.renderChangeFooter()),c===R.CONFIRM&&d&&this.state.expUjRebillUpsellVariant&&["V1","V2"].indexOf(this.state.expUjRebillUpsellVariant)>=0)P=N._("Confirm plan"),d.finalSubState.plan.productType===b?(C=null,w=N._("Confirm")):(C=N._("Upgrade plan"),w=null);else{if(E&&"V1"===E){var x=a.__assign({},this.getPlanStrings(),this.getBillingSummaryStrings());return l.createElement(D.ExpChangePlanRedesignModal,{onAccept:this.onAccept,onDismiss:this.onDismiss,open:this.state.open,planAndPricingContent:x,scheduledNotifications:T,submitting:this.state.submitting,loadingChangeSummary:this.state.loadingChangeSummary,renderVat:this.renderVat,renderPaymentMethod:this.renderPaymentMethod})}S&&["V1","V2","V3"].includes(S)&&(P=N._("Upgrade account"),C=N._("Upgrade now"))}}return l.createElement(v.Modal,{acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:C,className:"change-plan-modal",dismissButtonText:w,autoClose:!1,onAccept:this.onAccept,onDismiss:this.onDismiss,submitting:_,title:P},e)},t.ChangePlanModal=s(t,["/static/css/teams/admin/widgets/change_plan_modal/change_plan_modal-vfl_9HI5q.css"]),t})(l.Component);t.ChangePlanModalView=V}),define("modules/clean/account_page/widgets/plan/views/change_schedule_modal",["require","exports","tslib","modules/core/notify","external/react","modules/clean/ajax","modules/clean/react/css","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list","modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item","modules/clean/payments/billing_info_modal","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/account_page/widgets/plan/constants","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/payments/cash","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader","modules/clean/react/modal","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/analytics","modules/clean/payments/skus/constants","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_status","modules/core/i18n","modules/clean/account_page/util","modules/clean/react_format","modules/clean/static_urls"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C,T,N,x,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k=(function(e){function t(a){var i=e.call(this,a)||this;return i.onAccept=function(){var e,t,a=i.getSubChangePlan();a&&(a.finalSubState.billingSchedule.id===P.ScheduleId.MONTHLY&&(t=v.PerformPlanTransition.YEARLY,e=v.PerformPlanTransition.MONTHLY),a.finalSubState.billingSchedule.id===P.ScheduleId.YEARLY&&(t=v.PerformPlanTransition.MONTHLY,e=v.PerformPlanTransition.YEARLY),e&&t?(i.setState(function(e){return e.submitting=!0,e}),r.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:e},subject_user:N.getCurrentUser().id,success:function(e){n.Notify.success(T._("You’ve changed your billing period!")),i.logChangeSchedule(),i.props.transitionPerformed&&i.props.transitionPerformed(),S.Modal.close()},error:function(){n.Notify.error(T._("There was an error changing the billing period!")),i.setState(function(e){return e.submitting=!1,e})}})):n.Notify.error(T._("There was an error changing the billing period!")))},i.updateBillingInfo=function(e){S.Modal.close(),g.DBModalStack.register(c.BILLING_INFO_UPDATED,function(){t.showInstance(i.props)}),i.props.browserUpdateRequired?u.BrowserUpdateModalLoader.showInstance():y.IndividualUpdateBillingModalLoader.showInstance()},i.handleCancelScheduleAction=function(){return i.handleCancelActions(h.CancellationType.SCHEDULE),!1},i.handleCancelActions=function(e){var t=i.state.subStatus;return t&&p.CancelChangesModalConfirmationView.showInstance({subStatus:t,transitionPerformed:i.props.transitionPerformed,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},i.transitionPerformedClosure=function(e){if(i.props.transitionPerformed)return i.props.transitionPerformed()},i.onDismissModal=function(){E.ProEventsLogger.log("de_cancel_billing_change_modal")},i.state={loadingContent:!0,schedule:P.ScheduleId.MONTHLY,subChangePlans:[],submitting:!1,type:P.ProductPlanType.STANDARD,hasLicenseKey:!1},i}return a.__extends(t,e),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){var e=this.state.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===P.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!0,configurable:!0}),t.showInstance=function(e){S.Modal.showInstance(i.createElement(t.ChangeScheduleModal,a.__assign({},e)))},t.prototype.componentDidMount=function(){this.loadPlanTransitions()},t.prototype.loadPlanTransitions=function(){var e=this;r.WebRequest({url:"/account/ajax_change_plan_schedule",subject_user:N.getCurrentUser().id,success:function(t){var a=JSON.parse(t);e.setState(function(e){e.loadingContent=!1,e.subStatus=C.SubscriptionStatus.deserialize(a.serializedSubStatus),e.paymentMethod=a.paymentMethod,e.hasLicenseKey=a.hasLicenseKey;var t=e.subStatus.finalSubState;if(!t.billingSchedule||!t.plan)throw"A base plan is required, in order to change it.";return e.hasLicenseKey?e.schedule=e.subStatus.scheduledSubState.billingSchedule.id:e.schedule=e.subStatus.subState.billingSchedule.id,e.subChangePlans=a.serializedSubChangePlans.map(function(e){return w.SubscriptionChangePlan.deserialize(e)}),e.allSubStatuses=e.subChangePlans.map(function(e){return e}),e.allSubStatuses.push(e.subStatus),e.type=e.subStatus.subState.plan.productType,e})},error:function(){n.Notify.error(T._("Failed to load modal.")),S.Modal.close()}})},t.prototype.getSubChangePlan=function(e,t){return void 0===e&&(e=this.state.type),void 0===t&&(t=this.state.schedule),this.state.subChangePlans.filter(function(a){var n=a.finalSubState;return!(!n.plan||!n.billingSchedule)&&(n.plan.productType===e&&n.billingSchedule.id===t)}).pop()},Object.defineProperty(t.prototype,"hasTypeChanged",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.plan&&e.finalSubState.plan.productType!==this.state.type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasScheduleChanged",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule&&e.finalSubState.billingSchedule.id!==this.state.schedule},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasCurrentPlanChanged",{get:function(){return this.hasTypeChanged||this.hasScheduleChanged},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subStatusScheduleId",{get:function(){var e=this.state.subStatus;return e&&e.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id:P.ScheduleId.MONTHLY},enumerable:!0,configurable:!0}),t.prototype.logChangeSchedule=function(){var e=this.state.subStatus;e&&e.subState.billingSchedule&&E.ProEventsLogger.log("de_change_billing_change_schedule",{from:e.subState.billingSchedule.id===P.ScheduleId.MONTHLY?"yearly":"monthly",to:e.subState.billingSchedule.id===P.ScheduleId.MONTHLY?"monthly":"yearly"})},t.prototype.changeProductPlanAndScheduleType=function(e,t){this.setState(function(a){return a.type=e,a.schedule=t,a})},t.prototype.changeProductPlanAndScheduleTypeClosure=function(e,t){var a=this;return function(){a.changeProductPlanAndScheduleType(e,t)}},t.prototype.getScheduleDescription=function(e,t,a){var n=this.state.subStatus;if(!(e.finalSubState.billingSchedule&&e.finalSubState.plan&&n&&n.scheduledSubState&&n.scheduledSubState.plan&&n.subState.plan))return"";var i=this.getOriginalStatusForCurrentStatus(n.subState.plan.productType,P.ScheduleId.MONTHLY);if(this.isPlanScheduledToChange()&&this.isBillingScheduleToChange()&&(i=this.getSubStatusFromSubChangePlans(n.subState.plan.productType,P.ScheduleId.MONTHLY)),!i||!i.subState.planSku||!i.finalSubState.planSku)return"";var r;r=this.isPlanScheduledToChange()?i.finalSubState.planSku.displayCost.multiply(12):n.subState.billingSchedule.id===P.ScheduleId.MONTHLY?i.subState.planSku.displayCost.multiply(12):i.finalSubState.planSku.displayCost.multiply(12);var l="";switch(l=this.isPlanScheduledToChange()&&this.isBillingScheduleToChange()?n.subState.plan.displayName():n.scheduledSubState.plan.displayName(),e.finalSubState.billingSchedule.id){case P.ScheduleId.YEARLY:var o=a.amount,s=r.amount,c=T.format_percent(Math.round(100*(1-o/s)));return T._("Dropbox %(plan_name)s is %(price_per_year)s per year.           You’ll save %(save_percentage)s over monthly billing.").format({plan_name:l,price_per_year:a,save_percentage:c});case P.ScheduleId.MONTHLY:return T._("Dropbox %(plan_name)s is %(price_per_month)s per month.           You’ll spend %(price_per_year)s per year.").format({plan_name:l,price_per_month:t,price_per_year:a})}return""},t.prototype.getBillingItemTitle=function(e){switch(e){case P.ScheduleId.YEARLY:return T._("Billed yearly");case P.ScheduleId.MONTHLY:return T._("Billed monthly")}return""},t.prototype.getOriginalStatusForCurrentStatus=function(e,t){var a=this,n=this.state,i=n.allSubStatuses,r=n.subStatus;if(i&&r)return i.filter(function(n){return!!(n.finalSubState.plan&&r.finalSubState.plan&&n.finalSubState.billingSchedule)&&((n.subState.plan.productType===e||a.isProfessionalTrialPlan)&&n.finalSubState.billingSchedule.id===t)}).pop()},t.prototype.getSubStatusFromSubChangePlans=function(e,t){var a=this.state,n=a.subChangePlans,i=a.subStatus;if(n&&i)return n.filter(function(a){return!!(a.finalSubState.plan&&i.finalSubState.plan&&a.finalSubState.billingSchedule)&&(a.finalSubState.plan.productType===e&&a.finalSubState.billingSchedule.id===t)}).pop()},t.prototype.renderBillingScheduleItems=function(){var e=this,t=this.state,a=t.allSubStatuses,n=t.subStatus,r=t.schedule,l=t.hasLicenseKey;if(a&&n)return a.filter(function(t){return!!(t.finalSubState.plan&&n.subState.plan&&n.finalSubState.plan)&&(!e.isPlanScheduledToChange()||!e.isBillingScheduleToChange()||t.finalSubState.plan.productType===n.subState.plan.productType)}).sort(function(e,t){return e.finalSubState.billingSchedule&&t.finalSubState.billingSchedule?e.finalSubState.billingSchedule.id-t.finalSubState.billingSchedule.id:0}).map(function(t){var a=t.finalSubState.plan,o=t.finalSubState.billingSchedule;if(a&&o&&n.subState.billingSchedule&&n.subState.plan&&t.finalSubState.billingSchedule){var c=e.getOriginalStatusForCurrentStatus(n.subState.plan.productType,t.finalSubState.billingSchedule.id);if(c&&c.finalSubState.billingSchedule&&t.subState.billingSchedule){var u,d=a.displayCost,p=a.displayCost,m=a.displayCost,h=t.finalSubState.billingSchedule.id,_=n.subState.billingSchedule.id;switch(l&&n.scheduledSubState&&n.scheduledSubState.billingSchedule&&(_=n.scheduledSubState.billingSchedule.id),_){case P.ScheduleId.MONTHLY:u=T._("per month"),h===P.ScheduleId.YEARLY&&(p=d.divide(12),d=p),h===P.ScheduleId.MONTHLY&&(m=p.multiply(12));break;case P.ScheduleId.YEARLY:u=T._("per year"),h===P.ScheduleId.YEARLY&&(p=d.divide(12)),h===P.ScheduleId.MONTHLY&&(m=d.multiply(12),d=m)}var g,f,b=void 0,y=o.id===r;e.isPlanScheduledToChange()&&!e.isProfessionalTrialPlan&&(f=i.createElement("span",null,i.createElement("br",null),i.createElement("a",{href:"/plans",target:"_blank",rel:"noreferrer noopener"},T._("See other plans"))));return n.subState.billingSchedule.id===o.id&&(g=T._("(current billing period)")),i.createElement(s.AdminPricedListItem,{key:a.code,isSelected:y,title:e.getBillingItemTitle(o.id),titleWarningText:b,titleSecondaryText:g,description:e.getScheduleDescription(c,p,m),price:d,detailsLink:f,unit:u,onClick:e.changeProductPlanAndScheduleTypeClosure(a.productType,o.id),disableItem:e.isBillingScheduleToChange()})}}})},t.prototype.renderBillingSection=function(){return i.createElement("div",null,i.createElement(o.AdminPricedList,null,this.renderBillingScheduleItems()))},t.prototype.renderPaymentMethod=function(){var e=this.state.paymentMethod;if(e&&!this.isBillingScheduleToChange())return i.createElement("div",{className:"upgrade-payment-method-link"},i.createElement(b.IndividualInlinePaymentMethodView,{paymentMethod:e,updateBillingCTA:this.updateBillingInfo}))},t.prototype.isPlanScheduledToChange=function(){var e=this.state.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.state.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isBillingScheduleToChange=function(){var e=this.state,t=e.subStatus;return!e.hasLicenseKey&&!!(t&&t.subState.billingSchedule&&t.finalSubState.billingSchedule)&&t.subState.billingSchedule.id!==t.finalSubState.billingSchedule.id},t.prototype.getPlanNameWithEvhText=function(e){var t=this.state.subStatus;return t&&t.scheduledSubState&&t.scheduledSubState.quantityForEvhAddOn()>0?e+" "+T._("+ extended version history"):e},t.prototype.renderScheduleTransitionText=function(){var e=this.state.subStatus,t=this.getSubChangePlan();if(e&&e.subState.plan){var a=i.createElement("a",{href:"#",onClick:this.handleCancelScheduleAction},T._("Cancel change"));if(this.isBillingScheduleToChange())return i.createElement("span",{className:"plan-transition"},T._("You’ve already requested a change to your billing period. If you want             to choose a different billing period, first cancel your pending change.")," ",a);if(this.isProfessionalTrialPlan&&!this.hasScheduleChanged)return i.createElement("div",null,i.createElement("span",{className:"change-summary"},T._("Change summary")),i.createElement("p",{className:"plan-transition"},f.getProfessionalTrialScheduleDescription(e)));if((!t||this.isBillingScheduleToChange())&&e.currentBillingSummary)return this.isScheduledToChange()&&e.scheduledSubState&&e.scheduledSubState.plan?i.createElement("div",null,i.createElement("span",{className:"change-summary"},T._("Change summary")),i.createElement("p",{className:"plan-transition"},x.reactFormat(T._("Starting on %(date)s, we’ll bill you once a %(schedule_noun)s for your                   Dropbox %(plan_name)s plan. Your new %(schedule)s total will be %(scheduled_total)s.").format({plan_name:this.getPlanNameWithEvhText(e.scheduledSubState.plan.displayName()),date:e.subState.formattedNextBillingDate,schedule:e.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:e.scheduledSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:_.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)}),{strong:i.createElement("strong",null)}))):i.createElement("div",null,i.createElement("p",{className:"plan-transition"},T._("Your Dropbox %(plan)s plan will renew on %(date)s.                 Your current %(schedule)s total is %(recurring_total)s.").format({plan:this.getPlanNameWithEvhText(e.subState.plan.displayName()),schedule:e.subState.billingSchedule.scheduleDescriptionAdjective,recurring_total:_.Cash.formatWithTaxLabels(e.currentBillingSummary.total,e.currentBillingSummary),date:e.subState.formattedNextBillingDate})));if(e.scheduledSubState&&e.scheduledSubState.plan)return t&&t.finalSubState.plan?i.createElement("div",null,i.createElement("span",{className:"change-summary"},T._("Change summary")),i.createElement("p",{className:"plan-transition"},x.reactFormat(T._("Starting on %(date)s, we’ll bill you once a %(schedule_noun)s for your               Dropbox %(plan_name)s plan. Your new %(schedule)s total will be %(scheduled_total)s.               Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded               <legalLink>unless it’s legally required</legalLink>.").format({plan_name:this.getPlanNameWithEvhText(e.scheduledSubState.plan.displayName()),date:e.subState.formattedNextBillingDate,schedule:t.finalSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:t.finalSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:_.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}),{strong:i.createElement("strong",null),cancelLink:i.createElement("a",{href:"/help/billing/cancel-dropbox-plus"}),legalLink:i.createElement("a",{href:"/help/billing/plus-refund"})}))):i.createElement("div",null,i.createElement("span",{className:"change-summary"},T._("Change summary")),i.createElement("p",{className:"plan-transition"},x.reactFormat(T._("Starting on %(date)s, we’ll bill you once a %(schedule_noun)s for your                 Dropbox %(plan_name)s plan. Your new %(schedule)s total will be %(scheduled_total)s.                 Charges will continue until you <cancelLink>cancel</cancelLink>, and previous charges won’t be refunded                 <legalLink>unless it’s legally required</legalLink>.").format({plan_name:this.getPlanNameWithEvhText(e.scheduledSubState.plan.displayName()),date:e.subState.formattedNextBillingDate,schedule:e.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:e.scheduledSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:_.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary)}),{strong:i.createElement("strong",null),cancelLink:i.createElement("a",{href:"/help/billing/cancel-dropbox-plus"}),legalLink:i.createElement("a",{href:"/help/billing/plus-refund"})})))}},t.prototype.renderFooter=function(){return this.renderScheduleChangeFooter()},t.prototype.renderScheduleChangeFooter=function(){var e;return this.isBillingScheduleToChange()||(e=this.renderPaymentMethod()),i.createElement("div",{className:"plan-footer u-font-meta"},this.renderScheduleTransitionText(),e)},Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.state.paymentMethod,t=this.state,a=t.loadingContent,n=t.submitting;return!(!a&&!n&&e)||(!this.hasScheduleChanged||this.isBillingScheduleToChange())},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e,a=this,n=this.state.subStatus,r=this.props,l=r.transitionPerformed,o=r.paymentInfo,s=this.state,c=s.loadingContent,u=s.submitting,p=s.hasLicenseKey;if(c)e=i.createElement("div",{className:"loading-indicator"},i.createElement("img",{src:I.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:T._("Loading")}));else{var _=void 0;if(n&&l&&!this.isProfessionalTrialPlan){g.DBModalStack.clear(),g.DBModalStack.register(d.CHANGE_IND_PLAN_MODAL_UPDATED,function(){t.showInstance({transitionPerformed:a.transitionPerformedClosure})}),_=i.createElement(m.CancellableNotificationsView,{subStatus:n,transitionPerformed:this.transitionPerformedClosure,displaySingleChangeCancellationItem:h.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:o,hasLicenseKey:p,displayNewTotal:!1})}e=i.createElement("div",null,_,this.renderBillingSection(),this.renderFooter())}return i.createElement(S.Modal,{acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:T._("Confirm change"),className:"change-plan-modal",dismissButtonText:T._("Cancel"),onDismiss:this.onDismissModal,autoClose:!1,onAccept:this.onAccept,submitting:u,title:T._("Change billing period")},e)},t.ChangeScheduleModal=l(t,["/static/css/teams/admin/widgets/change_plan_modal/change_plan_modal-vfl_9HI5q.css"]),t})(i.Component);t.ChangeScheduleModalView=k}),define("modules/clean/account_page/widgets/plan/views/evh_modal",["require","exports","tslib","modules/core/notify","external/react","modules/clean/ajax","modules/clean/react/css","external/classnames","modules/core/i18n","modules/clean/react_format","modules/clean/payments/skus/constants","modules/clean/payments/billing_info_modal","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/account_page/widgets/plan/views/cancel_changes_modal","modules/clean/payments/cash","spectrum/checkbox","modules/clean/account_page/widgets/plan/views/individual_inline_payment_method","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/views/evh_removal_warning","modules/clean/react/modal","modules/clean/account_page/widgets/plan/types","modules/clean/analytics","modules/clean/payments/skus/subscription_service","modules/clean/payments/skus/subscription_change_plan","modules/clean/account_page/util"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.evhInfo.purchased,t=e?E.PerformPlanTransition.REMOVE_EVH:E.PerformPlanTransition.ADD_EVH;a.setState(function(e){return e.submitting=!0,e}),r.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:t},subject_user:T.getCurrentUser().id,success:function(e){n.Notify.success(s._("You’ve changed your plan!")),P.ProEventsLogger.log("de_evh_modal_toggle_evh"),a.props.transitionPerformed&&a.props.transitionPerformed(),v.Modal.close()},error:function(){n.Notify.error(s._("There was an error updating your plan!")),a.setState(function(e){return e.submitting=!1,e})}})},a.toggleEvh=function(){var e=a.props.evhInfo,t=a.state.isEvhSelected;e.scheduled_to_remove||(P.ProEventsLogger.log("de_evh_modal_change_evh_election",{from:t?"evh_on":"evh_off",to:t?"evh_off":"evh_on"}),a.setState({isEvhSelected:!t}))},a.cancelEvhChange=function(){return a.handleCancelActions(m.CancellationType.EVH_ADDON),!1},a.handleCancelActions=function(e){var t=a.props.subStatus;return t&&h.CancelChangesModalConfirmationView.showInstance({subStatus:t,transitionPerformed:a.props.transitionPerformed,cancellationType:e,reOpenModalDialogAfterCancellation:!0}),!1},a.transitionPerformedClosure=function(){if(a.props.transitionPerformed)return a.props.transitionPerformed()},a.updateBillingInfo=function(e){v.Modal.close(),y.DBModalStack.register(d.BILLING_INFO_UPDATED,function(){a.props.transitionPerformed&&a.props.transitionPerformed()}),b.IndividualUpdateBillingModalLoader.showInstance()},a.onAcceptEvhRemovalWarning=function(){S.EvhRemovalWarningModal.showInstance({evhInfo:a.props.evhInfo,transitionPerformed:a.props.transitionPerformed,subStatus:a.props.subStatus})},new w.SubscriptionService,a.state={isEvhSelected:t.evhInfo.purchased,submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){v.Modal.showInstance(i.createElement(t.EvhModalViewModal,a.__assign({},e)))},t.prototype.isProfessionalPlanScheduled=function(){var e=this.props.subStatus;return!!(e&&e.scheduledSubState&&e.scheduledSubState.plan)&&(e.scheduledSubState.plan.productType===u.ProductPlanType.PROFESSIONAL||e.scheduledSubState.plan.productType===u.ProductPlanType.PROFESSIONAL_TRIAL)},t.prototype.isPlanScheduledToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.plan&&e.finalSubState.plan)&&e.subState.plan.productType!==e.finalSubState.plan.productType},t.prototype.isScheduledToChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isEvhScheduledToChange=function(){var e=this.props.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isBillingScheduleToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.renderFooter=function(){var e=this.props,t=e.evhInfo,a=e.subStatus,n=this.state.isEvhSelected;if(t.scheduled_to_remove)return i.createElement("p",{className:"evh-modal-footer"},s._("You’ve already requested a plan change. If you want to choose a different plan,           first cancel your pending change.")," ",i.createElement("a",{onClick:this.cancelEvhChange},s._("Cancel change")));if(t.evh_transition&&a.subState&&a.subState.plan&&a.scheduledSubState&&a.scheduledSubState.plan){var r=C.SubscriptionChangePlan.deserialize(t.evh_transition);if(n){if(t.purchased)return this.isScheduledToChange()&&a.scheduledSubState&&a.scheduledSubState.plan?i.createElement("p",{className:"evh-modal-footer"},c.reactFormat(s._("Starting on %(date)s, we’ll bill you once a %(schedule_noun)s for your                 Dropbox %(plan_name)s plan and your new %(schedule)s total will be %(scheduled_total)s.").format({plan_name:a.scheduledSubState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,schedule_noun:a.scheduledSubState.billingSchedule.scheduleDescriptionNoun,scheduled_total:_.Cash.formatWithTaxLabels(a.nextBillingSummary.total,a.nextBillingSummary)}),{strong:i.createElement("strong",null)})):i.createElement("p",{className:"evh-modal-footer"},s._("Your Dropbox %(plan_name)s + extended version history plan will renew on %(date)s.                 Your current %(billing_schedule)s total is %(total)s.").format({plan_name:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,billing_schedule:a.subState.billingSchedule.scheduleDescriptionAdjective,total:a.currentBillingSummary?_.Cash.formatWithTaxLabels(a.currentBillingSummary.total,a.currentBillingSummary):""}));var l="";return r.tvm&&(l=_.Cash.formatWithTaxLabels(r.tvm.getTotalPrice(),r.nextBillingSummary)),i.createElement("div",{className:"evh-modal-footer"},i.createElement("span",{className:"change-summary"},s._("Change summary")),i.createElement("p",null,c.reactFormat(s._("You’re adding extended version history to your Dropbox %(plan_name)s plan.                   <strong>We’ll charge you %(prorated_price)s now</strong>, which has been prorated                   for the current billing period. Your plan will renew on %(date)s. Your new %(billing_schedule)s                   total will be %(recurring_total)s.").format({plan_name:a.scheduledSubState.plan.displayName(),prorated_price:l,date:a.subState.formattedNextBillingDate,billing_schedule:r.subState.billingSchedule.scheduleDescriptionAdjective,recurring_total:_.Cash.formatWithTaxLabels(r.nextBillingSummary.total,r.nextBillingSummary)}),{strong:i.createElement("strong",null)})))}return t.purchased&&r.scheduledSubState?i.createElement("div",{className:"evh-modal-footer"},i.createElement("span",{className:"change-summary"},s._("Change summary")),i.createElement("p",null,c.reactFormat(s._("Starting on %(date)s, your plan will be downgraded to Dropbox %(plan_name)s                 <strong>without</strong> extended version history. You will revert to %(days)s day version history.                 Your new %(billing_schedule)s total will be %(scheduled_total)s.").format({
date:a.subState.formattedNextBillingDate,plan_name:a.scheduledSubState.plan.displayName(),days:this.isProfessionalPlanScheduled()?"120":"30",billing_schedule:r.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,scheduled_total:_.Cash.formatWithTaxLabels(r.nextBillingSummary.total,r.nextBillingSummary)}),{strong:i.createElement("strong",null)}))):i.createElement("p",{className:"evh-modal-footer"},s._("Your Dropbox %(plan_name)s plan will renew on %(date)s.").format({plan_name:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate})," ",s._("Your current %(billing_schedule)s total is %(total)s.").format({billing_schedule:a.subState.billingSchedule.scheduleDescriptionAdjective,total:a.currentBillingSummary?_.Cash.formatWithTaxLabels(a.currentBillingSummary.total,a.currentBillingSummary):""}))}},t.prototype.getModalContent=function(){var e=this.props,t=e.evhInfo,a=e.subStatus,n=e.paymentInfo,r=this.state.isEvhSelected,l=r,c=s._("year");a.subState.billingSchedule&&(c=a.subState.billingSchedule.scheduleDescriptionNoun);var d=o({"evh-modal-toggle-box-price-box__price":!0,"evh-modal-toggle-box-price-box__price--disabled":t.scheduled_to_remove}),h=s._("See all deletion and version history of your files for one year.");return a.subState.addons.peekSkus()&&a.subState.addons.sku.adminCxId===u.AdminCxId.UNLIMITED_PAID_VERSION_HISTORY&&(h=s._("See all deletion and version history of your files for unlimited time.")),i.createElement("div",null,i.createElement(p.CancellableNotificationsView,{subStatus:a,transitionPerformed:this.transitionPerformedClosure,displaySingleChangeCancellationItem:m.CancellationType.ALL,reOpenModalDialogAfterCancellation:!0,paymentInfo:n,displayNewTotal:!1}),i.createElement("div",{className:"evh-modal-toggle-box"},i.createElement("div",{className:"evh-modal-toggle-box__toggle-btn"},i.createElement(g.Checkbox,{checked:l?"checked":"unchecked",onChange:this.toggleEvh,disabled:t.scheduled_to_remove})),i.createElement("div",{className:"evh-modal-toggle-box__desc"},i.createElement("label",{onClick:this.toggleEvh},i.createElement("p",{className:"evh-modal-toggle-box__desc-title"},s._("Extended version history"))),i.createElement("p",{className:"evh-modal-toggle-box__desc-description"},h),i.createElement("a",{className:"evh-modal-toggle-box__desc-link",href:"/help/security/extended-version-history",target:"_blank",rel:"noopener noreferrer"},s._("See EVH details"))),i.createElement("div",{className:"evh-modal-toggle-box-price-box"},i.createElement("p",{className:d},t.evh_price),i.createElement("span",{className:"evh-modal-toggle-box-price-box__price-desc"},s._("per %(schedule_noun)s").format({schedule_noun:c})))),this.renderFooter(),this.renderPaymentMethod())},t.prototype.renderPaymentMethod=function(){var e=this.props.paymentMethod;if(!this.acceptButtonDisabled&&e)return i.createElement("div",{className:"upgrade-payment-method-link"},i.createElement(f.IndividualInlinePaymentMethodView,{paymentMethod:e,updateBillingCTA:this.updateBillingInfo}))},Object.defineProperty(t.prototype,"acceptButtonDisabled",{get:function(){var e=this.props.evhInfo;return this.state.isEvhSelected===e.purchased||e.scheduled_to_remove},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.subStatus,a=e.transitionPerformed,n=this.state,r=n.submitting,l=n.isEvhSelected;t&&a&&y.DBModalStack.clear();var o=this.onAccept;return l||(o=this.onAcceptEvhRemovalWarning),i.createElement(v.Modal,{autoClose:!1,acceptButtonDisabled:this.acceptButtonDisabled,acceptButtonText:s._("Save change"),dismissButtonText:s._("Cancel"),onAccept:o,submitting:r,className:"evh-modal",title:s._("Edit EVH add-on")},this.getModalContent())},t.EvhModalViewModal=l(t,["/static/css/account/pagelet/evh_modal-vfltl8w3-.css"]),t})(i.Component);t.EvhModalView=N}),define("modules/clean/account_page/widgets/plan/views/evh_removal_warning",["require","exports","tslib","modules/clean/ajax","modules/clean/react/css","modules/core/notify","external/react","modules/core/i18n","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/types","modules/clean/react/modal","modules/clean/analytics","modules/clean/payments/skus/constants"],function(e,t,a,n,i,r,l,o,s,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){var e=a.props.evhInfo.purchased,t=e?c.PerformPlanTransition.REMOVE_EVH:c.PerformPlanTransition.ADD_EVH;a.setState(function(e){return e.submitting=!0,e}),n.WebRequest({url:"/account/perform_personal_transition",data:{transition_change_type:t},subject_user:s.getCurrentUser().id,success:function(e){r.Notify.success(o._("You’ve changed your plan!")),d.ProEventsLogger.log("de_evh_modal_toggle_evh"),a.props.transitionPerformed&&a.props.transitionPerformed(),u.Modal.close()},error:function(){r.Notify.error(o._("There was an error updating your plan!")),a.setState(function(e){return e.submitting=!1,e})}})},a.state={submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){u.Modal.showInstance(l.createElement(t.EvhRemovalWarningModalView,a.__assign({},e)))},t.prototype.render=function(){var e=this.props.subStatus,t=this.state.submitting;if(!e||!e.subState.plan)return l.createElement("noscript",null);var a=e.subState.plan.productType===p.ProductPlanType.PROFESSIONAL?"120":"30";return l.createElement(u.Modal,{title:o._("Removing EVH is permanent"),acceptButtonDisabled:this.state.submitting,autoClose:!1,acceptButtonText:o._("Confirm removal"),dismissButtonText:o._("Cancel change"),onAccept:this.onAccept,className:"evh-removal-warning-modal",submitting:t},l.createElement("div",null,l.createElement("p",{className:"evh-removal-warning-modal__desc"},o._("Are you sure you want to remove extended version history? Once you remove it,\n                  you won’t be able to add it back again. Your plan will change from one year of\n                  version history to the Dropbox %(plan)s length of %(days)s days\n                  of version history.").format({plan:e.subState.plan.displayName(!1,!0),days:a}))))},t.EvhRemovalWarningModalView=i(t,["/static/css/account/pagelet/evh_removal_warning-vfloW5p1U.css"]),t})(l.Component);t.EvhRemovalWarningModal=m}),define("modules/clean/account_page/widgets/plan/views/exp_change_plans_modal_redesign",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/css","modules/clean/static_urls","modules/constants/trademark","spectrum/modal"],function(e,t,a,n,i,r,l,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.submittingIcon=function(){return t.props.submitting?n.createElement("img",{src:l.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:i._("Loading")}):n.createElement("span",null)},t}return a.__extends(t,e),t.prototype.renderProChangePlansRedesignFeaturesSection=function(){var e=this.props.planAndPricingContent.quotaString;return n.createElement("section",null,n.createElement("ul",{role:"list",className:"reasons-list"},n.createElement("li",{className:"reasons-list__item"},n.createElement("p",{className:"reasons-list__item__title"},i._("Everything in your current plan")),n.createElement("p",{className:"reasons-list__item__desc"},i._("All the benefits you’re already enjoying, plus more powerful features"))),e&&n.createElement("li",{className:"reasons-list__item"},n.createElement("p",{className:"reasons-list__item__title"},i._("%(pro_quota)s of space").format({pro_quota:e})),n.createElement("p",{className:"reasons-list__item__desc"},i._("Hold even more stuff, with double the space of your current plan"))),n.createElement("li",{className:"reasons-list__item"},n.createElement("p",{className:"reasons-list__item__title"},i._("Showcase")),n.createElement("p",{className:"reasons-list__item__desc"},i._("Share your work beautifully, get feedback and keep tabs on who’s seen it"))),n.createElement("li",{className:"reasons-list__item"},n.createElement("p",{className:"reasons-list__item__title"},i._("Smart Sync")),n.createElement("p",{className:"reasons-list__item__desc"},i._("Save space on your hard drive while having access to all your files")))))},t.prototype.renderProChangePlansRedesignBillingSection=function(){var e=this.props,t=e.loadingChangeSummary,a=e.planAndPricingContent,r=a.scheduleString,s=a.priceString,c=a.changeSummaryString,u=a.scheduledPriceString,d=a.proratedPriceString;if(r&&s&&c&&d){var p=t?n.createElement("div",{className:"loading-indicator"},n.createElement("img",{src:l.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:i._("Loading")})):n.createElement("div",{className:"billing-section__summary__text"},c,this.props.renderPaymentMethod()),m=t?null:n.createElement("div",{className:"billing-section__pricing"},n.createElement("div",{className:"billing-section__pricing__line"},n.createElement("span",{className:"billing-section__pricing__label"},r),n.createElement("span",{className:"billing-section__pricing__amount billing-section__pricing__amount--emphasis"},u?u:s)),n.createElement("div",{className:"billing-section__pricing__line"},n.createElement("span",{className:"billing-section__pricing__label"},i._("Billed today")),n.createElement("span",{className:"billing-section__pricing__amount"},d)));return n.createElement("section",{className:"plan-footer billing-section"},n.createElement("div",{className:"billing-section__summary"},n.createElement("div",{className:"billing-section__summary__title"},i._("Dropbox %(trademark_professional)s billing summary").format({trademark_professional:o.TRADEMARK_PROFESSIONAL})),this.props.renderVat(),p),m)}return null},t.prototype.render=function(){var e=i._("Upgrade to Dropbox %(trademark_professional)s").format({trademark_professional:o.TRADEMARK_PROFESSIONAL});return n.createElement(s.UtilityModal,{className:"change-plan-modal exp-pro-change-plans-redesign",ariaLabel:i._("Upgrade plan modal"),displayCloseButton:!0,overlayClickClose:!0,title:e,primaryAction:i._("Upgrade plan"),secondaryAction:i._("Cancel"),onPrimaryAction:this.props.onAccept,onSecondaryAction:this.props.onDismiss,onRequestClose:this.props.onDismiss,shouldRequestCloseOnActions:!1,open:this.props.open,link:this.submittingIcon,width:640,height:580},this.props.scheduledNotifications,this.renderProChangePlansRedesignFeaturesSection(),this.renderProChangePlansRedesignBillingSection())},t})(n.Component);t.ExpChangePlanRedesignModal=r(c,["/static/css/account/pagelet/exp_change_plans_modal_redesign-vflFqph8j.css"])}),define("modules/clean/account_page/widgets/plan/views/individual_inline_payment_method",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/account_page/widgets/billing/payment_method_constants"],function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.updateBillingInfo=function(e){var a=t.props.updateBillingCTA;e.stopPropagation(),e.preventDefault(),a(e)},t}return a.__extends(t,e),t.prototype.renderCreditCard=function(){var e=this.props.paymentMethod;if(e){var t=e.account.slice(-4),a=i._("We’ll charge your card ending in %(last4)s.",{comment:"Letting the user know which credit card will be debited by indicating the last 4 digits."}).format({last4:t});return n.createElement("span",null,a," ",this.renderUpdateLink())}return n.createElement("span",null)},t.prototype.renderDirectDebit=function(){var e=this.props.paymentMethod;if(e){var t=e.account.slice(-4),a=i._("We’ll charge your IBAN ending in %(last4)s.",{comment:"Letting the user know which debit account will be debited by indicating the last 4 digits."}).format({last4:t});return n.createElement("span",null,a," ",this.renderUpdateLink())}return n.createElement("span",null)},t.prototype.renderPaypal=function(){return n.createElement("span",null,i._("We’ll charge your PayPal account.")," ",this.renderUpdateLink())},t.prototype.renderUpdateLink=function(){return n.createElement("a",{key:"updateBillingInfo",href:"#",onClick:this.updateBillingInfo},i._("Update billing information"))},t.prototype.render=function(){var e=this.props,t=e.paymentMethod,a=e.paymentErrorMessage;if(!t&&a)return n.createElement("span",null,a," ",this.renderUpdateLink());if(!t)return n.createElement("span",null);switch(t.gateway_id){case r.BRAINTREE:return this.renderCreditCard();case r.ADYEN_SEPA_GATEWAY:return this.renderDirectDebit();case r.PAYPAL:case r.PAYPAL_REFERENCE_TRANSACTION:return this.renderPaypal();default:return n.createElement("span",null)}},t})(n.Component);t.IndividualInlinePaymentMethodView=l}),define("modules/clean/account_page/widgets/plan/views/plan_container",["require","exports","tslib","modules/clean/payments/billing_info_modal","external/react","external/react-redux","modules/clean/react/css","modules/clean/web_timing_logger","modules/clean/account_page/util","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/plan/views/add_ons","modules/clean/account_page/widgets/plan/views/upsell_module","modules/clean/account_page/widgets/plan/views/cancel_plan","modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal","modules/clean/dbmodal_stack","modules/clean/account_page/widgets/plan/action_creators","modules/clean/account_page/widgets/billing/action_creators","modules/clean/account_page/widgets/plan/add_ons/action_creators","modules/clean/account_page/widgets/plan/plan_spectrum/action_creators","modules/clean/account_page/widgets/plan/referral_history/action_creators","modules/clean/account_page/widgets/plan/views/plan_status","modules/clean/account_page/widgets/plan/views/plan_spectrum","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/quota_usage","modules/clean/account_page/components/loading","modules/clean/account_page/widgets/plan/views/referral_space","modules/clean/account_page/widgets/plan/views/cancellable_notifications_view","modules/clean/growth/rebill_upsell/rebill_upsell_top_notification","modules/clean/analytics","modules/clean/payments/skus/subscription_status","modules/clean/stormcrow/experiment","modules/constants/trademark","modules/core/i18n","modules/clean/payments/skus/sku_content","modules/core/exception","modules/clean/teams/admin/widgets/billing_notifications/cancellable_item","modules/core/uri","modules/core/browser"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C,T,N,x,I,k,L,A,D,M,B,O,R,U){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var V=function(e,t){return{browserUpdateRequired:t.browserUpdateRequired,evhInfo:e.planTab.evhInfo,evhLoadingState:e.planTab.evhLoadingState,planInfo:e.planTab.planInfo,planSpectrumInfo:e.planTab.planSpectrumInfo,planSpectrumLoadingState:e.planTab.planSpectrumLoadingState,loadingState:e.planTab.loadingState,referralHistory:e.planTab.referralHistory,referralLoadingState:e.planTab.referralLoadingState,dataLoadedForTTI:"ready"===e.planTab.evhLoadingState&&"ready"===e.planTab.loadingState&&"ready"===e.planTab.referralLoadingState}},F=function(e){return{loadPlanInfo:function(t){return e(_.loadDataIfNecessary(t))},loadEvhInfo:function(t){return e(f.loadEvhInfoIfNecessary(t))},loadReferralHistory:function(t,a){return void 0===t&&(t=!1),void 0===a&&(a=0),e(y.loadReferralHistoryIfNecessary(t,a))},forceLoadBillingTab:function(t){return e(g.loadDataIfNecessary(t))},loadPlanSpectrum:function(t){return e(b.loadPlanSpectrum(t))}}},j=(function(e){function t(t){var a=e.call(this,t)||this;return a.handleRebillUpsell=function(e){e&&(e.showChangePlanConfirm&&P.ChangePlanModalView.showInstance({mode:P.ChangePlanMode.CONFIRM,transitionPerformed:a.forceReload}),e.showProUpsell&&x.showRebillUpsellTopNotification())},a.forceReload=function(){var e=a.props,t=e.loadEvhInfo,n=e.loadPlanInfo,i=e.forceLoadBillingTab,r=e.loadPlanSpectrum;t(!0),n(!0),i(!0),r(!0)},a.renderMigrateNotification=function(){if(a.props.planInfo.showMigrateMessage){var e=function(){return U.open_tab(new R.URI({path:"/help/space/professional-added-space"}).toString())};return i.createElement("div",{className:"cancellable-scheduled-notifications personal-cancellable-scheduled-notifications"},i.createElement("div",{className:"cancellable-scheduled-notifications cancellable-scheduled-notifications__items"},i.createElement(O.CancellableItemView,{title:D._("You’re getting more space! Your Professional plan will soon have 2TB of storage."),CTAText:D._("Learn more"),className:"cancel-billing-schedule",useCTA:!0,handleAction:e})))}},h.DBModalStack.register(n.BILLING_INFO_UPDATED,function(e,t){I.ProEventsLogger.log("de_payment_modal_save_click"),a.props.loadPlanInfo(!0),a.props.forceLoadBillingTab(!0),a.handleRebillUpsell(t)}),a}return a.__extends(t,e),t.prototype.componentDidMount=function(){this.props.loadPlanInfo(),this.props.loadReferralHistory(),this.props.loadEvhInfo(),this.props.loadPlanSpectrum(),this.checkTTIstate(),I.ProEventsLogger.log("de_plan_tab_view")},t.prototype.componentDidUpdate=function(){this.checkTTIstate()},t.prototype.checkTTIstate=function(){this.props.dataLoadedForTTI&&(o.mark_time_to_view(),o.mark_time_to_interactive())},Object.defineProperty(t.prototype,"isPersonalUser",{get:function(){return"personal"===s.getCurrentUser().role},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBusinessUser",{get:function(){return!this.isPersonalUser},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLicensePlan",{get:function(){var e=this.props.planInfo;if(!e)return!1;var t=e.paymentInfo;return t&&c.isLicenseKey(t.gateway_id)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasLicenseKey",{get:function(){var e=this.props.planInfo;return!!e&&e.hasLicenseKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLimitedTeam",{get:function(){return this.props.planInfo.isLimitedTeam},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subStatus",{get:function(){var e=this.props.planInfo.serializedSubStatus;if(e)return k.SubscriptionStatus.deserialize(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExternallyBilled",{get:function(){return void 0===this.subStatus},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlusTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&(this.subStatus.subState.plan.productType===E.ProductPlanType.TRIAL||this.subStatus.subState.plan.productType===E.ProductPlanType.PLUS_TRIAL)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isProfessionalTrialPlan",{get:function(){return!(!this.subStatus||!this.subStatus.subState.plan)&&this.subStatus.subState.plan.productType===E.ProductPlanType.PROFESSIONAL_TRIAL},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expSubgrowthBizWebClientUpsell",{get:function(){return L.Experiment(this.props.planInfo.expSubgrowthBizWebClientUpsell)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"expUjPlanSpectrumUpsell",{get:function(){return L.Experiment(this.props.planSpectrumInfo.variant)},enumerable:!0,configurable:!0}),t.prototype.isLoading=function(){return"ready"!==this.props.loadingState},t.prototype.renderAddOnsIfAvailable=function(){var e=this.props,t=e.evhInfo,a=e.evhLoadingState,n=e.planInfo,r=this.props.planInfo,l=r.paymentMethod,o=r.paymentInfo;if(!this.isLicensePlan&&t.is_available&&this.subStatus&&this.subStatus.subState.plan&&this.subStatus.subState.plan.productType!==E.ProductPlanType.FREE&&(this.isPersonalUser||this.isLimitedTeam))return i.createElement(u.AddOns,{subStatus:this.subStatus,scheduledForDowngrade:n.scheduledForDowngrade,evhInfo:t,evhLoadingState:a,paymentInfo:o,paymentMethod:l,transitionPerformed:this.forceReload})},t.prototype.renderUsageBreakdown=function(){var e=this.props.planInfo,t=e.isMSLTeamMember,a=e.isMSLUserOn,n=e.usageBreakdown,r=e.isTeamAdmin,l=e.plusSkuContent;if(!t||a)return i.createElement(w.QuotaUsage,{subStatus:this.subStatus,usageBreakdown:n,isPersonalUser:this.isPersonalUser,isLimitedTeam:this.isLimitedTeam,isMSLTeamMember:t,isTeamAdmin:r,plusSkuContent:l})},t.prototype.renderTotalTeamUsageBreakdown=function(){var e=this.props.planInfo,t=e.teamUsageBreakdown,a=e.plusSkuContent;if(t)return i.createElement(w.QuotaUsage,{subStatus:this.subStatus,usageBreakdown:t,isPersonalUser:!1,isLimitedTeam:!1,isMSLTeamMember:!1,plusSkuContent:a})},t.prototype.renderUpsell=function(){var e,t,a,n=this.props.planInfo,r=n.bizTrialDays,l=n.ncctVariant,o=n.ncctVariantCoalesced,s=n.isNcctTeam,c=n.serializedSubStatus,u=n.standardSkuContent,p=M.SkuContentClient.deserialize(u);if(B.assert(!p.hasUnlimitedSpace(),"Unlimited space is not implemented yet"),L.Experiment(l).variantIn("V10","V11","V12","V13")&&s)e=D._("Want to keep using Dropbox with your team?"),t=D._("Add your billing information so you don’t have to later. You’ll still get the         remaining days in your trial for free, and you won’t be charged until %(trial_end_date)s         after your free trial ends.").format({trial_end_date:c.subState.formattedNextBillingDate}),a={text:D._("Keep %(trademark_business)s").format({trademark_business:A.TRADEMARK_BUSINESS}),link:"/business/billing"};else{if(!this.expSubgrowthBizWebClientUpsell.variantIn("V1","V2"))return null;e=D._("Interested in Dropbox for your team?"),t=D._("With %(trademark_business)s, get %(plan_size)s or more for your team to securely share,         sync, and collaborate. Enjoy advanced data protection, admin controls, and dedicated support.").format({trademark_business:A.TRADEMARK_BUSINESS,plan_size:p.spaceShortFormTb()});a={text:L.Experiment(o).variantIs("V12")?D._("Try it free"):D._("Try free for %(trial_days)s days").format({trial_days:r}),link:"/business/try"}}return i.createElement(d.UpsellModule,{headline:e,text:t,cta:a})},t.prototype.render=function(){var e=this.props,t=e.browserUpdateRequired,a=e.evhInfo,n=e.planSpectrumInfo,r=this.props.planInfo,l=r.usageBreakdown,o=r.referralInfo,u=r.scheduledForDowngrade,d=r.paymentInfo,h=r.eligibleFor1tb,_=r.teamScheduledForDowngrade,g=r.isTeamAdmin,f=r.hasLicenseKey,b=r.hasUnusedLicenseKey,y=r.expWebAccountAndroidTrials,E=r.basicSkuContent,P=r.plusSkuContent,w=this.subStatus;if(this.isLoading())return i.createElement(C.Loading,null);var x=void 0;this.isExternallyBilled||u||this.isProfessionalTrialPlan||!this.isPersonalUser&&!this.isLimitedTeam||!d||c.shouldHideBillingChange(d.gateway_id,d.is_reseller_billing)||(x=i.createElement(p.CancelPlan,{usageBreakdown:l,subStatus:w,eligibleFor1tb:h,basicSkuContent:E}));var I,k=this.isBusinessUser&&!this.isLimitedTeam?void 0:i.createElement(T.ReferralSpace,{referralInfo:o,referralHistory:this.props.referralHistory,referralLoadingState:this.props.referralLoadingState}),L=this.isProfessionalTrialPlan?m.CancellationType.SCHEDULE:m.CancellationType.ALL;this.isExternallyBilled||this.isLicensePlan||this.isPlusTrialPlan||!this.isPersonalUser&&!this.isLimitedTeam||this.hasLicenseKey||(I=i.createElement(N.CancellableNotificationsView,{paymentInfo:d,subStatus:w,scheduledForDowngrade:u,transitionPerformed:this.forceReload,displaySingleChangeCancellationItem:L,reOpenModalDialogAfterCancellation:!1,displayNewTotal:!0}));var A=i.createElement(S.PlanStatus,{browserUpdateRequired:t,subStatus:w,scheduledForDowngrade:u,teamScheduledForDowngrade:_,showTeamScheduledForDowngrade:!1,evhInfo:a,onUpdate:this.forceReload,isPersonalUser:this.isPersonalUser,isLimitedTeam:this.isLimitedTeam,isExternallyBilled:this.isExternallyBilled,paymentInfo:d,isTeamAdmin:g,hasLicenseKey:f,hasUnusedLicenseKey:b,usageBreakdown:l,eligibleFor1tb:h,showCancelButton:!1,showChangeBillingPeriod:!0,isLoggedInUser:!0,isLoggedInAsTransactionOwner:!0,useSpecifiedRole:!1,planSpectrumVariant:n.variant,expWebAccountAndroidTrials:y});return i.createElement("div",{className:"account-plan-tab"},this.renderMigrateNotification(),I,this.renderUpsell(),!this.expSubgrowthBizWebClientUpsell.variantIn("V1","V2","CONTROL")&&this.expUjPlanSpectrumUpsell.variantIs("ON")&&i.createElement(v.PlanSpectrum,{subStatus:w,user:s.getCurrentUser(),basicSkuContent:E,plusSkuContent:P}),this.expSubgrowthBizWebClientUpsell.variantIs("V2")?this.renderUsageBreakdown():A,this.renderAddOnsIfAvailable(),this.expSubgrowthBizWebClientUpsell.variantIs("V2")?A:this.renderUsageBreakdown(),this.renderTotalTeamUsageBreakdown(),k,x)},t})(i.Component);t.PlanContainerComponent=j;var q=r.connect(V,F)(j);t.PlanContainer=l(q,["/static/css/account/pagelet/plan_tab-vflJHgIME.css"])}),define("modules/clean/account_page/widgets/plan/views/plan_spectrum",["require","exports","tslib","external/classnames","modules/clean/react/css","external/react","modules/core/browser","modules/core/i18n","modules/clean/static_urls","modules/constants/trademark","modules/clean/payments/skus/sku_content","modules/clean/payments/skus/constants","modules/clean/account_page/widgets/plan/plan_spectrum/types"],function(e,t,a,n,i,r,l,o,s,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=[d.ProductPlanType.PROFESSIONAL,d.ProductPlanType.PROFESSIONAL_TRIAL],h=function(e,t){var a=u.SkuContentClient.deserialize(e),n=u.SkuContentClient.deserialize(t);return i={},i[p.PlanType.Basic]={name:o._("Dropbox Basic"),image:"/static/images/growth/experiments/plan_spectrum/PlanIcons_Basic@2x-vflm-gFks.svg",faded:[p.PlanType.Plus,p.PlanType.Professional],caption:(r={},r[p.PlanType.Basic]={text:o._("Current plan")},r[p.PlanType.Plus]={text:a.spaceShortFormGb()},r[p.PlanType.Professional]={text:a.spaceShortFormGb()},r)},i[p.PlanType.Plus]={name:o._("Dropbox %(trademark_plus)s").format({trademark_plus:c.TRADEMARK_PLUS}),image:"/static/images/growth/experiments/plan_spectrum/PlanIcons_Plus@2x-vflCexdkY.svg",faded:[p.PlanType.Professional],caption:(l={},l[p.PlanType.Basic]={text:o._("Learn more"),link:"/plus?oqa=pspl",action:p.PlanSpectrumActions.BasicPlusClick},l[p.PlanType.Plus]={text:o._("Current plan")},l[p.PlanType.Professional]={text:n.spaceShortFormTb()},l)},i[p.PlanType.Professional]={name:o._("Dropbox Professional"),image:"/static/images/growth/experiments/plan_spectrum/PlanIcons_Professional@2x-vflUScX9j.svg",faded:[],caption:(s={},s[p.PlanType.Basic]={text:o._("Learn more"),link:"/pro?oqa=pspl",action:p.PlanSpectrumActions.BasicProClick},s[p.PlanType.Plus]={text:o._("Learn more"),link:"/pro?oqa=pspl",action:p.PlanSpectrumActions.PlusProClick},s[p.PlanType.Professional]={text:o._("Current plan")},s)},i;var i,r,l,s},_=(function(e){function i(){var a=null!==e&&e.apply(this,arguments)||this;return a.logAction=function(e){return function(t){t.preventDefault(),a.tracker.track(e),l.open_tab(t.currentTarget.href)}},a.renderColumn=function(e){var i=a.props,l=i.basicSkuContent,o=i.plusSkuContent,c=h(l,o)[e],u=a.state.planType,d=c.caption[u],p=n((m={},m[t.styles.column]=!0,m[t.styles.faded]=c.faded.indexOf(u)!==-1,m[t.styles.selected]=u===e,m));return r.createElement("div",{className:p,key:"column-"+e},r.createElement("img",{src:s.static_url(c.image),className:"illo",alt:""}),r.createElement("div",{className:t.styles.heading},c.name),d.link?r.createElement("a",{href:d.link,className:t.styles.captionLink,onClick:a.logAction(d.action)},d.text):r.createElement("div",{className:t.styles.caption},d.text));var m},a}return a.__extends(i,e),i.prototype.componentWillMount=function(){var e=this.props,t=e.subStatus,a=e.user,n=p.PlanType.Basic;t&&t.subState&&t.subState.plan&&(t.subState.plan.productFamily===d.ProductFamily.PRO?n=p.PlanType.Plus:m.indexOf(t.subState.plan.productType)!==-1&&(n=p.PlanType.Professional)),this.tracker=new p.PlanSpectrumTracker(a.id),this.setState({planType:n})},i.prototype.componentDidMount=function(){this.state.planType===p.PlanType.Basic?this.tracker.track(p.PlanSpectrumActions.BasicView):this.state.planType===p.PlanType.Plus&&this.tracker.track(p.PlanSpectrumActions.PlusView)},i.prototype.render=function(){var e=this.state.planType,a=[p.PlanType.Basic,p.PlanType.Plus,p.PlanType.Professional];return r.createElement("div",{className:t.styles.base},r.createElement("div",{className:t.styles.header},o._("Dropbox plans")),r.createElement("div",{className:t.styles.columns},a.map(this.renderColumn)),r.createElement("div",{className:t.styles.barWrapper},r.createElement("hr",{className:t.styles.bar}),r.createElement("div",{className:t.styles.barIcons},a.map(function(a){var i=n(t.styles.icon,(l={},l[t.styles.iconSelected]=a===e,l));return r.createElement("div",{className:i,key:"bar-"+a});var l}))))},i})(r.Component);t.PlanSpectrumComponent=_,t.styles={base:"plan-spectrum",header:"plan-spectrum__header",columns:"plan-spectrum__columns",column:"plan-spectrum__column",heading:"plan-spectrum__heading",caption:"plan-spectrum__caption",captionLink:"plan-spectrum__caption-link",faded:"plan-spectrum__column--faded",selected:"plan-spectrum__column--selected",plan:"plan-spectrum__plan",barWrapper:"plan-spectrum__bar-wrapper",bar:"plan-spectrum__bar",barIcons:"plan-spectrum__bar-icons",icon:"plan-spectrum__icon",iconSelected:"plan-spectrum__icon--selected"},t.PlanSpectrum=i(_,["/static/css/account/pagelet/plan_spectrum-vflhJiQUh.css"])}),define("modules/clean/account_page/widgets/plan/views/plan_status",["require","exports","tslib","modules/core/browser","modules/clean/deprecated/dbmodal_loading","external/react","modules/clean/viewer","modules/core/uri","modules/core/i18n","modules/core/exception","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader","modules/clean/account_page/widgets/billing/payment_methods_util","modules/clean/account_page/widgets/billing/payment_method_constants","modules/clean/account_page/util","modules/clean/static_urls","modules/clean/react/payments/error/browser_update_required_modal","modules/clean/payments/cash","modules/clean/account_page/widgets/plan/views/change_plan_modal","modules/clean/account_page/widgets/plan/views/change_schedule_modal","modules/clean/account_page/widgets/plan/views/cancel_subs_warning_modal","modules/clean/dbmodal_stack","modules/clean/payments/skus/constants","modules/clean/analytics","modules/clean/account_page/widgets/plan/plan_spectrum/types","modules/clean/react_format","modules/constants/trademark"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_,g,f,b,y,S,v,E,P,w,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T;(function(e){e[e.Cancel=0]="Cancel",e[e.Change=1]="Change",e[e.Manage=2]="Manage",e[e.Upgrade=3]="Upgrade"})(T||(T={}));var N=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isOverQuota=function(){return t.usage>t.quota},t.logSeePlanDetails=function(){E.ProEventsLogger.log("de_plan_tab_details_click")},t.cancelPlanClick=function(){t.props.isPersonalUser?n.redirect("/downgrade"):n.redirect("/team/cancel")},t.onChangeBillingPeriodClick=function(e){e.preventDefault();var a=t.props,n=a.browserUpdateRequired,i=a.scheduledForDowngrade,r=a.paymentInfo;i?y.CancelChangesModalConfirmation.showInstance({transitionPerformed:t.props.onUpdate,subStatus:t.props.subStatus}):(b.ChangeScheduleModalView.showInstance({transitionPerformed:t.props.onUpdate,paymentInfo:r,browserUpdateRequired:n}),E.ProEventsLogger.log("de_plan_tab_change_billing_open_modal"))},t.onUpdateBillingClick=function(e){if(e.preventDefault(),t.props.browserUpdateRequired)return void _.BrowserUpdateModalLoader.showInstance();u.IndividualUpdateBillingModalLoader.showInstance()},t.redirectToUpgrade=function(){E.ProEventsLogger.log("de_plan_tab_upgrade_to_plus_click");var e=t.isOverQuota()?"acc_plan_upgrade_overquota_btn":"acc_plan_upgrade",a=new o.URI({path:"/upgrade",query:{oqa:e}}).toString();if("ON"===t.props.planSpectrumVariant){var i=m.getCurrentUser(),r=new P.PlanSpectrumTracker(i.id);a=new o.URI({path:"/upgrade",query:{oqa:"pspl"}}).toString(),
r.track(P.PlanSpectrumActions.BasicUpgradeClick).then(function(){n.redirect(a)})}else n.redirect(a)},t.purchaseNowClick=function(){E.ProEventsLogger.log("de_plan_tab_purchase_now_click"),n.redirect("/pro/convert")},t.cancelTrialClick=function(){E.ProEventsLogger.log("de_plan_tab_cancel_trial_click"),n.redirect("/downgrade")},t.contactSupportClick=function(){E.ProEventsLogger.log("de_plan_tab_contact_support_click"),n.redirect("/support")},t.addPaymentClick=function(){E.ProEventsLogger.log("de_plan_tab_add_payment_method_click"),S.DBModalStack.push(new i({element_id:"add_billing_info",endpoint_url:"/add_billing_info_modal",html_in_error_msg:!0}))},t.openChangePlanModal=function(e){e&&e.preventDefault(),t.props.isLoggedInUser||(t.props.isPersonalUser?n.redirect("/account/plan"):n.redirect("/team/admin/billing/manage"));var a=t.props,i=a.browserUpdateRequired,r=a.scheduledForDowngrade,l=a.paymentInfo,o=a.planSpectrumVariant;if(r)y.CancelChangesModalConfirmation.showInstance({transitionPerformed:t.props.onUpdate,subStatus:t.props.subStatus,userIdOverride:t.getUserForModal()});else if(f.ChangePlanModalView.showInstance({browserUpdateRequired:i,transitionPerformed:t.props.onUpdate,paymentInfo:l,userIdOverride:t.getUserForModal()}),E.ProEventsLogger.log("de_plan_tab_change_plan_open_modal"),"ON"===o&&t.isPlusPlan()){var s=m.getCurrentUser(),c=new P.PlanSpectrumTracker(s.id);c.track(P.PlanSpectrumActions.PlusChangePlanClick)}},t.renderContactSupportLink=function(){return r.createElement("div",{className:"plan-status-section__contact_support_link"},r.createElement("a",{href:"#",onClick:t.contactSupportClick},s._("Contact support to change plan")))},t.renderBillingPeriod=function(){var e=t.props,a=e.paymentInfo,n=e.scheduledForDowngrade,i=e.hasUnusedLicenseKey;if(a&&t.props.showChangeBillingPeriod&&!i){var l=a.gateway_id,o=a.is_reseller_billing,c=a.end_date,u=a.deactivated,p=a.is_on_trial,m=a.reseller_name,h=a.reseller_link;if(!a.schedule_switchable&&!n&&!t.isProfessionalTrial()||d.shouldHideBillingChange(l,o)){var _=d.getBillingDisabledMessage({gatewayId:l,isResellerBilling:o,resellerName:m,resellerLink:h,dropboxPlan:C.TRADEMARK_PLUS,endDate:c,deactivated:u,isOnTrial:p});return r.createElement("span",{className:"plan-status-section__message"},_)}if(!t.isPlusTrial())return a.is_in_grace_period?r.createElement("a",{href:"#",className:"plan-status-section__link",onClick:t.onUpdateBillingClick},s._("Please update your billing information")):r.createElement("a",{href:"#",className:"plan-status-section__link",onClick:t.onChangeBillingPeriodClick},s._("Change billing period"))}},t.changePlanClick=function(){t.props.subStatus.subState.plan.isEnterprise?n.redirect("/team/admin/help?role=work"):n.redirect("/team/admin/billing/manage?show_switch_plan")},t.managePlanClick=function(){n.redirect("/team/admin/billing/manage")},t.createTrialCtaButtons=function(e,a){return void 0===e&&(e=!0),void 0===a&&(a=!1),a?r.createElement("div",{className:"plan-status-section__upgrade_btn trial-cta"},r.createElement("button",{className:"mc-button mc-button-secondary cancel-button",onClick:t.cancelTrialClick},s._("Cancel trial"))):e?r.createElement("div",{className:"plan-status-section__upgrade_btn trial-cta"},r.createElement("button",{className:"button-primary purchase-button",onClick:t.purchaseNowClick},s._("Purchase Now")),r.createElement("button",{className:"mc-button mc-button-secondary cancel-button",onClick:t.cancelTrialClick},s._("Cancel trial"))):r.createElement("div",{className:"plan-status-section__upgrade_btn trial-cta"},r.createElement("button",{className:"button-primary purchase-button",onClick:t.purchaseNowClick},s._("Purchase Now")))},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=n.get_href().match(/modal=([a-zA-Z_]*)/);if(e&&e.length>1){"plan"===e[1]&&this.isChangePlanSupported()&&this.openChangePlanModal()}},t.prototype.isChangePlanSupported=function(){var e=this.props,t=e.subStatus,a=e.eligibleFor1tb,n=e.isExternallyBilled,i=e.paymentInfo;return!!this.isInStandardSchedule()&&(!a&&(!!(i&&t&&t.subState.plan)&&(!d.shouldHideBillingChange(i.gateway_id,n)&&(this.isPlusPlan()||t.subState.plan.productType===v.ProductPlanType.PROFESSIONAL))))},Object.defineProperty(t.prototype,"usage",{get:function(){return this.props.usageBreakdown.usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plansURL",{get:function(){var e=this.props,t=e.isLoggedInUser,a=e.isTransactionInformationPage,n={oqa:"acc_plan_upgrade"};return a&&!t&&(n.trigger="nr"),new o.URI({path:"/plans",query:n}).toString()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"evhDisplayName",{get:function(){var e=this.props.evhInfo;return e.purchased?e.is_unlimited_evh?s._("unlimited version history"):s._("extended version history"):""},enumerable:!0,configurable:!0}),t.prototype.renderCancelPlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(T.Cancel):r.createElement("div",{className:"plan-status-section__upgrade_btn"},r.createElement("button",{className:"mc-button-secondary",onClick:this.cancelPlanClick},s._("Cancel plan")))},t.prototype.isPlusPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===v.ProductPlanType.STANDARD||e.subState.plan.productType===v.ProductPlanType.PLUS)},t.prototype.isProfessionalPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===v.ProductPlanType.PROFESSIONAL||e.subState.plan.productType===v.ProductPlanType.PROFESSIONAL_TRIAL)},t.prototype.isFreePlusPlan=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===v.ProductPlanType.FREE},t.prototype.isInStandardSchedule=function(){var e=this.props.subStatus;if(e&&e.subState&&e.subState.billingSchedule){var t=e.subState.billingSchedule.id;return t===v.ScheduleId.MONTHLY||t===v.ScheduleId.YEARLY}return!1},t.prototype.pendingScheduledChange=function(){return this.isPlanScheduledToChange()||this.isBillingScheduleToChange()||this.isEvhScheduledToChange()},t.prototype.isTaurusPlan=function(){var e=this.props.subStatus;if(e&&e.subState.plan){var t=e.subState.plan.productType;return t===v.ProductPlanType.PLUS||t===v.ProductPlanType.PLUS_TRIAL||t===v.ProductPlanType.PROFESSIONAL||t===v.ProductPlanType.PROFESSIONAL_TRIAL||t===v.ProductPlanType.PLUS_WITH_SS||t===v.ProductPlanType.PLUS_WITH_SS_TRIAL}return!1},t.prototype.isPlanScheduledToChange=function(){var e=this.props,t=e.subStatus;return!!e.scheduledForDowngrade||!!(t&&t.subState.plan&&t.finalSubState.plan)&&t.subState.plan.productType!==t.finalSubState.plan.productType},t.prototype.isEvhScheduledToChange=function(){var e=this.props.subStatus;return!(!e||!e.scheduledSubState)&&e.subState.quantityForEvhAddOn()!==e.scheduledSubState.quantityForEvhAddOn()},t.prototype.isBillingScheduleToChange=function(){var e=this.props.subStatus;return!!(e&&e.subState.billingSchedule&&e.finalSubState.billingSchedule)&&e.subState.billingSchedule.id!==e.finalSubState.billingSchedule.id},t.prototype.shouldDisplayChangePlan=function(){var e=this.getGatewayId();return e!==p.NOT_APPLICABLE&&!d.shouldHidePaymentMethod(e)&&!this.props.hasUnusedLicenseKey},t.prototype.getGatewayId=function(){var e=this.props.paymentInfo;return e?e.gateway_id:p.NOT_APPLICABLE},t.prototype.isTrialPlan=function(){return this.isPlusTrial()||this.isProfessionalTrial()},t.prototype.isPlusTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&(e.subState.plan.productType===v.ProductPlanType.TRIAL||e.subState.plan.productType===v.ProductPlanType.PLUS_TRIAL)},t.prototype.isProfessionalTrial=function(){var e=this.props.subStatus;return!(!e||!e.subState.plan)&&e.subState.plan.productType===v.ProductPlanType.PROFESSIONAL_TRIAL},t.prototype.isLicensePlan=function(){var e=this.props,t=e.hasLicenseKey,a=e.paymentInfo;return!!a&&(t||d.isLicenseKey(a.gateway_id))},t.prototype.renderLoginInstructions=function(e){var t,a;return a=this.props.userEmail?this.props.userEmail:s._("the account user"),t=e===T.Cancel?w.reactFormat(s._("Please login as %(email)s<br />to cancel your plan."),{br:r.createElement("br",null),email:a}):e===T.Change?w.reactFormat(s._("Please login as %(email)s<br />to change your plan."),{br:r.createElement("br",null),email:a}):e===T.Manage?w.reactFormat(s._("Please login as %(email)s<br />to manage your plan."),{br:r.createElement("br",null),email:a}):e===T.Upgrade?w.reactFormat(s._("Please login as %(email)s<br />to upgrade your plan."),{br:r.createElement("br",null),email:a}):w.reactFormat(s._("Please login as %(email)s."),{email:a}),r.createElement("div",{className:"plan-status-section__login-msg"},t)},t.prototype.getUserForModal=function(){var e=this.props,t=e.isPersonalUser,a=e.useSpecifiedRole,n=e.isLoggedInAsTransactionOwner,i=null;if(a&&n){var r=l.Viewer.get_viewer();i=t?r.personal_user?r.personal_user.id:null:r.work_user?r.work_user.id:null,c.assert(null!=i,"Could not find user for specified role; modal will fail")}return i},t.prototype.renderDropboxLogo=function(){return r.createElement("div",{className:"plan-status-section__icon u-mar-right-s"},r.createElement("img",{src:h.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg"),alt:""}))},t.prototype.getTeamName=function(){return this.props.isLoggedInAsTransactionOwner&&l.Viewer.get_viewer().team_name?l.Viewer.get_viewer().team_name:this.props.teamName?this.props.teamName:null},t.prototype.renderChangePlanButton=function(e){var t=this.props.paymentInfo;return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(T.Change):r.createElement("div",{className:"plan-status-section__upgrade_btn"},r.createElement("button",{className:"button-primary",onClick:e,disabled:t&&t.is_in_grace_period},s._("Change plan")))},t.prototype.renderManagePlanButton=function(){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(T.Manage):r.createElement("div",{className:"plan-status-section__upgrade_btn"},r.createElement("button",{className:"button-tertiary",onClick:this.managePlanClick},s._("Manage plan")))},t.prototype.renderBusinessPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isTeamAdmin,n=e.teamScheduledForDowngrade,i=e.showCancelButton;if(t&&t.subState.isDeactivatedTeam)return this.renderBasicPlanSection();if(t&&t.subState.plan){var o=t.subState.plan.productType===v.ProductPlanType.STANDARD,c=t.subState.plan.displayName(!1,o);o||(c=s._("%(trade_mark)s %(plan_title)s").format({trade_mark:C.TRADEMARK_BUSINESS,plan_title:c}));var u="",d=this.getTeamName();d&&(a?(u=s._("You’re an admin of the %(team_name)s Dropbox account.").format({team_name:d}),this.props.isLoggedInAsTransactionOwner||(u=s._("This account is an admin of the %(team_name)s Dropbox account.").format({team_name:d}))):(u=s._("You’re a member of the %(team_name)s Dropbox account.").format({team_name:d}),this.props.isLoggedInAsTransactionOwner||(u=s._("This account is a member of the %(team_name)s Dropbox account.").format({team_name:d}))));var p,m,h=l.Viewer.get_viewer();if(this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner)p=this.renderLoginInstructions(),m=null;else if(a||!this.props.isLoggedInUser){var _=t.subState.plan.productType;if(_===v.ProductPlanType.STANDARD||_===v.ProductPlanType.NEW_STANDARD||_===v.ProductPlanType.STANDARD_TRIAL?p=this.renderChangePlanButton(this.changePlanClick):_!==v.ProductPlanType.ADVANCED&&_!==v.ProductPlanType.ADVANCED_TRIAL||(p=this.renderManagePlanButton()),i&&(p=n?this.renderManagePlanButton():this.renderCancelPlanButton()),!t.subState.plan.isEnterprise){var g=s._("Manage your team in the Admin Console");this.props.isLoggedInAsTransactionOwner||(g=s._("Manage this team in the Admin Console")),m=r.createElement("p",null,r.createElement("a",{className:"plan-status-section__link",href:"/team/admin/billing/manage"},g))}}else!a&&h.is_paired&&(m=r.createElement("p",null,s._("Looking for details on another plan?")," ",r.createElement("a",{className:"plan-status-section__link plan-status-section__link--inline",href:"/account/plan?role=personal"},s._("Visit your personal account page."))));var f="";return this.props.showTeamScheduledForDowngrade&&n&&(f=s._("Any active members of your %(plan)s team will be downgraded to Dropbox Basic accounts         on %(date)s.").format({plan:c,date:t.formattedNextBillingDate}),this.props.isLoggedInAsTransactionOwner||(f=s._("Any active members of the %(plan)s team will be downgraded to Dropbox Basic accounts         on %(date)s.").format({plan:c,date:t.formattedNextBillingDate}))),r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},c),r.createElement("span",null,u),r.createElement("br",null),r.createElement("span",null,f),m),p)}},t.prototype.renderUpgradePlanButton=function(e){return this.props.isLoggedInUser&&!this.props.isLoggedInAsTransactionOwner?this.renderLoginInstructions(T.Upgrade):r.createElement("div",{className:"plan-status-section__upgrade_btn"},r.createElement("button",{className:"button-primary",onClick:this.redirectToUpgrade},e))},t.prototype.renderBasicPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isLimitedTeam,n=s._("Dropbox Basic");if(t){t.subState.plan&&(n=t.subState.plan.displayName());var i=void 0;if(a||t.subState.isDeactivatedTeam){var l=this.getTeamName(),o=s._("You’re a member of the %(team_name)s Dropbox account.").format({team_name:l});this.props.isLoggedInAsTransactionOwner||(o=s._("This account is a member of the %(team_name)s Dropbox account.").format({team_name:l})),i=r.createElement("p",{className:"plan-status-section__team_desc"},o)}var c=this.isOverQuota()?s._("Upgrade now"):s._("Upgrade");return r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},n),i,r.createElement("a",{className:"plan-status-section__link",href:this.plansURL,target:"_blank",rel:"noopener noreferrer"},s._("See other plans"))),this.renderUpgradePlanButton(c))}},t.prototype.renderResellerPlan=function(){var e=s._("Dropbox %(plus)s 1TB").format({plus:C.TRADEMARK_PLUS});return r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},e),r.createElement("p",{className:"plan-status-section__title_description"},this.renderBillingPeriod())))},t.prototype.renderPaidPlanSection=function(){var e=this.props,t=e.subStatus,a=e.evhInfo,n=e.expWebAccountAndroidTrials,i=e.isLimitedTeam,l=e.hasUnusedLicenseKey,o=e.paymentInfo,c=e.scheduledForDowngrade;if(t&&t.scheduledSubState&&t.subState.plan){var u,p=t.subState.plan;if(1024===p.specQuotaGb){var m=this.getGatewayId(),h=t.subState.plan.displayName(!1,!1,m,n);u=a.purchased?s._("Dropbox %(plus)s + %(evh)s").format({plus:h,evh:this.evhDisplayName,comment:"evh = Extended Version History"}):s._("Dropbox %(plus)s").format({plus:h})}else u=t.subState.plan.displayName(!0),a.purchased&&(u=s._("%(plus)s + %(evh)s").format({plus:u,evh:this.evhDisplayName,comment:"evh = Extended Version History"}));var _,f=void 0,b=void 0;if(o&&d.shouldHideBillingSummary(o.gateway_id,t.subState.plan.productType)?_="":t.currentBillingSummary&&t.subState.billingSchedule&&(_=s._("%(total)s per %(period)s.").format({total:g.Cash.formatWithTaxLabels(t.currentBillingSummary.total,t.currentBillingSummary),period:t.subState.billingSchedule.scheduleDescriptionNoun})),l&&(_=s._("Your license key will be activated and no         charge made to your payment method on file."),this.props.isLoggedInAsTransactionOwner||(_=s._("This account’s license key will be activated and no         charge made to the payment method on file."))),o&&!d.shouldHideBillingChange(o.gateway_id,o.is_reseller_billing)){var y="";if(this.pendingScheduledChange()&&t.scheduledSubState&&t.scheduledSubState.plan&&t.scheduledSubState.billingSchedule){var S=t.scheduledSubState.plan,v=void 0;if(1024===S.specQuotaGb){var h=t.scheduledSubState.plan.displayName(!1);v=a.purchased&&!a.scheduled_to_remove?s._("Dropbox %(plus)s + %(evh)s").format({plus:h,evh:this.evhDisplayName,comment:"evh = Extended Version History"}):s._("Dropbox %(plus)s").format({plus:h})}else v=t.scheduledSubState.plan.displayName(!0),a.purchased&&!a.scheduled_to_remove&&(v=s._("%(plus)s + %(evh)s").format({plus:v,evh:this.evhDisplayName,comment:"evh = Extended Version History"}));y=s._("Starting on %(date)s, we’ll bill you once a %(new_period_noun)s for your           %(plan)s plan. Your new %(new_period_adj)s total will be %(new_amount)s.").format({date:t.formattedNextBillingDate,new_period_noun:t.scheduledSubState.billingSchedule.scheduleDescriptionNoun,plan:v,new_period_adj:t.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,new_amount:g.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}),this.props.isLoggedInAsTransactionOwner||(y=s._("Starting on %(date)s, we’ll bill this account once a %(new_period_noun)s for           the %(plan)s plan. This account’s new %(new_period_adj)s total will be           %(new_amount)s.").format({date:t.formattedNextBillingDate,new_period_noun:t.scheduledSubState.billingSchedule.scheduleDescriptionNoun,plan:v,new_period_adj:t.scheduledSubState.billingSchedule.scheduleDescriptionAdjective,new_amount:g.Cash.formatWithTaxLabels(t.nextBillingSummary.total,t.nextBillingSummary)}))}else y=s._("Your %(plan)s plan will renew on %(date)s. %(billing_summary)s").format({plan:u,date:t.formattedNextBillingDate,billing_summary:_}),this.props.isLoggedInAsTransactionOwner||(y=s._("This account’s %(plan)s plan will renew on %(date)s. %(billing_summary)s").format({plan:u,date:t.formattedNextBillingDate,billing_summary:_}));f=r.createElement("span",null,y," ")}if(c){var E=s._("Your %(plan)s will downgrade to Dropbox Basic on         %(date)s.").format({plan:u,date:t.formattedNextBillingDate});this.props.isLoggedInAsTransactionOwner||(E=s._("This account’s %(plan)s will downgrade to Dropbox         Basic on %(date)s.").format({plan:u,date:t.formattedNextBillingDate})),f=r.createElement("span",null,E," ")}if(i){var P=this.getTeamName(),w=s._("You’re a member of the %(team_name)s Dropbox account.").format({team_name:P});this.props.isLoggedInAsTransactionOwner||(w=s._("This account is a member of the %(team_name)s Dropbox account.").format({team_name:P})),b=r.createElement("p",{className:"plan-status-section__team_desc"},w)}var C;return!o||d.shouldHideBillingChange(o.gateway_id,o.is_reseller_billing)||this.isInStandardSchedule()||(C=this.renderContactSupportLink()),this.shouldDisplayChangePlan()&&this.isInStandardSchedule()&&(this.isPlusPlan()&&!this.isTrialPlan()&&(C=this.renderChangePlanButton(this.openChangePlanModal)),this.isProfessionalPlan()&&!this.isTrialPlan()&&(C=this.renderChangePlanButton(this.openChangePlanModal))),this.props.showCancelButton&&!c&&(C=this.renderCancelPlanButton()),(this.isFreePlusPlan()||l)&&(C=this.renderContactSupportLink()),r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},u),b,r.createElement("p",{className:"plan-status-section__title_description"},f,!l&&this.renderPlanDetails(),r.createElement("br",null),this.renderBillingPeriod())),C)}},t.prototype.renderPlanDetails=function(){return r.createElement("a",{className:"plan-status-section__link",onClick:this.logSeePlanDetails,href:this.plansURL,target:"_blank",rel:"noopener noreferrer"},this.isTaurusPlan()?s._("See plan details"):s._("See available plans"))},t.prototype.renderTrialSection=function(){var e=this.props,t=e.expWebAccountAndroidTrials,a=e.subStatus,n=e.paymentInfo;if(a&&a.subState&&a.subState.plan&&n){var i=n.gateway_id,l=n.trial_info;if(l){var o=r.createElement("noscript",null);d.isIOS(i)||"V1"===t&&d.isAndroid(i)||(o=this.createTrialCtaButtons(!l.is_trial_overdue,this.isProfessionalTrial()));var c=s._("Dropbox %(plus)s").format({plus:a.subState.plan.displayName(!1,!1,i,t)});l.is_trial_overdue&&(c+=" "+s._("(Expired)"));var u;return u=this.isProfessionalTrial()?d.getProfessionalTrialPlanDescription(a):d.getTrialDescription(i,l,a.formattedNextBillingDate,t),r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},c),r.createElement("p",{className:"plan-status-section__title_description"},u," ",this.isProfessionalTrial()&&r.createElement("span",null,this.renderPlanDetails(),r.createElement("br",null),this.renderBillingPeriod()))),o)}}},Object.defineProperty(t.prototype,"hasSelfServablePaymentAfterLicensekey",{get:function(){var e=this.props.paymentInfo;return e&&!d.isLicenseKey(e.gateway_id)&&!d.shouldHidePaymentMethod(e.gateway_id)},enumerable:!0,configurable:!0}),t.prototype.renderLicensePlanSection=function(){var e=this.props.subStatus;if(!e||!e.subState||!e.subState.plan)return r.createElement("noscript",null);var t=s._("Dropbox %(plus)s").format({plus:e.subState.plan.displayName()}),a=r.createElement("noscript",null);if(this.props.hasUnusedLicenseKey){var n=s._("Your Dropbox %(plus)s plan was activated with a license key.         Your next license key will be activated on %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate});this.props.isLoggedInAsTransactionOwner||(n=s._("This Dropbox %(plus)s plan was activated with a license key.           The next license key will be activated on %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate}));var i=r.createElement("noscript",null);if(this.hasSelfServablePaymentAfterLicensekey)i=r.createElement("div",null,s._("No charge made to your payment method on file.")),this.props.isLoggedInAsTransactionOwner||(i=r.createElement("div",null,s._("No charge made to the payment method on file.")));else{var l=s._("You can add your payment information now to have            your subscription automatically renew when your keys expire.");this.props.isLoggedInAsTransactionOwner||(l=s._("The account owner can add payment information now to have               this subscription automatically renew when the keys expire.")),i=r.createElement("div",null,l,r.createElement("br",null),r.createElement("a",{href:"#",onClick:this.addPaymentClick},s._("Add payment method.")))}a=r.createElement("div",null,n,r.createElement("br",null),i)}else if(this.hasSelfServablePaymentAfterLicensekey){var o=e.scheduledSubState.billingSchedule.scheduleDescriptionNoun,c=s._("Your Dropbox %(plus)s plan was activated with a               license key. The plan will renew on %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),u=s._("%(new_total)s per %(new_period)s will be charged to your payment method on file.").format({new_total:g.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:o});this.props.isLoggedInAsTransactionOwner||(c=s._("This Dropbox %(plus)s plan was activated with a             license key. The plan will renew on %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),u=s._("%(new_total)s per %(new_period)s will be charged to the payment method on file.").format({new_total:g.Cash.formatWithTaxLabels(e.nextBillingSummary.total,e.nextBillingSummary),new_period:o})),a=r.createElement("div",null,c,r.createElement("br",null),u,r.createElement("br",null),this.renderBillingPeriod())}else{var c=s._("Your Dropbox %(plus)s plan was activated with a license key.                 The plan is active until %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),d=s._("You can add your payment information now to have               your subscription automatically renew when it expires.");this.props.isLoggedInAsTransactionOwner||(c=s._("This account’s Dropbox %(plus)s plan was activated with a license key.               The plan is active until %(date)s.").format({plus:C.TRADEMARK_PLUS,date:e.formattedNextBillingDate}),d=s._("The account owner can add payment information now to have               this subscription automatically renew when it expires.")),a=r.createElement("div",null,c,r.createElement("br",null),d,r.createElement("br",null),r.createElement("a",{href:"#",onClick:this.addPaymentClick},s._("Add payment method.")))}return r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},t),r.createElement("p",{className:"plan-status-section__title_description"},a)),this.renderContactSupportLink())},t.prototype.render1TBChangeablePlan=function(){var e=this.props,t=e.subStatus,a=e.paymentInfo,n=e.scheduledForDowngrade;if(!t||!t.subState||!t.subState.plan)return r.createElement("noscript",null);var i=t.subState.plan.displayName(!0),l="";t.subState.billingSchedule&&t.subState.billingSchedule.scheduleDescriptionNoun&&t.currentBillingSummary&&t.currentBillingSummary.total&&(l=s._("%(total)s per %(period)s.").format({total:g.Cash.formatWithTaxLabels(t.currentBillingSummary.total,t.currentBillingSummary),period:t.subState.billingSchedule.scheduleDescriptionNoun}));var o=r.createElement("noscript",null);if(a&&!d.shouldHideBillingChange(a.gateway_id,a.is_reseller_billing)){var c=s._("Your %(plan)s plan will renew on %(date)s. %(billing_summary)s").format({plan:i,date:t.formattedNextBillingDate,billing_summary:l});this.props.isLoggedInAsTransactionOwner||(c=s._("This account’s %(plan)s plan will renew on %(date)s.             %(billing_summary)s").format({plan:i,date:t.formattedNextBillingDate,billing_summary:l})),o=r.createElement("span",null,c)}if(n){var u=s._("Your %(plan)s will downgrade to Dropbox Basic on %(date)s. %(billing_summary)s").format({plan:i,date:t.formattedNextBillingDate,billing_summary:l});this.props.isLoggedInAsTransactionOwner||(u=s._("This account’s %(plan)s will downgrade to Dropbox Basic on %(date)s.           %(billing_summary)s").format({plan:i,date:t.formattedNextBillingDate,billing_summary:l})),o=r.createElement("span",null,u)}var p=this.renderContactSupportLink();return r.createElement("div",{className:"plan-status-section"},this.renderDropboxLogo(),r.createElement("div",{className:"plan-status-section__description"},r.createElement("h1",{className:"plan-status-section__title"},i),r.createElement("p",{className:"plan-status-section__title_description"},o,r.createElement("br",null),this.renderBillingPeriod())),p)},t.prototype.renderPlanSection=function(){var e=this.props,t=e.subStatus,a=e.isExternallyBilled,n=e.paymentInfo,i=e.isLimitedTeam;return e.eligibleFor1tb?this.render1TBChangeablePlan():a&&void 0!==n&&null!==n.reseller_name?this.renderResellerPlan():a&&i&&void 0!==n&&n.gateway_id===p.NOT_APPLICABLE?void 0:t&&t.subState.plan&&t.subState.plan.productFamily===v.ProductFamily.PRO?this.isTrialPlan()?this.renderTrialSection():this.isLicensePlan()?this.renderLicensePlanSection():this.renderPaidPlanSection():this.renderBasicPlanSection()},t.prototype.render=function(){var e=this.props,t=e.isPersonalUser,a=e.isLimitedTeam,n=t||a?this.renderPlanSection():this.renderBusinessPlanSection(),i=null;return"ON"===this.props.planSpectrumVariant&&(i=r.createElement("div",{className:"plan-status__header"},s._("Your plan"))),r.createElement("div",{className:"plan-status"},i,n)},t})(r.Component);t.PlanStatus=N}),define("modules/clean/account_page/widgets/plan/views/pro_upsell_modal_content",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/css","modules/clean/static_urls","modules/constants/trademark","modules/clean/react/image"],function(e,t,a,n,i,r,l,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){switch(this.props.expProPlansModalVariant){case"V1":return this.renderV1();case"V2":return this.renderV2();case"V3":return this.renderV3();default:return null}},t.prototype.renderV1=function(){var e=this.props,t=e.price,a=e.unit,r=e.quota,l=e.expProPlansModalV2Variant,s=t?t.toString():"-",c=t?a:"",u="V2"===l?i._("%(quota)s, Smart Sync, Showcase, and more.").format({quota:r}):i._("Showcase, Smart Sync, shared link controls, and more.");return n.createElement("section",null,n.createElement("div",{className:"pro-upsell"},n.createElement("h1",{className:"pro-upsell__headline"},i._("Do more with Dropbox %(trademark_pro)s").format({trademark_pro:o.TRADEMARK_PROFESSIONAL})),n.createElement("div",null,n.createElement("div",{className:"pro-upsell__price"},s),n.createElement("div",{className:"pro-upsell__price-schedule"},c))),n.createElement("ul",{role:"list",className:"reasons-list"},n.createElement("li",{className:"reasons-list__item reasons-list__item--professional"},i._("Everything in %(trademark_plus)s").format({trademark_plus:o.TRADEMARK_PLUS})),n.createElement("li",{className:"reasons-list__item"},u)))},t.prototype.renderV2=function(){var e=this.props,t=e.price,a=e.unit,r=t?t.toString():"-",l=t?a:"";return n.createElement("section",null,n.createElement("div",{className:"pro-upsell"},n.createElement("h1",{className:"pro-upsell__headline"},i._("Do more with Dropbox %(trademark_pro)s").format({trademark_pro:o.TRADEMARK_PROFESSIONAL})),n.createElement("div",null,n.createElement("div",{className:"pro-upsell__price"},r),n.createElement("div",{className:"pro-upsell__price-schedule"},l))),n.createElement("div",{className:"grid__container"},n.createElement("ul",{role:"list",className:"reasons-list reasons-list--margin-right"},n.createElement("li",{className:"reasons-list__item reasons-list__item--professional"},i._("Everything in %(trademark_plus)s").format({trademark_plus:o.TRADEMARK_PLUS})),n.createElement("li",{className:"reasons-list__item"},i._("Showcase")),n.createElement("li",{className:"reasons-list__item"},i._("Smart Sync"))),n.createElement("ul",{className:"reasons-list"},n.createElement("li",{className:"reasons-list__item"},i._("Advanced sharing controls")),n.createElement("li",{className:"reasons-list__item"},i._("Priority chat support")),n.createElement("li",{className:"reasons-list__item"},i._("Full text search")))))},t.prototype.renderV3=function(){var e=this.props,t=e.price,a=e.unit,r=t?t.toString():"-",c=t?a:"";return n.createElement("section",null,n.createElement("div",{className:"pro-upsell__image-wrapper"},n.createElement(s.Image,{className:"pro-upsell__image",alt:"",src:l.static_url("/static/images/growth/sell-more-faster-illo@2x-vflHz-UKV.png"),srcHiRes:l.static_url("/static/images/growth/sell-more-faster-illo@2x-vflHz-UKV.png")})),n.createElement("div",{className:"pro-upsell"},n.createElement("h1",{className:"pro-upsell__headline"},i._("What’s included in Dropbox %(trademark_pro)s?").format({trademark_pro:o.TRADEMARK_PROFESSIONAL})),n.createElement("div",null,n.createElement("div",{className:"pro-upsell__price"},r),n.createElement("div",{className:"pro-upsell__price-schedule"},c))),n.createElement("div",{className:"grid__container"},n.createElement("ul",{role:"list",className:"reasons-list reasons-list--margin-right"},n.createElement("li",{className:"reasons-list__item reasons-list__item--professional"},i._("Everything in %(trademark_plus)s").format({trademark_plus:o.TRADEMARK_PLUS})),n.createElement("li",{
className:"reasons-list__item"},i._("Showcase"))),n.createElement("ul",{className:"reasons-list"},n.createElement("li",{className:"reasons-list__item"},i._("Advanced sharing controls")),n.createElement("li",{className:"reasons-list__item"},i._("Smart Sync")))))},t})(n.Component);t.ProUpsellModalContent=r(c,["/static/css/teams/admin/widgets/change_plan_modal/pro_upsell_modal_content-vfl_-AQOx.css"])}),define("modules/clean/account_page/widgets/plan/views/quota_usage",["require","exports","tslib","external/react","external/classnames","modules/core/browser","modules/clean/react/css","modules/clean/viewer","modules/core/i18n","modules/clean/display_format","modules/clean/react_format","modules/constants/trademark","modules/clean/payments/skus/sku_content"],function(e,t,a,n,i,r,l,o,s,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.formatBytes=function(e){return c.format_bytes(e,2,!0,!0,!1)},t.onClickAdvancedUpgrade=function(e){e.preventDefault(),r.redirect("/team/admin/billing/manage")},t}return a.__extends(t,e),Object.defineProperty(t.prototype,"teamName",{get:function(){return o.Viewer.get_viewer().team_name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"freeSpace",{get:function(){var e=this.props.usageBreakdown;return e.quota-e.usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharedFiles",{get:function(){return this.props.usageBreakdown.shared_usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"regularFiles",{get:function(){return this.props.usageBreakdown.unshared_usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"usage",{get:function(){return this.props.usageBreakdown.usage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"quota",{get:function(){return this.props.usageBreakdown.quota||.01},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOverQuota",{get:function(){return this.usage>this.quota},enumerable:!0,configurable:!0}),t.prototype.getQuotaUpsell=function(){var e=this.props,t=e.subStatus,a=e.isPersonalUser,i=e.isLimitedTeam,r=e.isMSLTeamMember,l=e.isTeamAdmin,o=e.plusSkuContent;if(t){var c=p.SkuContentClient.deserialize(o),m=null,h=t.subState.plan,_=n.createElement("span",null,s._("When your team runs out of space, accounts will stop syncing         and you won’t be able to add any new files.")," ");return a||i?!h&&this.isOverQuota&&c.spaceLongFormRounded()&&(m=n.createElement("div",{className:"quota-upsell"},s._("With %(plan)s, get %(plus_space_long_form_rounded)s for all your photos, videos, docs and other files.               Keep everything stored safely and at your fingertips.").format({plan:d.TRADEMARK_PLUS,plus_space_long_form_rounded:c.spaceLongFormRounded()})," ",n.createElement("a",{href:"/upgrade?oqa=acc_plan_upgrade_overquota_link"},s._("Upgrade now")))):r?this.isOverQuota&&(m=n.createElement("div",{className:"quota-upsell"},s._("Your Dropbox account is full. To continue, remove files or ask your admin for\n                more space. "),n.createElement("a",{href:"/help/business/space-limit-full"},s._("Learn more about Dropbox space")))):m=h&&(h.isAdvancePlan||h.isLegacyPlan)?n.createElement("div",{className:"quota-upsell"},_,l?u.reactFormat(s._("To add more space, <a>contact support</a>."),{a:n.createElement("a",{href:"/support",target:"_blank",rel:"noopener noreferrer"})}):s._("Contact your admin to add more space.")):n.createElement("div",{className:"quota-upsell"},_,l?u.reactFormat(s._("<a>Upgrade to an Advanced plan</a> to get more space."),{a:n.createElement("a",{href:"",onClick:this.onClickAdvancedUpgrade})}):u.reactFormat(s._("Contact your admin to upgrade to an <a>Advanced plan</a> and get more space."),{a:n.createElement("a",{href:"/business/plans-comparison",target:"_blank",rel:"noopener noreferrer"})})),m}},t.prototype.render=function(){var e=this.props,t=e.isPersonalUser,a=e.isLimitedTeam,r=e.isMSLTeamMember,l="",o=u.reactFormat(s._("Using <strong>%(usage)s</strong> of %(quota)s").format({usage:this.formatBytes(this.usage),quota:this.formatBytes(this.quota)}),{strong:n.createElement("strong",{key:"quota-strong"})});l=t||a?this.isOverQuota?s._("Your Personal Dropbox account is full"):s._("Personal Dropbox space"):r?this.isOverQuota?s._("Your Dropbox account space is full"):s._("Your Dropbox account space"):this.isOverQuota?s._("Your %(team_name)s account is full").format({team_name:this.teamName}):s._("%(team_name)s — space").format({team_name:this.teamName});var c=100*this.regularFiles/this.quota,d=c>100?"100":c.toFixed(20),p=d+"%",m=100*this.sharedFiles/this.quota,h=m>100?"100":m.toFixed(20),_=h+"%",g={width:p},f={width:_},b=i({"account-plan-tab-quota-usage":!0,"is-within-quota":!this.isOverQuota,"is-over-quota":this.isOverQuota}),y=i({"bar-graph-part":!0,"bar-graph-normal":!0,"normal-color":!0,"is-zero":0===this.usage}),S=i({"bar-graph-part":!0,"bar-graph-shared":!0,"bar-shared-color":!0,"is-zero":0===this.sharedFiles}),v=i({"bar-graph-legend":!0,"bar-graph-normal":!0,"normal-color":!0}),E=i({"bar-graph-legend":!0,"bar-graph-shared":!0,"shared-color":!0}),P=this.getQuotaUpsell(),w=this.isOverQuota?void 0:n.createElement("div",{className:"bar-graph-legend-group"},n.createElement("div",{className:"bar-graph-legend bar-graph-free"}),n.createElement("span",{className:"bar-graph-key-text"},s._("Unused space")," (",this.formatBytes(this.freeSpace),")"));return n.createElement("div",{className:b},n.createElement("div",{className:"quota-header"},n.createElement("span",{className:"quota-header quota-header__plan"},l),n.createElement("span",{className:"quota-header quota-header__usage"},o)),n.createElement("div",{className:"quota-space-bar"},n.createElement("div",{className:"bar-graph"},n.createElement("div",{className:y,style:g}),n.createElement("div",{className:S,style:f}))),n.createElement("div",{className:"quota-space-legend"},n.createElement("div",{className:"bar-graph-key"},n.createElement("div",{className:"space-key"},n.createElement("div",{className:"bar-graph-legend-group"},n.createElement("div",{className:v}),n.createElement("span",{className:"bar-graph-key-text"},s._("Regular files")," (",this.formatBytes(this.regularFiles),")")),n.createElement("div",{className:"bar-graph-legend-group"},n.createElement("div",{className:E}),n.createElement("span",{className:"bar-graph-key-text"},s._("Shared files")," (",this.formatBytes(this.sharedFiles),")")),w))),P)},t})(n.Component);t.QuotaUsageView=m,t.QuotaUsage=l(m,["/static/css/account/pagelet/quota_usage-vflqT1pDK.css"])}),define("modules/clean/account_page/widgets/plan/views/referral_space",["require","exports","tslib","modules/core/browser","external/react","modules/clean/react/css","modules/core/i18n","modules/clean/account_page/util","modules/clean/account_page/widgets/plan/referral_history/api","modules/clean/static_urls","modules/clean/account_page/components/account_table","modules/clean/account_page/components/button_block","modules/clean/analytics"],function(e,t,a,n,i,r,l,o,s,c,u,d,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=(function(e){function t(t){var n=e.call(this,t)||this;return n.buildReferralHistoryIfNecessary=function(){var e=n.state.history;if(null!==e&&null!==e.rows&&0!==e.rows.length)return i.createElement("div",{className:"referral-table-container"},i.createElement(u.Table,{className:"referral-table"},i.createElement(u.TableHead,null,i.createElement(u.HeaderRow,{className:"referral-header-row"},i.createElement(u.HeaderCell,{className:"referral-bonus-type-header"},l._("Bonus type")),i.createElement(u.HeaderCell,{className:"referral-description-header"}),i.createElement(u.HeaderCell,{className:"referral-updated-header"},l._("Updated")),i.createElement(u.HeaderCell,{className:"referral-earned-header"},l._("Space earned")))),i.createElement(u.TableFooter,{className:"referral-footer"},n.buildReferralFooter()),i.createElement(u.TableBody,null,e.rows.map(function(e,t){if(n.state.showMore||!(t>2))return n.buildReferralRow(e)}))))},n.loadMoreReferralHistory=function(e){return a.__awaiter(n,void 0,void 0,function(){var t;return a.__generator(this,function(a){switch(a.label){case 0:return this.setState({isLoading:!0}),p.ProEventsLogger.log("de_earn_space_view_more_click"),e.preventDefault(),this.state.showMore?[4,s.getReferralHistory(o.getCurrentUser().id,this.state.currentPage+1)]:(this.setState({showMore:!0,isLoading:!1}),[2,!1]);case 1:return t=a.sent(),t.rows=this.state.history.rows.concat(t.rows),this.setState({currentPage:this.state.currentPage+1,history:t,isLoading:!1}),[2,!1]}})})},n.buildReferralFooter=function(){var e=n.state.history;if(n.state.isLoading)return i.createElement("tr",{className:"referral-footer-row"},i.createElement("td",{colSpan:4},i.createElement("img",{src:c.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:l._("Loading")})));if(!(!n.state.showMore&&e.rows.length<3||n.state.showMore&&!e.has_more))return i.createElement("tr",{className:"referral-footer-row"},i.createElement("td",{colSpan:4},i.createElement("a",{onClick:n.loadMoreReferralHistory,href:"#",rel:"noopener noreferrer"},l._("View more earned space"))))},n.buildReferralRow=function(e){var t=null,a=null;return t=e.type.url?i.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.type.url},e.type.str):i.createElement("span",null,e.type.str),a=e.earned.completed?i.createElement("div",null,i.createElement("span",{className:"earned-space"},e.earned.str),i.createElement("img",{src:c.static_url("/static/images/icon_checkmark-vflExOh3Y.png"),alt:""})):e.earned.url?i.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:e.earned.url},e.earned.str):i.createElement("span",null,e.earned.str),i.createElement(u.BodyRow,{className:"referral-body-row",key:e.details+e.updated},i.createElement(u.BodyCell,{className:"referral-bonus-type"},t),i.createElement(u.BodyCell,{className:"referral-description"},e.details),i.createElement(u.BodyCell,{className:"referral-updated"},e.updated),i.createElement(u.BodyCell,{className:"referral-earned"},a))},n.state={history:n.props.referralHistory,showMore:!1,isLoading:!1,currentPage:0},n}return a.__extends(t,e),t.prototype.buildInvitePhrase=function(e){return l._("You can earn more space by referring your friend to Dropbox! You’ll       get a %(referral_amount)s bonus when they install Dropbox on their computer.").format({referral_amount:e})},t.prototype.isLoading=function(){return"ready"!==this.props.referralLoadingState},t.prototype.inviteFriendClick=function(){p.ProEventsLogger.log("de_earn_space_invite_click"),n.redirect("/referrals")},t.prototype.render=function(){if(this.isLoading())return i.createElement("div",{className:"loading-indicator"},i.createElement("img",{src:c.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:l._("Loading")}));var e=this.props.referralInfo;return i.createElement("div",{className:"referral-space"},i.createElement(d.ButtonBlock,{label:l._("Earn more space (%(current_space)s earned)").format({current_space:e.currentSpace}),subtext:this.buildInvitePhrase(e.referralAmount),buttonText:l._("Invite a friend"),kind:"secondary",buttonAction:{kind:"function",handler:this.inviteFriendClick}}),this.buildReferralHistoryIfNecessary())},t})(i.Component);t.ReferralSpace=r(m,["/static/css/account/pagelet/referral_space-vflqD-0ia.css"])}),define("modules/clean/account_page/widgets/plan/views/upsell_module",["require","exports","tslib","external/react","spectrum/button","modules/clean/react/css"],function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.headline,a=e.text,r=e.cta;return n.createElement("section",{className:"upsell-module"},n.createElement("div",{className:"upsell-module__content-container"},n.createElement("div",{className:"upsell-module__text-wrapper"},n.createElement("h2",{className:"upsell-module__headline"},t),n.createElement("p",{className:"upsell-module__body"},a)),n.createElement(i.Button,{className:"upsell-module__button",href:r.link},r.text)))},t})(n.Component);t.UpsellModule=r(l,["/static/css/account/pagelet/upsell_module-vfl7bv9Cr.css"])}),define("modules/clean/deprecated/dbmodal_loading",["require","exports","tslib","modules/clean/dbmodal","modules/clean/deprecated/uirequest"],function(e,t,a,n,i){"use strict";var r=(function(e){function t(t){return e.call(this,t)||this}return a.__extends(t,e),t.initClass=function(){this.prototype.on_confirm_button_click=null,this.prototype.on_cancel_button_click=null},t.prototype.on_show=function(){return this.fetch()},t.prototype.fetch=function(){var e=this;return new i(this.$modal_window,this.options.endpoint_url,{data:this.options.parameters||{},subject_user:this.options.subject_user,html_in_error_msg:this.options.html_in_error_msg,error:function(t,a,n){return e.hide()}})},t})(n.DBModal);return r.initClass(),r}),define("modules/clean/growth/gating",["require","exports","tslib","modules/clean/ajax"],function(e,t,a,n){"use strict";function i(e,t,i){return void 0===i&&(i={}),Promise.resolve().then(function(){return n.SilentBackgroundRequest(a.__assign({url:"/growth/gating_check",subject_user:e.id,data:{experiment:t}},i))}).then(function(e){return JSON.parse(e)})}function r(e,t,a){return void 0===a&&(a={}),l(e,t,a,!0)}function l(e,a,n,r){return void 0===n&&(n={}),void 0===r&&(r=!1),r?t.gatingCache.has(e.id,a)?t.gatingCache.get(e.id,a):t.gatingCache.set(e.id,a,i(e,a,n)):i(e,a,n)}function o(e,a,n){return void 0===n&&(n={}),"personal"!==e.role||e.paid?Promise.resolve(t.inactiveGatingStatus):l(e,a,n)}Object.defineProperty(t,"__esModule",{value:!0}),t.inactiveGatingStatus={is_active:!1,variant:"OFF"};var s=(function(){function e(){this.cache={}}return e.prototype.clear=function(){this.cache={}},e.prototype.has=function(e,t){return!!this.get(e,t)},e.prototype.get=function(e,t){return this.cache[e]&&this.cache[e][t]},e.prototype.set=function(e,t,a){return this.cache[e]=this.cache[e]||{},this.cache[e][t]=a,a},e})();t.gatingCache=new s,t.gatingRequest=i,t.growthPrecacheGating=r,t.growthCheckGating=l,t.growthCheckBasicUserGating=o}),define("modules/clean/growth/rebill_upsell/rebill_upsell_top_notification",["require","exports","tslib","external/react","modules/core/i18n","modules/core/browser","modules/clean/viewer","modules/clean/react/top_notification_bar","modules/constants/trademark","modules/clean/growth/user_action/tracker","modules/clean/growth/rebill_upsell/rebill_upsell_tracker"],function(e,t,a,n,i,r,l,o,s,c,u){"use strict";function d(){o.TopNotificationBar.show(n.createElement(m,{user:l.Viewer.get_viewer().get_users()[0]}))}Object.defineProperty(t,"__esModule",{value:!0});var p=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClickCTA=function(e){e.preventDefault(),t.props.track(u.RebillUpsellActions.REBILL_UPSELL_BANNER_CLICK_CTA),r.redirect("/pro?_tk=uj_rebill_upsell")},t.onDismiss=function(){t.props.track(u.RebillUpsellActions.REBILL_UPSELL_BANNER_DISMISS)},t}return a.__extends(t,e),t.prototype.render=function(){return n.createElement(o.TopNotificationBar,{type:"info",onDismiss:this.onDismiss},n.createElement("span",{className:"top-notification-bar__text"},i._("Explore Dropbox %(trademark_pro)s, a new plan with powerful features like Smart Sync and %(trademark_showcase)s.").format({trademark_pro:s.TRADEMARK_PROFESSIONAL,trademark_showcase:s.PROFESSIONAL_SHARING})),n.createElement("a",{href:"/pro?_tk=uj_rebill_upsell",className:"top-notification-link-button freshbutton-blue enabled",onClick:this.onClickCTA},i._("Learn more")))},t})(n.Component),m=c.withGrowthTracking("uj_rebill_upsell",{mount:u.RebillUpsellActions.REBILL_UPSELL_BANNER_VIEW})(p);t.showRebillUpsellTopNotification=d}),define("modules/clean/growth/rebill_upsell/rebill_upsell_tracker",["require","exports","tslib","modules/clean/growth/user_action/tracker"],function(e,t,a,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.REBILL_UPSELL_BANNER_VIEW="uj_rebill_upsell-banner-view",e.REBILL_UPSELL_BANNER_DISMISS="uj_rebill_upsell-banner-dismiss",e.REBILL_UPSELL_BANNER_CLICK_CTA="uj_rebill_upsell-banner-click_cta"})(t.RebillUpsellActions||(t.RebillUpsellActions={}));var i=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.project="uj_rebill_upsell",t}return a.__extends(t,e),t})(n.GrowthUserActionTracker);t.RebillUpsellTracker=i}),define("modules/clean/growth/user_action/tracker",["require","exports","tslib","react","external/lodash","external/hoist-non-react-statics","modules/clean/ajax"],function(e,t,a,n,i,r,l){"use strict";function o(e,t){return function(i){return r((function(r){function l(t){var a=r.call(this,t)||this;return a.tracker=new s(a.props.user.id,{project:e}),a.track=a.tracker.track.bind(a.tracker),a}return a.__extends(l,r),l.prototype.componentDidMount=function(){t&&t.mount&&this.tracker.track(t.mount)},l.prototype.componentWillUnmount=function(){t&&t.unmount&&this.tracker.track(t.unmount)},l.prototype.render=function(){return n.createElement(i,a.__assign({track:this.track},this.props))},l.displayName="WithGrowthTracking("+(i.displayName||"Component"),l})(n.Component),i)}}Object.defineProperty(t,"__esModule",{value:!0});var s=(function(){function e(e,t){this.userId=e,this.timers={},t&&t.project&&(this.project=t.project)}return e.prototype.startTimer=function(e){this.timers[e]={start:Date.now(),end:0}},e.prototype.stopTimer=function(e){this.timers[e]&&!this.timers[e].end&&(this.timers[e].end=Date.now())},e.prototype.clearTimer=function(e){delete this.timers[e]},e.prototype.getDuration=function(e){return this.timers[e]?this.timers[e].end?this.timers[e].end-this.timers[e].start:Date.now()-this.timers[e].start:0},e.prototype.track=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),l.SilentBackgroundRequest(a.__assign({url:"/growth/user_action/track",subject_user:this.userId,data:a.__assign({project:this.project,action:e,duration:this.getDuration(e)},i.pick(t,"endpoint"),{extra:JSON.stringify(t.extra||{})})},n))},e})();t.GrowthUserActionTracker=s,t.withGrowthTracking=o}),define("modules/clean/payments/billing_info_base",["require","exports","jquery","modules/clean/payments/cash","modules/clean/payments/payment_form_events","modules/clean/payments/pro_util","modules/core/controller_helpers"],function(e,t,a,n,i,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t,a,n){this.listen_tax=this.listen_tax.bind(this),this._getCurrency=this._getCurrency.bind(this),this.getCurrentTransitionViewModel=this.getCurrentTransitionViewModel.bind(this),this.updateForm=this.updateForm.bind(this),this._display_tax=this._display_tax.bind(this),this._recompute_costs=this._recompute_costs.bind(this),this._recompute_costs_from_tvm=this._recompute_costs_from_tvm.bind(this),this.$container=e,this.country_to_currency_map=t,this.transition_view_models=a,this.countryToTaxNameMap=n,this.transition_info_fetcher=new r.TransitionInfoFetcher(this.transition_view_models),this.payment_form=l.get_controller(this.$container.find(".payment-form-component")),this.hasTax=null!=this.countryToTaxNameMap,this.transition_view_models&&(this.transition_view_model=this.transition_view_models[0]),this.listen_tax()}return e.prototype.listen_tax=function(){var e=this;if(this.hasTax)return this.$container.on(i.LOCATION_CHANGE_EVENT,function(t,a){if(t.stopPropagation(),r.TaxHelper.require_recompute(e.get_country_code(),e.get_zip_code()))return e.updateForm()})},e.prototype.get_zip_code=function(){return this.$container.find('input:visible[name="zip"]').val()},e.prototype.get_country_code=function(){return this.$container.find('[name="country_code"]').val()},e.prototype._getCountryTaxName=function(e){return this.countryToTaxNameMap[e]||this.countryToTaxNameMap.Other},e.prototype._getCurrency=function(){var e=this.payment_form.get_country_code();return null!=this.country_to_currency_map?this.country_to_currency_map[e]:void 0},e.prototype.getCurrentTransitionViewModel=function(){return this.transition_view_model},e.prototype.updateForm=function(){return this._recompute_costs()},e.prototype._display_tax=function(){return r.TaxHelper.display_tax(this.get_country_code())?(a(".tax-row").removeClass("hidden_elem"),a(".tax-name-wrapper").text(this._getCountryTaxName(this.get_country_code())),!0):(a(".tax-row").addClass("hidden_elem"),!1)},e.prototype._recompute_costs=function(){var e={zip:this.get_zip_code(),country_code:this.get_country_code()};return this.transition_info_fetcher.get(this._recompute_costs_from_tvm,e,!0)},e.prototype._recompute_costs_from_tvm=function(e){var t;if(e){this.transition_view_model=e;var i=this._getCurrency();this.$container.find(".currency-wrapper").text(i);var l=Array.from(r.TaxHelper.compute_tax(e.read_only_invoice,i)),o=l[0],s=l[1],c=l[2],u=n.CashUtil.formatCurrency(o.amount,o.currency);if(this.$container.find(".price-amount-wrapper").text(u),e.rebill){t=n.Cash.fromObject(e.rebill.total);var d=n.CashUtil.formatCurrency(t.amount,t.currency);this.$container.find(".rebill-amount-wrapper").text(d)}if(e.state.total_recurring_price){var p=n.Cash.fromObject(e.state.total_recurring_price),m=n.CashUtil.formatCurrency(p.amount,p.currency);this.$container.find(".rebill-price-wrapper").text(m)}var h=this._getTotalAmount(e),_=n.CashUtil.formatCurrency(h.amount,h.currency);this.$container.find(".total-amount-wrapper").text(_),a(".tax-row").toggleClass("hidden_elem",this._display_tax());var g=n.CashUtil.formatCurrency(c.amount,c.currency);return a(".tax-amount-wrapper").text(g),[o,s,c,t,i]}},e})();t.BillingInfoModalBase=o}),define("modules/clean/payments/billing_info_modal",["require","exports","tslib","jquery","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/deprecated/uirequest","modules/clean/payments/billing_info_base","modules/clean/payments/cash","modules/clean/payments/payment_form_events","modules/core/browser","modules/core/cookies","modules/core/notify","modules/core/uri","modules/clean/payments/pro_util"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m){"use strict";var h=(function(e){function t(a,o,s,d,h){var _=e.call(this,a,d,s,h)||this;return _.payment_link_map=o,_._postRequest=_._postRequest.bind(_),_._update_disclaimer=_._update_disclaimer.bind(_),_.$container.on("click",".cancel-button",function(){return i.TeamsWebActionsLogger.log("update_billing_open_cancel"),r.DBModalStack.pop()}),_.$container.on("click",".confirm-button",function(){if(i.TeamsWebActionsLogger.log("update_billing_open_save_changes_click"),_.payment_form.validate())return _.$container.find(".confirm-button").prop("disabled",!0),_.payment_form.get_form_inputs(function(e){_.$container.find(".confirm-button").prop("disabled",!1);var a=["resubscribe"];_.$container.find("input, select").each(function(t,i){var r=n(i),l=r.attr("name");if(Array.from(a).includes(l))return e[l]=r.val()});var o=_.payment_form.get_selected_payment_method_id(),s=_.payment_link_map[o];if("extra_params"in s){var c=s.extra_params;n.extend(e,c)}return s.use_form_post?_._postRequest(new m.URI({path:s.endpoint}),e):new l(_.$container,s.endpoint,{data:e,success:function(e){if(e.data&&e.data.success){i.TeamsWebActionsLogger.log("update_billing_open_save_changes_success");var a=e.data,n=a.message,l=a.redirect_url;return l&&p.Notify.success(n,5,function(){return u.redirect(l)}),r.DBModalStack.trigger(t.BILLING_INFO_UPDATED),r.DBModalStack.pop()}}})})}),_.payment_form.$container.on(c.PAYMENT_METHOD_TYPE_CHANGE_EVENT,_._update_disclaimer),null!=_.transition_view_models&&_.updateForm(),_}return a.__extends(t,e),t.initClass=function(){this.BILLING_INFO_UPDATED="billing_info_modal:updated"},t.prototype._postRequest=function(e,t){t.t=d.Cookies.read("__Host-js_csrf");var a=document.createElement("form");a.action=e,a.method="POST",document.body.appendChild(a);for(var n=0,i=Object.keys(t||{});n<i.length;n++){var r=i[n],l=document.createElement("input");l.type="hidden",l.name=r,l.value=t[r],a.appendChild(l)}return a.submit()},t.prototype._update_disclaimer=function(e,t){return t=parseInt(t,10),this.$container.find(".payment-method-disclaimer").each(function(e,a){var i=n(a).data("payment-method-id");return n(a).toggleClass("hidden",i!==t)})},t.prototype._getTotalAmount=function(e){return s.Cash.fromObject(e.read_only_invoice.total)},t})(o.BillingInfoModalBase);return h.initClass(),h}),define("modules/clean/payments/payment_form_events",["require","exports"],function(e,t){"use strict";var a=(function(){function e(){}return e.initClass=function(){this.LOCATION_CHANGE_EVENT="db:paymentform:countrycodechanged",this.ZIP_CHANGE_EVENT="db:paymentform:zipchanged",this.PAYMENT_METHOD_TYPE_CHANGE_EVENT="db:paymentform:paymentmethodtypechanged",this.VAT_CHANGE_EVENT="db:paymentform:vatchanged",this.CPF_CHANGE_EVENT="db:paymentform:cpfchanged",this.UNVALIDATED="db:paymentform:unvalidated",this.VALIDATE_ERROR="db:paymentform:validateerror",this.VALIDATE_SUCCESS="db:paymentform:validatesuccess",this.LOADED_EVENT="db:paymentform:loaded",this.IFRAME_LOADED_EVENT="db:paymentform:iframeloaded",this.IFRAME_FIELDS_STATUS_EVENT="db:paymentform:iframefieldsstatusevent",this.EDIT_SIMPLE_COUNTRY_CLICK_EVENT="db:paymentform:editsimplecountry"},e})();return a.initClass(),a}),define("modules/clean/payments/pro_util",["require","exports","external/lodash","modules/clean/ajax","modules/clean/payments/cash","modules/clean/payments/validation","modules/core/exception"],function(e,t,a,n,i){"use strict";function r(e,t){return void 0!==e&&null!==e?t(e):void 0}Object.defineProperty(t,"__esModule",{value:!0});var l=(function(){function e(){}return e.compute_tax=function(e,t){for(var a=null,n=null,r=new i.Cash(0,t),l=0,o=Array.from(e.line_items);l<o.length;l++){var s=o[l];1===s.line_item_type?a=s:2===s.line_item_type&&(n=s),s.country_tax_amount&&(r=r.add(i.Cash.fromObject(s.country_tax_amount))),s.state_tax_amount&&(r=r.add(i.Cash.fromObject(s.state_tax_amount)))}return[null!=a?i.Cash.fromObject(a.line_item_price):new i.Cash(0,t),null!=n?i.Cash.fromObject(n.line_item_price):new i.Cash(0,t),r]},e.require_recompute=function(e,t){return"US"===e&&/(^\d{5}$)|(^\d{5}-\d{4}$)/.test(t)},e.display_tax=function(e){return"US"===e},e})();t.TaxHelper=l;var o=(function(){function e(e){if(this._cache_key_from_transition=this._cache_key_from_transition.bind(this),this._get_state_json=this._get_state_json.bind(this),this.get=this.get.bind(this),this._has_inflight_request=this._has_inflight_request.bind(this),this._add_to_cache=this._add_to_cache.bind(this),this._get_transition_info_for=this._get_transition_info_for.bind(this),this.default_transition_view_models=e,this._requests={},this.transition_info_cache={},this.default_transition_view_models)for(var t=0,a=Array.from(this.default_transition_view_models);t<a.length;t++){var n=a[t];this._add_to_cache(n)}}return e.prototype._cache_key=function(e){return a.values(e).join(":")},e.prototype._cache_key_from_transition=function(e){var t={country_code:null!=e.read_only_invoice?e.read_only_invoice.tax_country_code:void 0,zip_code:null!=e.read_only_invoice?e.read_only_invoice.tax_zip_code:void 0};return this._cache_key(t)},e.prototype._get_state_json=function(){var e=r(null!=this.default_transition_view_models?this.default_transition_view_models[0]:void 0,function(e){return e.state});return JSON.stringify(e)},e.prototype.get=function(e,t,i){var r=this,l=this._cache_key(t),o=this._get_transition_info_for(l);if(o)return void e(o);if(!this._requests[l]){if(this._has_inflight_request()&&i)for(var s in this._requests)delete this._requests[s];else if(this._has_inflight_request())return;return this._requests[l]=!0,n.SilentBackgroundRequest({url:"/pro/ajax_transition_view_model",dataType:"json",data:a.assignIn({json_state:this._get_state_json()},t),success:function(t){if(r._add_to_cache(t),null!=r._requests[l])return delete r._requests[l],e(t)},error:function(e){if(null!=r._requests[l])return delete r._requests[l]}})}},e.prototype._has_inflight_request=function(){return Object.keys(this._requests).length},e.prototype._add_to_cache=function(e){var t=this._cache_key_from_transition(e);return this.transition_info_cache[t]=e},e.prototype._get_transition_info_for=function(e){return null!=this.transition_info_cache[e]},e})();t.TransitionInfoFetcher=o}),define("modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader",["require","exports","tslib","modules/core/notify","external/react","modules/clean/react/css","modules/clean/react/sprite","modules/core/uri","modules/core/i18n","modules/clean/react/arbor/aspen/elements/arbor_inputs","modules/clean/payments/validation","modules/clean/react/modal","modules/clean/static_urls","modules/clean/react/tooltip","modules/clean/analytics","modules/clean/ajax_as_promised"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_){"use strict";function g(e){return function(t){return null==t||t.length<=e}}function f(e,t){return i.createElement(m.Tooltip,{position:m.TooltipPosition.RIGHT,tooltip_contents:t},e,i.createElement(l.Sprite,{group:"web",name:"info",className:"info-sprite",alt:""}))}Object.defineProperty(t,"__esModule",{value:!0});var b=s._("Country and postal code must match your account’s payment information."),y=s._("Your tax rate on this invoice cannot be updated."),S={addressName:s._("Billing name"),address:s._("Billing address"),city:s._("City"),state:s._("State"),zip:f(s._("Postal code"),b),country:f(s._("Country"),b),exclusionId:s._("VAT number (optional)"),exclusionIdWithTooltip:f(s._("VAT number (optional)"),y)},v=(function(e){function r(t){var a=e.call(this,t)||this;return a.disableds={addressName:!1,address:!1,city:!1,state:!1,zip:!0,country:!0,exclusionId:!1,exclusionIdWithTooltip:!1},a.addressNameLength=100,a.addressLength=250,a.cityLength=50,a.stateLength=50,a.vatLength=25,a.undefinedLength=void 0,a.validateHandlers={addressName:g(a.addressNameLength),address:g(a.addressLength),city:g(a.cityLength),state:g(a.stateLength),zip:function(){return!0},country:function(){return!0},exclusionId:function(){return!0},exclusionIdWithTooltip:function(){return!0}},a.maxLengths={addressName:a.addressNameLength,address:a.addressLength,city:a.cityLength,state:a.stateLength,zip:a.undefinedLength,country:a.undefinedLength,exclusionId:a.vatLength,exclusionIdWithTooltip:a.vatLength},a.errorTexts={addressName:s._("Too long"),address:s._("Too long"),city:s._("Too long"),state:s._("Too long"),zip:"",country:"",exclusionId:"",exclusionIdWithTooltip:""},a.onSave=function(){var e=a.state.formState,t=a.props.invoice;if(e)if(a.logActions("edit_billing_address_started"),a.setState({submitting:!0}),a.isInputValid()){var n={address_name:e.addressName,address:e.address,city:e.city,state:e.state,exclusion_id:e.exclusionId};t&&(n.invoice_id=o.URI.parse(t.link).getQuery().id.toString()),a.makeEditBillingAddressRequest(n)}else a.setState({submitting:!1,showErrors:!0})},a.onCancel=function(){a.logActions("edit_billing_address_cancelled"),d.Modal.close()},a.state={submitting:!1,showErrors:!1},t.isTeam?(a.editUrl="/edit_billing_address",a.viewModelUrl="/edit_billing_address_view_model",a.vatClass="grid__item--1-1",a.modalClass="edit-invoice-modal"):(a.editUrl="/edit_billing_address_individual",a.viewModelUrl="/edit_billing_address_individual_view_model",a.vatClass="grid__item--1-2",a.modalClass="edit-invoice-modal professional-modal"),a}return a.__extends(r,e),r.showInstance=function(e,a){var n=i.createElement(t.EditInvoiceAddressModalLoader,{invoice:e,isTeam:a});d.Modal.showInstance(n)},r.showUpdateTaxProfileModal=function(e,a){var n=i.createElement(t.EditInvoiceAddressModalLoader,{isTeam:e,onUpdated:a});d.Modal.showInstance(n)},r.prototype.componentDidMount=function(){var e=void 0
;this.props.invoice&&(e=o.URI.parse(this.props.invoice.link).getQuery().id.toString(),this.disableds.exclusionIdWithTooltip=!0),this.makeRequest(e)},r.prototype.makeRequest=function(e){return a.__awaiter(this,void 0,void 0,function(){var t,n,i;return a.__generator(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),t={invoice_id:e},[4,_.WebRequest({url:this.viewModelUrl,data:t,dataType:"json"})];case 1:return n=a.sent(),u.hasVat(n.countryCode)&&(this.errorTexts.exclusionId=s._("Please enter a valid VAT number, e.g. %(examples)s.").format({examples:u.getVatExamples(n.countryCode).join(", ")}),this.validateHandlers.exclusionId=function(e){return!e||u.validateVat(n.countryCode,e)}),this.setState({formState:n}),[3,3];case 2:return i=a.sent(),d.Modal.close(),[3,3];case 3:return[2]}})})},r.prototype.render=function(){var e,t=this.state,a=t.formState,n=t.showErrors,r=t.submitting;if(a){var l=null;if(u.hasVat(a.countryCode)){var o=u.getVatPrefix(a.countryCode);l=this.props.invoice?this.renderInput("exclusionIdWithTooltip",this.vatClass):this.renderInput("exclusionId",this.vatClass,o)}e=this.props.isTeam?i.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInstructions(a.countryCode),this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-1"),this.renderInput("city","grid__item--1-2"),this.renderInput("state","grid__item--11-24"),this.renderInput("zip","grid__item--7-24"),this.renderInput("country","grid__item--2-3"),l):i.createElement("div",{className:".type--arbor grid__container grid__container--p-large  grid--x-bookend"},this.renderInput("addressName","grid__item--1-1"),this.renderInput("address","grid__item--1-2"),this.renderInput("city","grid__item--1-4"),this.renderInput("state","grid__item--1-4"),this.renderInput("zip","grid__item--1-2"),this.renderInput("country","grid__item--1-2"),l,this.renderInstructions(a.countryCode))}else e=i.createElement("div",{className:"loading-spinner"},i.createElement("img",{src:p.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:s._("Loading")}));var c=i.createElement(d.ModalButtons,{className:"oq-modal__buttons"},i.createElement(d.ModalButton,{className:"cancel-button",importance:"tertiary",onClick:this.onCancel},s._("Cancel")),i.createElement(d.ModalButton,{disabled:!a||r||n&&!this.isInputValid(),importance:"primary",onClick:this.onSave},s._("Save changes")));return i.createElement(d.Modal,{className:this.modalClass,autoClose:!1,buttonComponent:c,title:s._("Edit invoice details")},i.createElement("div",{className:"dynamic-content"},e))},r.prototype.logActions=function(e){this.props.isTeam?h.TeamsWebActionsLogger.log(e):h.UserActivityLogger.log("web",e)},r.prototype.makeEditBillingAddressRequest=function(e){return a.__awaiter(this,void 0,void 0,function(){var t,i,r;return a.__generator(this,function(a){switch(a.label){case 0:t=this.props.onUpdated,a.label=1;case 1:return a.trys.push([1,3,4,5]),i=this.editUrl,[4,_.WebRequest({url:i,data:e})];case 2:return a.sent(),this.logActions("edit_billing_address_success"),n.Notify.success(s._("Invoice details updated.")),[3,5];case 3:return r=a.sent(),this.logActions("edit_billing_address_edit_failure"),[3,5];case 4:return t&&t(),d.Modal.close(),[7];case 5:return[2]}})})},r.prototype.renderInstructions=function(e){var t,a=this.props.invoice;if(t=a?s._("You are editing details for the %(date)s invoice.").format({date:a.date}):s._("You are editing details for all future invoices. To edit past         invoices, click “Edit” on the invoice item instead."),u.hasVat(e)){var n=s._("Please note that changing your VAT number could impact your           applicable tax rate.");a&&(n=s._("To add or change a VAT number or request a tax refund, contact           support.")),t=t.concat(" ",n)}return i.createElement("div",{className:"grid__item--1-1 instructions"},t)},r.prototype.renderInput=function(e,t,a){var n=this.state,r=n.formState,l=n.showErrors,o="";return r&&(o=r[e]),i.createElement(c.ArborTextInput,{name:e,containerClassName:t,isValid:l?!!this.validateHandlers[e](o)&&"":"",labelText:S[e],errorText:this.errorTexts[e],value:o,onChange:this.onChangeFactory(e),disabled:this.disableds[e],placeholderText:a,maxLength:this.maxLengths[e]})},r.prototype.onChangeFactory=function(e){var t=this;return function(a,n,i){var r=t.state.formState;r&&t.setState(function(t){return r[e]=i,t})}},r.prototype.isInputValid=function(){var e=this.state.formState;return!!e&&(this.validateHandlers.addressName(e.addressName)&&this.validateHandlers.address(e.address)&&this.validateHandlers.city(e.city)&&this.validateHandlers.state(e.state)&&this.validateHandlers.exclusionId(e.exclusionId))},r})(i.Component);t.EditInvoiceAddressModalLoader=r(v,["/static/css/payments/edit_invoice_address_modal/edit_invoice_address_modal-vfl4mD1Gs.css"])}),define("modules/clean/react/payments/pro/components/payments/ideal_form",["require","exports","tslib","external/react","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/pro/components/inputs/inputs","modules/core/i18n"],function(e,t,a,n,i,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIdealBankChange=function(e){var a=e.value,n=t.props.idealBanks[a];t.props.actions.updateIdealBank({bankId:a,bankName:n})},t}return a.__extends(t,e),t.prototype.idealBankErrorString=function(){var e=this.props.formData.idealBankId;return!i.FormValueHelper.isValid(e)&&e.showError?l._("Please select your bank."):""},t.prototype.render=function(){var e=this.props,t=e.formData,a=e.idealBanks,i=l._("Note: We’ll use your bank information provided by iDEAL     for all future billing cycles. If your bank is not listed, then please select a     different payment method.");return n.createElement("div",null,n.createElement("div",{className:"ideal-fields"},n.createElement(r.LabeledSelectInput,{name:"ideal_bank",labelText:l._("Bank"),value:t.idealBankId.rawValue,onChange:this.onIdealBankChange,errorText:this.idealBankErrorString()},n.createElement("option",{value:"",key:"default","aria-selected":""===t.idealBankId.rawValue},l._("Select your bank...")),Object.keys(a).map(function(e){return n.createElement("option",{value:e,key:e,"aria-selected":t.idealBankId.rawValue===e},a[e])}))),this.props.locationFields,n.createElement("div",{className:"ideal-note"},i))},t})(n.Component);t.IdealForm=o}),define("modules/clean/react/payments/pro/components/payments/payment_info_section",["require","exports","tslib","external/react","modules/clean/analytics","modules/clean/payments/payment_form/payment_form_spec","modules/clean/payments/validation","modules/core/i18n","modules/clean/react/payments/pro/components/inputs/inputs","modules/clean/react/payments/common/form_value_helpers","modules/clean/react/payments/pro/components/payments/ideal_form","modules/clean/react/payments/pro/components/payments/payment_method_selector","modules/clean/react/payments/checkout/components/payment_method_form/credit_card_frame","modules/clean/react/payments/checkout/components/payment_method_form/direct_debit_form"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCpfChange=function(e){t.props.actions.updateCpf(e.value)},t.onCpfNameChange=function(e){t.props.actions.updateCpfName(e.value)},t}return a.__extends(t,e),t.prototype.componentDidMount=function(){var e=this.props.formData.countryCode.formattedValue;i.ProEventsLogger.log("uj-billing-country",{country:e}),"BR"===e&&this.props.showCpf&&i.ProEventsLogger.log("uj-cpf-viewed-field")},t.prototype.prepareForSubmission=function(){return this.props.formData.paymentMethod.formattedValue===r.PaymentMethod.CreditCard?this.creditCardFrame.tokenize():Promise.resolve(!0)},t.prototype.onCountryCodeChange=function(e){this.props.actions.updateCountryCode(e.value);var t=e.value;i.ProEventsLogger.log("uj-billing-country",{country:t}),"BR"===t&&this.props.showCpf&&i.ProEventsLogger.log("uj-cpf-viewed-field")},t.prototype.onZipCodeChange=function(e){this.props.actions.updateZipCode(e.value)},t.prototype.onVatChange=function(e){this.props.actions.updateVat(e.value)},t.prototype.zipCodeErrorString=function(){var e=this.props.formData.zipCode;return!c.FormValueHelper.isValid(e)&&e.showError?o._("Please enter a valid postal code."):""},t.prototype.vatErrorString=function(){var e=this.props.formData.vat;return!c.FormValueHelper.isValid(e)&&e.showError?o._("Please enter a valid VAT number (ex: %(examples)s).").format({examples:l.getVatExamples(this.props.formData.countryCode.formattedValue).join(", ")}):""},t.prototype.cpfErrorString=function(){var e=this.props.formData.cpf;return!c.FormValueHelper.isValid(e)&&e.showError?o._("Please enter a valid CPF number."):""},t.prototype.renderLocationFields=function(){var e=this.props,t=e.countryList,a=e.paymentSpec,i=e.formData,r=e.isScheduledDowngradeToBasic,c=o._("Postal Code",{comment:"This is the label for the zip code field, and should be kept short."}),u="US"===i.countryCode.formattedValue?o._("Billing ZIP"):c,d=!a.allow_zip_code_for_country(i.countryCode.formattedValue),p=t.map(function(e){var t=e[0],a=e[1];return n.createElement("option",{key:"location-"+t,value:t},a)}),m=null;if(a.should_show_vat_for_country(i.countryCode.formattedValue)){var h=l.getVatPrefix(i.countryCode.formattedValue);m=n.createElement(s.LabeledTextInput,{className:"payment-info__vat",containerClassName:"grid__item--medium--1-2",name:"vat",labelText:o._("VAT number (optional)"),errorText:this.vatErrorString(),placeholder:h,value:i.vat.rawValue,onChange:this.onVatChange.bind(this)})}var _=null;this.props.showCpf&&"BR"===i.countryCode.formattedValue&&(_=n.createElement("div",{className:"grid__item"},n.createElement(s.LabeledTextInput,{className:"payment-info__cpf",containerClassName:"grid__item--1-2",name:"cpf",labelText:o._("CPF/CNPJ"),errorText:this.cpfErrorString(),value:i.cpf.rawValue,onChange:this.onCpfChange}),this.props.showCpfName&&n.createElement(s.LabeledTextInput,{className:"payment-info__cpfName",containerClassName:"grid__item--1-2",name:"cpf_name",labelText:o._("Name"),value:i.cpfName.rawValue,onChange:this.onCpfNameChange})));var g=o._("Please note that changing your billing location      could impact your applicable tax rate.");a.should_show_vat_for_country(i.countryCode.formattedValue)&&(g=o._("Please note that changing your billing location or VAT number      could impact your applicable tax rate."));var f=n.createElement("div",{className:r?"disclaimer-message-full-width":"disclaimer-message"},g,r&&n.createElement("span",null," ",o._("Updating your billing information will cancel your scheduled             plan downgrade. If you still wish to downgrade, you will need to             schedule it again.")));return n.createElement("div",{className:"grid__item"},n.createElement(s.LabeledInputRow,{className:"payment-info__location grid__item grid--x-bookend",errors:[{name:"zip",text:"",className:"grid__item--1-2"}]},n.createElement(s.LabeledTextInput,{className:"payment-info__zip",containerClassName:"grid__item--1-2",name:"zip",labelText:u,value:i.zipCode.rawValue,hasError:!1,disabled:d,onChange:this.onZipCodeChange.bind(this),errorText:this.zipCodeErrorString(),type:"tel"}),n.createElement(s.LabeledSelectInput,{className:"payment-info__country",containerClassName:"grid__item--1-2",labelText:o._("Country"),name:"country_code",onChange:this.onCountryCodeChange.bind(this),value:i.countryCode.rawValue},p)),m,n.createElement(s.LabeledInputRow,{className:"payment-info__location grid__item grid--x-bookend",errors:[{name:"cpf",text:"",className:"grid__item--1-2"}]},_),f)},t.prototype.renderPaymentMethodSelector=function(){var e=this.props,t=e.paymentSpec,a=e.formData,i=e.enableIdealReact;return n.createElement(d.PaymentMethodSelector,{paymentSpec:t,paymentMethod:a.paymentMethod.rawValue,updatePaymentMethod:this.props.actions.updatePaymentMethod,countryCode:a.countryCode.rawValue,zipCode:a.zipCode.rawValue,enableIdealReact:i})},t.prototype.render=function(){var e=this,t=this.props,a=t.actions,i=t.formData,l=t.idealBanks,o=t.enableIdealReact,s=this.renderLocationFields(),c=s;return i.paymentMethod.formattedValue===r.PaymentMethod.DirectDeposit?c=n.createElement(m.DirectDebitForm,{locationFields:s,formData:i,actions:a}):o&&i.paymentMethod.formattedValue===r.PaymentMethod.Ideal&&(c=n.createElement(u.IdealForm,{locationFields:s,formData:i,actions:a,idealBanks:l})),n.createElement("div",{className:"grid__item payment-info"},this.renderPaymentMethodSelector(),n.createElement(p.CreditCardFrame,{getHeightFromIframe:!0,iframeUrl:this.props.iframeUrl,hidden:i.paymentMethod.formattedValue!==r.PaymentMethod.CreditCard,actions:this.props.actions,ref:function(t){return e.creditCardFrame=t},nonce:i.nonce,bin:i.bin}),c)},t})(n.Component);t.PaymentInfoSection=h}),define("modules/clean/react/payments/pro/components/payments/payment_method_input",["require","exports","tslib","external/react","modules/core/i18n","external/classnames","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/pro/components/inputs/inputs"],function(e,t,a,n,i,r,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.onChange=function(e){this.props.onSelected(this.props.paymentMethod)},t.prototype.render=function(){var e=this.props,t=e.icons,a=e.labelText,s=e.paymentMethod,c=e.numberOfPaymentMethods,u=[],d=["payment-info__option"];3===c?d.push("grid__item--medium--1-4"):4===c?d.push("grid__item--medium--5-24"):d.push("grid__item--medium--1-2");var p;if(a&&(p="payment-method-label#debit",u.push(n.createElement("span",{title:"debit",key:p,className:"debit"},this.props.labelText))),t){if(s===l.PaymentMethod.CreditCard){var m=t.join(", ").replace("_","-"),h=i._("Credit card. We accept %(payment_methods)s").format({payment_methods:m});p="payment-method-label#creditcard",u.push(n.createElement("span",{key:p,className:"ax-visually-hidden"},h))}else s===l.PaymentMethod.PayPal?(p="payment-method-label#paypal",u.push(n.createElement("span",{key:p,className:"ax-visually-hidden"},i._("Paypal")))):s===l.PaymentMethod.Ideal&&(p="payment-method-label#ideal",u.push(n.createElement("span",{key:p,className:"ax-visually-hidden"},i._("iDEAL"))));for(var _=0,g=t;_<g.length;_++){var f=g[_];p="payment-method-icon#"+f,u.push(n.createElement("span",{title:f,key:p,className:f}))}}return n.createElement("div",{className:r(d)},n.createElement(o.LabeledRadioInput,{name:"payment_method",className:"payment-info__payment",value:s.toString(),checked:this.props.selected,onClick:this.onChange.bind(this),onChange:function(){}}),n.createElement("label",{htmlFor:"payment_method_"+s,id:"payment_method_"+s,className:"payment-info__method-label",onClick:this.onChange.bind(this)},u))},t})(n.Component);t.PaymentMethodInput=s}),define("modules/clean/react/payments/pro/components/payments/payment_method_selector",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/pro/components/payments/payment_method_input"],function(e,t,a,n,i,r,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onPaymentMethodSelected=function(e){t.props.updatePaymentMethod(e)},t}return a.__extends(t,e),t.prototype.getLabelForMethodId=function(e){return e===r.PaymentMethod.CreditCard?n.createElement(l.PaymentMethodInput,{key:"payment-method#"+e,paymentMethod:r.PaymentMethod.CreditCard,selected:this.props.paymentMethod===r.PaymentMethod.CreditCard,onSelected:this.onPaymentMethodSelected.bind(this),icons:this.props.paymentSpec.supported_credit_cards_for_country(this.props.countryCode),numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===r.PaymentMethod.PayPal?n.createElement(l.PaymentMethodInput,{key:"payment-method#"+e,paymentMethod:r.PaymentMethod.PayPal,selected:this.props.paymentMethod===r.PaymentMethod.PayPal,onSelected:this.onPaymentMethodSelected,icons:["paypal"],numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):e===r.PaymentMethod.DirectDeposit?n.createElement(l.PaymentMethodInput,{key:"payment-method#"+e,paymentMethod:r.PaymentMethod.DirectDeposit,selected:this.props.paymentMethod===r.PaymentMethod.DirectDeposit,onSelected:this.onPaymentMethodSelected,labelText:i._("Direct Debit"),numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):this.props.enableIdealReact&&e===r.PaymentMethod.Ideal?n.createElement(l.PaymentMethodInput,{key:"payment-method#"+e,paymentMethod:r.PaymentMethod.Ideal,selected:this.props.paymentMethod===r.PaymentMethod.Ideal,onSelected:this.onPaymentMethodSelected,icons:["ideal"],numberOfPaymentMethods:this.props.paymentSpec.available_payment_methods_for_country(this.props.countryCode).length}):null},t.prototype.render=function(){var e=this,t=this.props,a=t.countryCode,i=t.paymentSpec,r=i.available_payment_methods_for_country(a),l=r.map(function(t){return e.getLabelForMethodId(t)});return n.createElement("div",{className:"payment-info__selector grid__item grid__container--p-small"},l)},t})(n.Component);t.PaymentMethodSelector=o}),define("modules/clean/react/payments/update_billing_individual/action_creator",["require","exports","external/redux","modules/clean/react/payments/common/form/actions/actions","modules/clean/react/payments/update_billing_individual/actions"],function(e,t,a,n,i){"use strict";function r(e){return a.bindActionCreators(l(),e.dispatch)}function l(){return{submitBillingForm:i.submitBillingForm,updatePaymentMethod:n.updatePaymentMethod,updateCountryCode:i.updateBillingCountryCode,updateZipCode:n.updateZipCode,updateVat:n.updateVat,updateCpf:n.updateCpf,updateCpfName:n.updateCpfName,updateNonce:n.updateNonce,updateBIN:n.updateBIN,updateAccountHolderName:n.updateAccountHolderName,updateIBAN:n.updateIBAN,updateMandateSigned:n.updateMandateSigned,updateIdealBank:n.updateIdealBank}}Object.defineProperty(t,"__esModule",{value:!0}),t.bindBillingActions=r}),define("modules/clean/react/payments/update_billing_individual/actions",["require","exports","modules/core/i18n","modules/core/notify","modules/clean/payments/payment_form/payment_form_spec","modules/clean/react/payments/common/form/actions/actions"],function(e,t,a,n,i,r){"use strict";function l(e,t){return void 0===t&&(t={}),function(a,n){var l=n(),o=l.formData,s=o.countryCode.formattedValue,c=l.pageState.paymentFormSpec,u={},d=["countryCode"];c.allow_zip_code_for_country(s)&&d.push("zipCode"),c.should_show_vat_for_country(s)&&d.push("vat"),t.showCpf&&"BR"===s&&(d.push("cpf"),t.showCpfName&&d.push("cpfName")),t.expRenewalsProMobilePaymentPage&&(u.expRenewalsProMobilePaymentPage=!0),t.expUjRebillUpsellVariant&&(u.expUjRebillUpsellVariant=t.expUjRebillUpsellVariant);var p;l.formData.paymentMethod.formattedValue===i.PaymentMethod.CreditCard?(d.push("nonce"),d.push("bin"),p="/update_credit_card_billing_info_ajax"):l.formData.paymentMethod.formattedValue===i.PaymentMethod.DirectDeposit?(d.push("accountHolderName","iban","mandateSigned"),p="/update_direct_debit_billing_info_ajax"):l.formData.paymentMethod.formattedValue===i.PaymentMethod.Ideal?(d.push("idealBankId","idealBankName"),p="/update_ideal_billing_info_ajax"):p="/paypal_billing_info",a(r.submitForm(p,d,e,u))}}function o(e){return function(t,i){var l=i(),o=l.pageState.countryToCurrencyMap;!(e in o)&&l.formData.countryCode.formattedValue in o?n.Notify.error(a._("You can’t change to a country with a different currency. For help, contact support."),3):t(r.updateCountryCode(e))}}Object.defineProperty(t,"__esModule",{value:!0}),t.submitBillingForm=l,t.updateBillingCountryCode=o}),define("modules/clean/react/payments/update_billing_individual/individual_update_billing_modal",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/payments/update_billing_individual/store_creator","modules/clean/react/payments/update_billing_individual/action_creator","modules/clean/react/payments/update_billing_individual/reducers","modules/clean/react/payments/pro/components/payments/payment_info_section","modules/clean/payments/payment_form/payment_form_spec","modules/clean/analytics"],function(e,t,a,n,i,r,l,o,s,c,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=(function(e){function t(t){var a=e.call(this,t)||this;return a.prepareForSubmission=function(){return a.paymentInfoSection.prepareForSubmission()},a.savePaymentInfoSection=function(e){a.paymentInfoSection=e},a.store=r.createBillingStore(t,o.BillingReducer),a.state=a.store.getState(),a.store.subscribe(function(){var e=a.store.getState();e.pageState.submitSuccess||a.setState(function(t){return a.props.setSubmittingStatus(e.pageState.submitting),e})}),a}return a.__extends(t,e),Object.defineProperty(t.prototype,"actions",{get:function(){return l.bindBillingActions(this.store)},enumerable:!0,configurable:!0}),t.prototype.logVatChange=function(e,t){null===e&&(e=""),null===t&&(t=""),""===e&&""!==t?u.ProEventsLogger.log("update_billing_added_vat"):""!==e&&""===t?u.ProEventsLogger.log("update_billing_removed_vat"):e!==t&&u.ProEventsLogger.log("update_billing_updated_vat")},t.prototype.onAccept=function(){u.ProEventsLogger.log("update_billing_open_save_changes_click"),this.logVatChange(this.props.vat,this.state.formData.vat.formattedValue),this.actions.submitBillingForm(this.prepareForSubmission,{showCpf:this.props.showCpf,showCpfName:this.props.showCpfName,expRenewalsProMobilePaymentPage:this.props.expRenewalsProMobilePaymentPage,expUjRebillUpsellVariant:this.props.expUjRebillUpsellVariant})},t.prototype.onDismiss=function(){u.ProEventsLogger.log("update_billing_open_cancel")},t.prototype.render=function(){var e,t=this.props,a=t.iframeUrl,r=t.countryList,l=t.idealBanks,o=t.enableIdealReact,u=t.userInfo,d=t.isScheduledDowngradeToBasic,p=this.state,m=p.formData,h=p.pageState;if(m.paymentMethod.rawValue===c.PaymentMethod.PayPal)e=n.createElement("div",{className:"payment-method-disclaimer","data-payment-method-id":"{payment_method.ID}"},i._("You’ll be redirected to PayPal to finish updating your billing information."));else if(m.paymentMethod.rawValue===c.PaymentMethod.Ideal){var _=void 0;_=this.props.idealChargeAmount,e=n.createElement("div",{className:"payment-method-disclaimer","data-payment-method-id":"{payment_method.ID}"},i._("We’ll be charging you %(ideal_charge_amt)s to validate the account when                       you update your bank account information.").format({ideal_charge_amt:_}))}else e=null;return n.createElement("div",{className:"payment-info-section"},n.createElement("div",{className:"payment-method-section grid__container"},n.createElement(s.PaymentInfoSection,{paymentSpec:h.paymentFormSpec,iframeUrl:a,countryList:r,formData:m,actions:this.actions,ref:this.savePaymentInfoSection,idealBanks:l,enableIdealReact:o,userInfo:u,isScheduledDowngradeToBasic:d,showCpf:this.props.showCpf,showCpfName:this.props.showCpfName}),e))},t})(n.Component);t.IndividualUpdateBillingModal=d}),define("modules/clean/react/payments/update_billing_individual/individual_update_billing_modal_loader",["require","exports","tslib","external/classnames","external/react","modules/core/browser","spectrum/button","modules/core/notify","modules/core/i18n","modules/clean/analytics","modules/clean/ajax","modules/clean/react/css","modules/clean/react/modal","modules/clean/react/payments/update_billing_individual/individual_update_billing_modal","modules/clean/static_urls","modules/clean/react/image"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=(function(e){function d(){var t=e.call(this)||this;return t.onAccept=function(){t.updateBillingModal&&t.updateBillingModal.onAccept(),c.UserActivityLogger.log("web","update_billing_modal_started")},t.onDismiss=function(){t.updateBillingModal&&t.updateBillingModal.onDismiss(),c.UserActivityLogger.log("web","update_billing_modal_cancelled"),p.Modal.close()},t.saveUpdateBillingModal=function(e){t.updateBillingModal=e},t.setSubmittingStatus=function(e){t.setState(function(t){return t.submitting=e,t})},t.state={loadingContent:!0,submitting:!1},t}return a.__extends(d,e),d.showInstance=function(){p.Modal.showInstance(i.createElement(t.IndividualUpdateBillingModalLoader,null))},d.prototype.componentDidMount=function(){var e=this;u.WebRequest({url:"/account/profile/billing_info",success:function(t){var a=JSON.parse(t);e.setState(function(e){return e.loadedProps={countryList:a.countryList,iframeUrl:a.iframeUrl,countryToCurrencyMap:a.countryToCurrencyMap,userInfo:a.userInfo,idealBanks:a.idealBanks,enableIdealReact:a.enableIdealReact,countryCode:a.countryCode,serializedPaymentFormSpec:a.serializedPaymentFormSpec,idealChargeAmount:a.idealChargeAmount,isScheduledDowngradeToBasic:a.isScheduledDowngradeToBasic,vat:a.vat,showCpf:a.showCpf,showCpfName:a.showCpfName,expUjRebillUpsellVariant:a.expUjRebillUpsell?a.expUjRebillUpsell.variant:"OFF"},e.loadingContent=!1,e}),c.UserActivityLogger.log("web","update_billing_modal_success")},error:function(){o.Notify.error(s._("Failed to load modal.")),c.UserActivityLogger.log("web","update_billing_modal_failure"),p.Modal.close()}})},Object.defineProperty(d.prototype,"expRenewalsProMobilePaymentPage",{get:function(){return r.is_supported_mobile_browser()&&"V2"===r.get_uri().getQuery().exp_renewals_pro_mobile_payment_page},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"modalTitle",{get:function(){var e=s._("Update billing information");return this.expRenewalsProMobilePaymentPage&&(e=i.createElement("div",{className:"exp-renewals-pro-mobile-payment-page-modal-title"},i.createElement(_.Image,{alt:s._("Dropbox logo"),className:"exp-renewals-pro-mobile-payment-page-modal-title__logo",src:h.static_url("/static/images/logo_catalog/dropbox-business-icon_m1-vflczuza3.svg")}),i.createElement("p",{className:"exp-renewals-pro-mobile-payment-page-modal-title__title"},e))),e},enumerable:!0,configurable:!0}),d.prototype.renderButtons=function(){var e=this.state,t=e.loadingContent,a=e.submitting;return i.createElement(p.ModalButtons,{className:"oq-modal__buttons"},i.createElement(l.Button,{className:"cancel-button",variant:"secondary",onClick:this.onDismiss},s._("Cancel")),i.createElement(l.Button,{disabled:t||a,variant:"primary",onClick:this.onAccept},s._("Save changes")))},d.prototype.renderContent=function(){var e=this.state,t=e.loadingContent,a=e.loadedProps;if(t)return i.createElement("div",{className:"loading-spinner"},i.createElement("img",{src:h.static_url("/static/images/icons/ajax-loading-small-vfl3Wt7C_.gif"),alt:s._("Loading")}));var n=a,r=n.countryList,l=n.iframeUrl,o=n.countryToCurrencyMap,c=n.countryCode,u=n.serializedPaymentFormSpec,d=n.userInfo,p=n.idealBanks,_=n.enableIdealReact,g=n.idealChargeAmount,f=n.isScheduledDowngradeToBasic,b=n.vat,y=n.showCpf,S=n.showCpfName,v=n.expUjRebillUpsellVariant;return i.createElement(m.IndividualUpdateBillingModal,{iframeUrl:l,countryList:r,countryToCurrencyMap:o,countryCode:c,serializedPaymentFormSpec:u,userInfo:d,idealBanks:p,enableIdealReact:_,expRenewalsProMobilePaymentPage:this.expRenewalsProMobilePaymentPage,setSubmittingStatus:this.setSubmittingStatus,ref:this.saveUpdateBillingModal,idealChargeAmount:g,isScheduledDowngradeToBasic:f,vat:b,showCpf:y,showCpfName:S,expUjRebillUpsellVariant:v})},d.prototype.render=function(){var e=n("update-billing-modal",{"update-billing-modal--mobile":this.expRenewalsProMobilePaymentPage,"update-billing-modal--mobile-safari":this.expRenewalsProMobilePaymentPage&&r.iOS});return i.createElement(p.Modal,{autoClose:!1,buttonComponent:this.renderButtons(),className:e,title:this.modalTitle},i.createElement("div",{className:"dynamic-content"},this.renderContent()))},d})(i.Component);t.UpdateBillingModalLoaderView=g,t.IndividualUpdateBillingModalLoader=d(g,["/static/css/pro/components/update_billing_modal_individual-vflxOiYpj.css"])}),define("modules/clean/react/payments/update_billing_individual/reducers",["require","exports","tslib","modules/clean/react/payments/common/form/reducers/reducers","modules/clean/react/payments/common/payments/reducers/reducers","modules/clean/react/payments/common/pricing/reducers/reducers"],function(e,t,a,n,i,r){"use strict";function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduce(function(e,t){return function(a,n){return t(e(a,n),n)}})}function o(e,t){return"SubmitFormSuccess"!==t.type?e:a.__assign({},e,{pageState:a.__assign({},e.pageState,{submitSuccess:!0})})}Object.defineProperty(t,"__esModule",{value:!0}),t.BillingReducer=l.apply(void 0,[o,n.FormReducer].concat(i.PaymentMethodReducers,r.TransitionManagementReducers))}),define("modules/clean/react/payments/update_billing_individual/store_creator",["require","exports","external/redux","external/redux-thunk","modules/clean/analytics","modules/clean/dbmodal_stack","modules/clean/react/modal","modules/clean/react/payments/common/form/middleware/middleware","modules/clean/react/payments/common/payments/state/store_creator","modules/clean/react/payments/common/form_value_factory","modules/clean/react/snackbar","modules/clean/top_notif","modules/core/i18n","modules/core/notify","modules/clean/payments/billing_info_modal","modules/core/browser"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m,h,_){"use strict";function g(){return function(e){return function(e){return function(t){if("SubmitFormSuccess"!==t.type)return e(t);var a=e(t),n=void 0!==t.additionalData?t.additionalData.expUjRebillUpsellVariant:"OFF",o=t.additionalData&&t.additionalData.expRenewalsProMobilePaymentPage;if(i.ProEventsLogger.log("update_billing_open_save_changes_success"),d.TopNotificationBar.hideById("rebill-bar"),["V1","V2"].indexOf(n)>=0)m.Notify.clear(),u.Snackbar.complete(p._("Payment method successfully updated.")),r.DBModalStack.trigger(h.BILLING_INFO_UPDATED,{showChangePlanConfirm:!0});else if("V3"===n)document.querySelector("#rebill-bar")&&d.TopNotificationBar.hide(),l.Modal.close(),m.Notify.clear(),u.Snackbar.complete(p._("We’ve successfully updated your account’s billing information.")),r.DBModalStack.trigger(h.BILLING_INFO_UPDATED,{showProUpsell:!0});else if(o){var s=p._("We’ve successfully updated your account’s billing information. You’ll be redirected shortly.");m.Notify.success(p._(s),10,function(){return _.redirect(t.data.data.redirect_url)})}else m.Notify.success(p._("We’ve successfully updated your account’s billing information.")),l.Modal.close(),r.DBModalStack.trigger(h.BILLING_INFO_UPDATED,null);return a}}}}function f(e,t){var i=b(e),r=a.applyMiddleware(n,o.submitFormErrorMiddleware(),g());return a.createStore(t,i,r)}function b(e){var t=S(e),a=y(e);return{pricingState:a,pageState:t,formData:v(e,t,a)}}function y(e){var t=s.createPaymentPricingState(e);return{countryCode:t.countryCode,countryCodeLoading:t.countryCodeLoading,hasCurrencyChanged:t.hasCurrencyChanged,hasTaxChangedWithinCountry:t.hasTaxChangedWithinCountry,loadingPrices:t.loadingPrices,requestToken:t.requestToken,recentLoadEvent:t.recentLoadEvent}}function S(e){var t=s.createPaymentPageState(e).paymentFormSpec;return{countryToCurrencyMap:e.countryToCurrencyMap,submitSuccess:!1,submitState:null,submitting:!1,paymentFormSpec:t}}function v(e,t,a){
var n=e.vat,i=e.cpf,r=e.countryCode,l=e.userInfo,o=s.createPaymentFormData(e,t,a),u=o.paymentMethod,d=o.countryCode,p=o.zipCode,m=o.vat,h=o.cpf,_=o.nonce,g=o.bin,f=o.accountHolderName,b=o.iban,y=o.mandateSigned,S=o.termsAndService,v=o.idealBankId,E=o.idealBankName;return{paymentMethod:u,countryCode:d,zipCode:p,vat:n?c.FormValueFactory.createVat(n,r):m,cpf:i?c.FormValueFactory.createCpf(i):h,cpfName:c.FormValueFactory.createCpfNamePrefill("","",l.displayName),nonce:_,bin:g,accountHolderName:f,iban:b,mandateSigned:y,termsAndService:S,idealBankId:v,idealBankName:E}}Object.defineProperty(t,"__esModule",{value:!0}),t.submitFormSuccessMiddleware=g,t.createBillingStore=f,t.createFormData=v}),define("modules/clean/react/top_notification_bar",["require","exports","tslib","external/react","external/react-dom","modules/core/i18n","modules/clean/react/sprite","modules/clean/top_notif"],function(e,t,a,n,i,r,l,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="top-notification-bar-container",c=(function(e){function t(){var a=null!==e&&e.apply(this,arguments)||this;return a.handleDismiss=function(e){e.preventDefault(),t.hide(),a.props.onDismiss&&a.props.onDismiss()},a}return a.__extends(t,e),t.show=function(e,a){void 0===a&&(a=!1),document.getElementById(s)&&!a||(t.hide(),i.render(e,t.getOrCreateSilo()),o.TopNotificationBar.show())},t.hide=function(){o.TopNotificationBar.hide()},t.getRoot=function(){var e=document.getElementById("maestro-prompt");if(!e)throw new Error("No #maestro-prompt element found to render TopNotificationBar into.");return e},t.getOrCreateSilo=function(){var e=t.getRoot(),a=document.querySelector(".top-notification-bar-silo");return a||(a=document.createElement("div"),a.className="top-notification-bar-silo",e.appendChild(a)),a},t.prototype.getColorClass=function(){var e=this.props.type;return"warning"===e?"lightyellow":"info"===e?"lightblue":"lightred"},t.prototype.render=function(){return n.createElement("div",{id:s,className:s+" "+this.getColorClass()},n.createElement("div",{className:"top-notification-bar"},this.props.children,n.createElement("a",{href:"#",className:"top-notification-bar-dismiss dismiss-button enabled",onClick:this.handleDismiss},n.createElement(l.Sprite,{group:"web",name:"banner_x",alt:r._("Close")}))))},t})(n.Component);t.TopNotificationBar=c}),define("modules/clean/teams/admin/lib/billing_history",["require","exports","modules/clean/teams/admin/types/billing_history"],function(e,t,a){"use strict";function n(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];if(n<e.length-1){var l=e[n+1],o=r(l)||r(i);if(i.type===a.BillingRowType.Payment&&l.type===a.BillingRowType.Invoice&&(l.billed===i.paid||l.billed==="("+i.paid+")"||o)&&l.date===i.date){var s={id:n,invoice:l,payment:i,isMobile:o};t.push(s),n++;continue}}i.type===a.BillingRowType.Payment?t.push({id:n,payment:i}):t.push({id:n,invoice:i})}return t}function i(e,a){void 0===a&&(a=t.SelectedYearTypes.ALL_TIME);var i=n(e),r=(new Date).getFullYear().toString();return a===t.SelectedYearTypes.ALL_TIME||(i=a===t.SelectedYearTypes.YEAR_TO_DATE?i.filter(function(e){return e.payment?e.payment.date.indexOf(r)!==-1:!!e.invoice&&e.invoice.date.indexOf(r)!==-1}):i.filter(function(e){return e.payment?e.payment.date.indexOf(a)!==-1:!!e.invoice&&e.invoice.date.indexOf(a)!==-1})),i=i.filter(function(e){return e.invoice&&null!==e.invoice.description||e.payment&&null!==e.payment.description})}function r(e){var t=e.description;return!!t&&(t.indexOf("Google")!==-1||t.indexOf("Apple")!==-1)}Object.defineProperty(t,"__esModule",{value:!0}),t.SelectedYearTypes={ALL_TIME:"all-time",YEAR_TO_DATE:"year-to-date"},t.getHistoryData=i}),define("modules/clean/teams/admin/types/billing_history",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.Invoice=0]="Invoice",e[e.Payment=1]="Payment",e[e.Legacy=2]="Legacy"})(t.BillingRowType||(t.BillingRowType={}))}),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list",["require","exports","tslib","external/react","modules/clean/react/css"],function(e,t,a,n,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){return n.createElement("div",{className:"admin-priced-list"},n.createElement("div",null,this.props.children))},t})(n.Component);t.AdminPricedList=i(r,["/static/css/teams/admin/widgets/admin_priced_list/admin_priced_list-vflMAA6ZU.css"])}),define("modules/clean/teams/admin/widgets/admin_priced_list/admin_priced_list_item",["require","exports","tslib","external/react","external/classnames","modules/clean/react/badge"],function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChange=function(){},t}return a.__extends(t,e),t.prototype.renderTitleWarningText=function(){var e=this.props.titleWarningText;if(e)return n.createElement("span",{className:"admin-priced-list-item__content_title_warning"}," ",e)},t.prototype.renderTitleSecondaryText=function(){var e=this.props.titleSecondaryText;if(e)return n.createElement("span",{className:"admin-priced-list-item__content_title_secondary"}," ",e)},t.prototype.getClickHandler=function(){if(!this.props.disableItem)return this.props.onClick},t.prototype.render=function(){var e=this.props,t=e.description,l=e.price,o=e.title,s=e.unit,c=e.detailsLink,u=e.disableItem,d=this.props.className?this.props.className:"",p=l?l.toString():"-",m=l?s:"",h=i((_={"admin-priced-list-item":!0,active:this.props.isSelected===!0},_[d]=!0,_.disabled=u,_));return n.createElement("div",{className:h,onClick:this.getClickHandler()},n.createElement("div",{className:"admin-priced-list-item__content"},n.createElement("div",{className:"admin-priced-list-item__content_title"},n.createElement("input",{type:"radio",checked:this.props.isSelected,onChange:this.onChange,disabled:this.props.disableItem}),n.createElement("h1",{className:"f1"},o,this.props.badge&&n.createElement(r.Badge,a.__assign({},this.props.badge)),this.renderTitleWarningText(),this.renderTitleSecondaryText())),n.createElement("div",{className:"admin-priced-list-item__content_description u-font-meta"},t,c)),n.createElement("div",{className:"admin-priced-list-item__pricing"},n.createElement("div",{className:"admin-priced-list-item__pricing_price"},p),n.createElement("div",{className:"admin-priced-list-item__pricing_unit"},m)));var _},t})(n.Component);t.AdminPricedListItem=l}),define("modules/clean/teams/admin/widgets/billing_history/billing_history_row",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/react/payments/edit_invoice_address_modal/edit_invoice_address_modal_loader","modules/clean/analytics","modules/clean/react/tooltip","modules/clean/react/sprite"],function(e,t,a,n,i,r,l,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onEdit=function(){var e=t.props,a=e.row,n=e.isTeam;a.invoice&&r.EditInvoiceAddressModalLoader.showInstance(a.invoice,n)},t.logReceiptLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_receipt_link_click")},t.logInvoiceLinkClick=function(){t.props.logAccountBillingTabEvents&&l.ProEventsLogger.log("de_billing_tab_invoice_link_click")},t}return a.__extends(t,e),t.prototype.renderDate=function(){var e=this.props.row,t=e.invoice,a=e.payment;return t&&t.date?t.date:a&&a.date?a.date:null},t.prototype.renderDescription=function(){var e=this.props.row,t=e.invoice,a=e.payment,r=e.isMobile,l=null,o=null;return t&&t.description?l=t.description:a&&a.description&&(l=a.description),r&&t&&t.description&&a&&a.description&&(l=a.description+" | "+t.description),(t&&t.isVoided||a&&a.isVoided)&&(o=n.createElement("span",null," (",i._("Voided"),")")),n.createElement("div",null,n.createElement("p",{className:"description-line"},n.createElement("span",null,l),o))},t.prototype.renderLinks=function(){if(this.props.renderLinks!==!1){var e=this.props,t=e.row,a=e.showEditInvoiceModal,r=e.canEditBilling,l=t.invoice,o=t.payment,s=[];return l&&l.link&&s.push(n.createElement("a",{key:"invoice-link",href:l.link,target:"_blank",rel:"noopener noreferrer",onClick:this.logInvoiceLinkClick},i._("Invoice"))),!t.isMobile&&o&&o.link&&s.push(n.createElement("a",{key:"payment-link",href:o.link,target:"_blank",rel:"noopener noreferrer",onClick:this.logReceiptLinkClick},i._("Receipt"))),a&&l&&!l.isOpen&&l.isEditable&&r&&s.push(n.createElement("button",{key:"edit-link",className:"button-as-link",onClick:this.onEdit},i._("Edit"))),s.length||(l&&l.infoTooltip?s.push(this.renderInfoTooltip(l)):o&&o.infoTooltip&&s.push(this.renderInfoTooltip(o))),s.length?n.createElement("span",null,s):null}},t.prototype.renderInfoTooltip=function(e){return n.createElement(o.Tooltip,{position:o.TooltipPosition.TOP,tooltip_contents:e.infoTooltip},n.createElement(s.Sprite,{group:"teams",name:"info_active",alt:"",className:"info-sprite"}))},t.prototype.renderPrice=function(){var e=this.props.row,t=e.invoice,a=e.payment;if(e.isMobile)return null;var i=null;return t&&a?i=t.isVoided||a.isVoided?n.createElement("span",{className:"row-content__price--line-through"},t.billed):t.billed:a?i=a.paid:t&&(i=t.billed),i},t.prototype.render=function(){var e=this.props.row;return e.invoice||e.payment?n.createElement("tr",{className:"row-content","data-variant":!0},n.createElement("td",{className:"row-content__date"},this.renderDate()),n.createElement("td",{className:"row-content__description"},this.renderDescription()),n.createElement("td",{className:"row-content__links"},this.renderLinks()),n.createElement("td",{className:"row-content__price"},this.renderPrice())):null},t.defaultProps={canEditBilling:!0},t})(n.Component);t.BillingHistoryTableRow=c}),define("modules/clean/teams/admin/widgets/billing_history/billing_history_table",["require","exports","tslib","external/react","modules/core/i18n","modules/clean/teams/admin/widgets/billing_history/billing_history_row","modules/clean/account_page/widgets/billing/billing_history/types","spectrum/icon_form","spectrum/popover"],function(e,t,a,n,i,r,l,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.buildFooterIfNecessary=function(){if(null!==this.props.footer)return n.createElement("tfoot",{className:"row-footer"},this.props.footer)},t.prototype.buildHeaderDate=function(){return n.createElement("th",{className:"row-header date-row"},n.createElement(s.Popover,{onSelection:this.props.onSelection},n.createElement(s.PopoverTrigger,null,n.createElement("span",{className:"date-header-cell"},i._("Date")),n.createElement("span",{className:"caret"},n.createElement(o.IconForm,{name:"caret-down"}))),n.createElement(s.PopoverContent,null,n.createElement(s.PopoverItemGroup,{key:"order-item-group"},n.createElement(s.PopoverItemGroupTitle,{key:"order-title"},i._("Order")),n.createElement(s.PopoverSelectableItem,{value:l.BillingHistoryOrder.ASCENDING,selected:l.BillingHistoryOrder.ASCENDING===this.props.order},i._("Ascending")),n.createElement(s.PopoverSelectableItem,{value:l.BillingHistoryOrder.DESCENDING,selected:l.BillingHistoryOrder.DESCENDING===this.props.order},i._("Descending"))),n.createElement(s.PopoverItemGroupSeparator,{key:"show-separator"}),n.createElement(s.PopoverItemGroup,{key:"show-item-group"},n.createElement(s.PopoverItemGroupTitle,{key:"show-title"},i._("Show")),n.createElement(s.PopoverSelectableItem,{value:"all_time",selected:"all_time"===this.props.filter},i._("All time")),n.createElement(s.PopoverSelectableItem,{value:"year_to_date",selected:"year_to_date"===this.props.filter},i._("Year-to-date")),this.renderMenuItems()))))},t.prototype.renderMenuItems=function(){var e=[],t=this.props,a=t.filters,i=t.filter;return a&&a.forEach(function(t){e.push(n.createElement(s.PopoverSelectableItem,{key:t,value:t,selected:t===i},t))}),e},t.prototype.render=function(){var e,t=this.props,a=t.amountLabel,l=t.canEditBilling,o=t.displayNoTransactionsOnEmptyRecords,s=t.showEditInvoiceModal,c=t.logAccountBillingTabEvents,u=t.isTeam,d=t.renderLinks,p=this.props.billingHistoryRecords,m=a?a:i._("Price");if(o&&0===p.length){var h=this.props.noTransactionLabel?this.props.noTransactionLabel:i._("No transactions");e=n.createElement("tr",{className:"row-content"},n.createElement("td",{className:"row-content__date"}),n.createElement("td",{className:"row-content__description"},h),n.createElement("td",{className:"row-content__links"}),n.createElement("td",{className:"row-content__price"}))}return n.createElement("div",null,n.createElement("table",{className:"billing-history-table",cellSpacing:"0"},n.createElement("thead",null,n.createElement("tr",null,this.buildHeaderDate(),n.createElement("th",{className:"row-header desc-row u-font-meta",colSpan:2},i._("Description")),n.createElement("th",{className:"row-header price-row u-font-meta"},m))),this.buildFooterIfNecessary(),n.createElement("tbody",null,e,p.map(function(e,t){return n.createElement(r.BillingHistoryTableRow,{canEditBilling:l,isTeam:u,key:e.id,logAccountBillingTabEvents:c,renderLinks:d,row:e,showEditInvoiceModal:s})}))))},t.defaultProps={onSelection:function(){}},t})(n.Component);t.BillingHistoryTable=c}),define("modules/clean/teams/admin/widgets/billing_notifications/cancel_billing_changes_modal",["require","exports","tslib","modules/core/i18n","modules/clean/react/modal","modules/clean/payments/skus/subscription_change_plan","modules/clean/payments/skus/subscription_diff","modules/clean/payments/skus/subscription_service","modules/constants/trademark","modules/clean/ajax","modules/clean/dbmodal_stack","modules/core/notify","external/react","modules/clean/teams/admin/widgets/change_plan_modal/change_plan_constants"],function(e,t,a,n,i,r,l,o,s,c,u,d,p,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;(function(e){e[e.ALL=1]="ALL",e[e.PLAN=2]="PLAN",e[e.SCHEDULE=3]="SCHEDULE",e[e.LICENSES=4]="LICENSES",e[e.EVH_ADDON=5]="EVH_ADDON",e[e.IND_SUBSCRIPTION=6]="IND_SUBSCRIPTION"})(h=t.CancellationType||(t.CancellationType={}));var _=(function(e){function t(t){var a=e.call(this,t)||this;return a.onAccept=function(){switch(a.props.cancellationType){case h.PLAN:a.cancelPlanOrBillingScheduledChange(h.PLAN);break;case h.SCHEDULE:a.cancelPlanOrBillingScheduledChange(h.SCHEDULE);break;case h.LICENSES:a.cancelLicensesScheduledChanges();break;case h.ALL:a.cancelAll()}},a.subService=new o.SubscriptionService,a.state={submitting:!1},a}return a.__extends(t,e),t.showInstance=function(e){i.Modal.showInstance(p.createElement(t,a.__assign({},e)))},t.prototype.submittingRequest=function(){this.setState(function(e){return e.submitting=!0,e})},t.prototype.doneSubmittingRequest=function(){this.setState(function(e){return e.submitting=!1,e})},t.prototype.cancelAll=function(){var e=this,t=this.props,a=t.transitionPerformed,r=t.subStatus;this.submittingRequest();var o=l.SubscriptionDiff.fromSubscriptionState(r.subState);this.subService.validateAndPerformTransition(o).then(function(t){d.Notify.success(n._("Your scheduled changes have been cancelled!")),a&&a(t),i.Modal.close(),e.props.reOpenModalDialogAfterCancellation&&u.DBModalStack.trigger(m.CHANGE_PLAN_DUAL_MODAL_UPDATED,null)}).finally(function(){e.doneSubmittingRequest()})},t.prototype.cancelLicensesScheduledChanges=function(){var e=this,t=this.props.subStatus,a=l.SubscriptionDiff.fromSubscriptionStatus(t);this.submittingRequest(),a.setTotalLicenses(t.subState.totalLicenses),this.subService.price(a).then(function(t){e.subService.performTransition(t).then(function(t){e.props.transitionPerformed&&e.props.transitionPerformed(t),d.Notify.success(n._("You’ve cancelled your change!")),e.doneSubmittingRequest(),i.Modal.close(),e.props.reOpenModalDialogAfterCancellation&&u.DBModalStack.trigger(m.CHANGE_PLAN_DUAL_MODAL_UPDATED,null)}).catch(function(){e.errorUpdatingChanges()})}).catch(function(){e.errorUpdatingChanges()})},t.prototype.errorUpdatingChanges=function(){d.Notify.error(n._("Failed to revert changes.")),this.doneSubmittingRequest(),i.Modal.close()},t.prototype.cancelPlanOrBillingScheduledChange=function(e){var t,a,l=this,o=this.props,s=o.transitionPerformed,p=o.subStatus;this.submittingRequest(),c.WebRequest({url:"/account/team/change_plan_modal_view_model",success:function(o){if(t=JSON.parse(o).serializedSubChangePlans.map(function(e){return r.SubscriptionChangePlan.deserialize(e)}),a=t.filter(function(t){return!!(t.finalSubState&&t.finalSubState.plan&&t.finalSubState.billingSchedule&&p.subState&&p.subState.plan&&p.finalSubState&&p.finalSubState.billingSchedule&&p.finalSubState.plan&&p.subState.billingSchedule)&&(e===h.PLAN?p.subState.plan.productType===t.finalSubState.plan.productType&&p.finalSubState.billingSchedule.id===t.finalSubState.billingSchedule.id:e===h.SCHEDULE&&p.finalSubState.plan.productType===t.finalSubState.plan.productType&&p.subState.billingSchedule.id===t.finalSubState.billingSchedule.id)}),a.length>0){var c=a[0];l.subService.performTransition(c).then(function(e){d.Notify.success(n._("You’ve cancelled your change!")),s&&s(e),l.doneSubmittingRequest(),i.Modal.close(),l.props.reOpenModalDialogAfterCancellation&&u.DBModalStack.trigger(m.CHANGE_PLAN_DUAL_MODAL_UPDATED,null)})}else d.Notify.error(n._("Failed to revert changes."))},error:function(){d.Notify.error(n._("Failed to load modal.")),l.doneSubmittingRequest(),i.Modal.close(),l.props.reOpenModalDialogAfterCancellation&&u.DBModalStack.trigger(m.CHANGE_PLAN_DUAL_MODAL_UPDATED,null)}})},t.prototype.render=function(){var e=this.props,t=e.cancellationType,a=e.subStatus;if(!a.subState.plan||!a.subState.billingSchedule)return p.createElement("noscript",null);var r,l=n._("Confirm cancelled change");switch(t){case h.PLAN:r=n._("You’re cancelling your scheduled changes. Your %(trademark_business)s %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({trademark_business:s.TRADEMARK_BUSINESS,plan:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.subState.billingSchedule.scheduleDescriptionAdjective});break;case h.SCHEDULE:r=n._("You’re cancelling your scheduled changes. Your %(trademark_business)s %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({trademark_business:s.TRADEMARK_BUSINESS,plan:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.subState.billingSchedule.scheduleDescriptionAdjective});break;case h.LICENSES:r=n._("You’re cancelling your scheduled changes. Your %(trademark_business)s %(plan)s plan           will renew on %(date)s and you will be billed %(schedule)s.").format({trademark_business:s.TRADEMARK_BUSINESS,plan:a.subState.plan.displayName(),date:a.subState.formattedNextBillingDate,schedule:a.subState.billingSchedule.scheduleDescriptionAdjective});break;case h.ALL:l=n._("Confirmation"),r=n._("By confirming, all existing scheduled changes will be cancelled.");break;default:l=n._("Confirmation"),r=n._("By confirming, all existing scheduled changes will be cancelled.")}return p.createElement(i.Modal,{acceptButtonDisabled:this.state.submitting,acceptButtonText:n._("Confirm"),autoClose:!1,dismissButtonText:n._("Don’t cancel"),onAccept:this.onAccept,title:l,submitting:this.state.submitting},p.createElement("p",null,r))},t})(p.Component);t.CancelBillingChangesConfirmationView=_}),define("modules/clean/teams/admin/widgets/billing_notifications/cancellable_item",["require","exports","tslib","external/react","modules/core/i18n","external/classnames"],function(e,t,a,n,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a.__extends(t,e),t.prototype.render=function(){var e,t=this.props,a=t.title,i=t.description,l=t.handleAction,o=t.useCTA,s=t.CTAText,c=this.props.className?this.props.className:"",u=r((d={"cancellable-item__button":!0,"link-button":!0},d[c]=!0,d));return o&&(e=n.createElement("button",{className:u,onClick:l},s)),n.createElement("div",{className:"cancellable-item"},n.createElement("span",{className:"cancellable-item__title"},a)," ",n.createElement("span",{className:"cancellable-item__desc"},i),e);var d},t.defaultProps={CTAText:i._("Cancel change"),useCTA:!1},t})(n.Component);t.CancellableItemView=l}),define("modules/clean/teams/admin/widgets/change_plan_modal/change_plan_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CHANGE_PLAN_DUAL_MODAL_UPDATED="change_plan_dual_modal:updated";(function(e){e[e.PLAN_CHANGE=1]="PLAN_CHANGE",e[e.SCHEDULE_CHANGE=2]="SCHEDULE_CHANGE"})(t.DualPlanModalMode||(t.DualPlanModalMode={}))});
//# sourceMappingURL=pkg-account_subscription.min.js-vflQUe6Y-.map