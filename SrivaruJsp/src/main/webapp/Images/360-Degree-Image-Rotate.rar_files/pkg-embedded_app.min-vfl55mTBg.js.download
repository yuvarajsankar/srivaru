define("external/deep-freeze",["require","exports","module"],function(e,t,r){r.exports=function e(t){return Object.freeze(t),Object.getOwnPropertyNames(t).forEach(function(r){!t.hasOwnProperty(r)||null===t[r]||"object"!=typeof t[r]&&"function"!=typeof t[r]||Object.isFrozen(t[r])||e(t[r])}),t}}.bind(Object.create(null))),define("modules/clean/accessibility/utils",["require","exports","modules/clean/keycode"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.accessibleColorPalette=["#006AFF","#0073E1","#007BC3","#007F9B","#008578","#008750","#008928","#008800","#0573EB","#0579C3","#0580A0","#05857D","#058655","#058932","#05890A","#0A71F0","#0A78CD","#0A7FAA","#0A8487","#0A855F","#0A8737","#0A880F","#0F6EF5","#0F76D7","#0F7DB4","#0F818C","#0F8669","#0F8741","#0F8819","#146DFF","#1475DC","#147BBE","#14819B","#148473","#14864B","#148723","#1969FF","#1972E1","#1979C3","#1980A0","#198278","#198550","#198728","#198700","#1E70E6","#1E79C8","#1E7FA5","#1E837D","#1E8555","#1E8832","#1E880A","#236EEB","#2376D2","#237CAF","#238187","#23845F","#23883C","#238914","#286DF5","#2876D7","#287CB4","#28808C","#288469","#288541","#288619","#2D6AFA","#2D73DC","#2D7BB9","#2D8096","#2D836E","#2D8446","#2D8823","#3267FF","#3271E1","#3279C3","#327D9B","#328378","#328550","#328528","#328600","#376EE6","#3777C8","#377DA5","#37807D","#37855A","#378632","#37860A","#3C6CEB","#3C74CD","#3C7BAA","#3C8087","#3C835F","#3C8437","#3C8614","#416AF5","#4173D7","#4179B9","#417E91","#418069","#418341","#418419","#4667FA","#466FDC","#4676BE","#467B9B","#468073","#46824B","#468423","#4B63FF","#4B6DE1","#4B75BE","#4B7B9B","#4B8078","#4B8150","#4B8228","#4B8300","#5069E6","#5072C8","#5079A5","#507C7D","#50815A","#508232","#50830A","#5567F0","#556FD2","#5575AA","#557A87","#557E5F","#55823C","#558314","#5A65F5","#5A6DD7","#5A75B4","#5A7A91","#5A7D69","#5A7F41","#5A821E","#5F61FA","#5F69DC","#5F71BE","#5F779B","#5F7E50","#5F7F28","#5F8100","#6466E6","#646DC3","#6475A5","#647D55","#647E2D","#648005","#6964EB","#696BC8","#6972A5","#697C55","#697E2D","#697F05","#6E62EB","#6E6AC8","#6E71A5","#6E7C46","#6E7E1E","#7358FF","#7363E1","#736ABE","#7372A0","#785CEB","#7864CD","#786DAF","#7D53FF","#7D5EE1","#7D66C3","#7D6EA0","#8255F5","#825FD7","#8268B9","#826D91","#8756F0","#8760D2","#8766AA","#8C4AFF","#8C56E6","#8C60C8","#8C66A0","#914BF5","#9157DC","#9160BE","#916596","#964BEB","#9655D2","#965EAF","#966691","#9B47F0","#9B51D2","#9B5CB4","#9B6191","#A041F5","#A04EDC","#A058B9","#A06196","#A53BF5","#A548DC","#A553BE","#A55A96","#AA34FA","#AA42E6","#AA4FC8","#AA58A0","#AA5F78","#AA614B","#AA6623","#AF29FF","#AF38E6","#AF47D2","#AF52AF","#AF5782","#AF5E5A","#AF622D","#AF6400","#B42CF0","#B43CD7","#B447B4","#B45291","#B45864","#B45D37","#B45D05","#B919FF","#B92CE6","#B93BC8","#B94AAA","#B9547D","#B95B4B","#B95A14","#BE0CF0","#BE1FEB","#BE31CD","#BE41B4","#BE4C87","#BE5455","#BE561E","#C307EB","#C31AE1","#C32CC8","#C33DB4","#C3488C","#C34F5A","#C35428","#C803E1","#C816E1","#C826C3","#C836AF","#C8428C","#C8495F","#C84F32","#C85200","#CD11C8","#CD22C8","#CD31AF","#CD3B87","#CD4664","#CD4B37","#CD4D0A","#D20CC3","#D21CB4","#D229A0","#D23587","#D23E64","#D23F37","#D2430F","#D708AF","#D716A0","#D72291","#D73087","#D7355F","#D73A3C","#D73A14","#DC0596","#DC119B","#DC1D91","#DC256E","#DC2E5A","#DC343C","#DC3419","#E1027D","#E10C87","#E11882","#E11B5A","#E12755","#E12A37","#E12919","#E13200","#E6075F","#E60C4B","#E61655","#E61D46","#E62132","#E61B14","#E61A00","#EB0232","#EB0214","#EB0D30"],t.accessibleTriggerProps=function(e,t){return void 0===t&&(t="button"),{role:t,tabIndex:0,onClick:function(t){return e(t)},onKeyDown:function(t){if(t.keyCode===r.KeyCode.ENTER||t.keyCode===r.KeyCode.SPACE)return e(t)}}}}),define("modules/clean/ajax_minimal",["require","exports"],function(e,t){"use strict";function r(e){var t=document.cookie.match("(^|; )"+e+"=([^;]*)");return t?t[2]:""}function n(e,t){var n=new XMLHttpRequest;n.open("POST",e),n.withCredentials=!0,n.setRequestHeader("X-CSRF-Token",r("__Host-js_csrf")),n.send(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.post=n}),define("modules/clean/browse_uri_interface",["require","exports","modules/clean/react/browse/uri_helper","modules/clean/viewer","modules/core/uri"],function(e,t,r,n,s){"use strict";function o(e){return r.browse_root(n.Viewer.get_viewer(),e)}function i(e,t){return"/"!==t.charAt(0)&&(t="/"+t),new s.URI({scheme:"https",authority:"www.dropbox.com",path:"/preview"+t,query:{role:e.role}})}function a(e,t){return t.is_dir?t.href:t.is_cloud_doc&&t.preview_url?t.preview_url:i(e,t.fq_path).toString()}function c(e,t){return new s.URI({scheme:"https",authority:"www.dropbox.com",path:""+o(e)+t})}Object.defineProperty(t,"__esModule",{value:!0}),t.get_browse_root=o,t.preview_uri_for_fq_path=i,t.href_for_file=a,t.browse_uri_for_fq_path=c}),define("modules/clean/filetypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.FILE=1]="FILE",e[e.FOLDER=2]="FOLDER",e[e.PACKAGE=3]="PACKAGE",e[e.SHARED_FOLDER=4]="SHARED_FOLDER",e[e.SANDBOX=5]="SANDBOX",e[e.TEAM_SHARED_FOLDER=6]="TEAM_SHARED_FOLDER",e[e.TEAM_MEMBER_FOLDER=7]="TEAM_MEMBER_FOLDER"})(t.FileTypes||(t.FileTypes={}))}),define("modules/clean/immutability_helper",["require","exports","external/deep-freeze"],function(e,t,r){"use strict";function n(e){if(null==e)throw new TypeError("Cannot thaw null/undefined object");if(Array.isArray(e))return E.call(e);for(var t=Object.create(Object.getPrototypeOf(e)),r=Object.getOwnPropertyNames(e),n=0,s=r;n<s.length;n++){var o=s[n],i=Object.getOwnPropertyDescriptor(e,o);i&&(i.get||i.set)?(i.configurable=!0,Object.defineProperty(t,o,i)):t[o]=e[o]}return t}function s(e,t){var s=n(e);return t(s),r(s)}function o(e,t){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));return t.reduce(function(e,t){return null==e?null:e[t]},e)}function i(e,t,s){if(null==e)throw new TypeError("Object to `set` cannot be null");if(e[t]===s)return e;var o=n(e);return o[t]=s,r(o)}function a(e,t,r){return i(e,t,r(e[t]))}function c(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];return 1===t.length?a(e,n,r):i(e,n,c(e[n],t.slice(1),r))}function l(e,t,r){if(!t||0===t.length)throw new TypeError("Invalid key path: "+JSON.stringify(t));if(null==e)throw new TypeError("Target object cannot be null");var n=t[0];switch(t.length){case 1:return i(e,n,r);default:return i(e,n,l(e[n]||{},t.slice(1),r))}}function _(e,t){if(null==e||null==t)throw new TypeError("Both target and source cannot be null");var s=Object.keys(t).reduce(function(r,n){return t[n]!==e[n]&&r.push(n),r},[]);if(s.length){for(var o=n(e),i=0,a=s;i<a.length;i++){var c=a[i],l=Object.getOwnPropertyDescriptor(t,c);void 0!==l&&Object.defineProperty(o,c,l)}return r(o)}return e}function u(e,t,r){if(null==e||null==r)throw new TypeError("Both target and source cannot be null");return c(e,t,function(e){return _(e,r)})}function p(e,t,n){for(var s=[],o=3;o<arguments.length;o++)s[o-3]=arguments[o];var i=E.call(e);return i.splice.apply(i,[t,n].concat(s)),r(i)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=E.call(e);return s.unshift.apply(s,t),r(s)}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var s=E.call(e);return s.push.apply(s,t),r(s)}Object.defineProperty(t,"__esModule",{value:!0});var E=Array.prototype.slice;t.thaw=n,t.withMutations=s,t.getIn=o,t.set=i,t.update=a,t.updateIn=c,t.setIn=l,t.merge=_,t.mergeIn=u,t.splice=p,t.unshift=d,t.push=h}),define("modules/clean/prompt/api/rendering",["require","exports"],function(e,t){"use strict";function r(e){return void 0!==e.remindMeLaterText}Object.defineProperty(t,"__esModule",{value:!0}),t.isHomeModalContent=r}),define("modules/clean/react/badge",["require","exports","tslib","external/react","external/classnames","modules/clean/react/css","modules/core/i18n"],function(e,t,r,n,s,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;(function(e){e.NEW="new",e.PRO="pro"})(a=t.BadgeVariant||(t.BadgeVariant={}));var c;(function(e){e.NEON_GREEN="neon-green",e.STONE_FORTY="stone-forty",e.SQUASH="squash",e.PINK="pink"})(c=t.BadgeColor||(t.BadgeColor={}));var l=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("span",{className:s("badge","badge--variant-"+this.props.variant,"badge--color-"+this.props.color,{"badge--absolute":this.props.absolute},this.props.className)},this.props.variant===a.NEW?i._("New"):this.props.variant===a.PRO?i._("Pro"):null)},t.defaultProps={color:c.NEON_GREEN,absolute:!1},t})(n.Component);t.Badge=o(l,["/static/css/react/badge-vflKQq0q3.css"])}),define("modules/clean/react/browse/constants",["require","exports","modules/core/i18n"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.NotReady=0]="NotReady",e[e.NotLive=1]="NotLive",e[e.Live=2]="Live"})(t.BrowseBoltClientStatus||(t.BrowseBoltClientStatus={}));(function(e){e.APP_INIT="APP_INIT",e.INITIALIZE_EVERYTHING="INITIALIZE_EVERYTHING",e.LOAD_PATH="LOAD_PATH",e.CLEAR_FILES="CLEAR_FILES",e.ADD_FILES_AND_SET_LOADING_STATE="ADD_FILES_AND_SET_LOADING_STATE",e.SET_PATH="SET_PATH",e.SET_LOADING_STATE="SET_LOADING_STATE",e.SET_MOUNT_POINTS="SET_MOUNT_POINTS",e.SET_TEAM_FOLDERS="SET_TEAM_FOLDERS",e.CHANGE_FILES="CHANGE_FILES",e.SET_SELECTION="SET_SELECTION",e.SELECT_FILES_AFTER_UPLOAD="SELECT_FILES_AFTER_UPLOAD",e.SELECT_FILES_BY_FQ_PATH="SELECT_FILES_BY_FQ_PATH",e.SET_SHOULD_SHOW_DELETED_FILES="SET_SHOULD_SHOW_DELETED_FILES",e.SET_DROP_TARGET="SET_DROP_TARGET",e.SORT_FILES="SORT_FILES",e.SET_VIEW_TYPE="SET_VIEW_TYPE",e.COPY_FILES_TO_CLIPBOARD="COPY_FILES_TO_CLIPBOARD",e.REQUEST_NEW_FILE_NAME="REQUEST_NEW_FILE_NAME",e.CANCEL_FILE_RENAME="CANCEL_FILE_RENAME",e.SET_FILE_RENAME_PENDING="SET_FILE_RENAME_PENDING",e.SET_FILE_RENAME_COMPLETE="SET_FILE_RENAME_COMPLETE",e.REQUEST_FOLDER_NAME="REQUEST_FOLDER_NAME",e.CREATE_FOLDER_PENDING="CREATE_FOLDER_PENDING",e.CREATE_FOLDER_COMPLETE="CREATE_FOLDER_COMPLETE",e.CANCEL_CREATE_FOLDER="CANCEL_CREATE_FOLDER",e.SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE="SET_FILE_PATHS_TO_SELECT_ON_NEXT_UPDATE",e.ADD_COMMENT_STATUS_BATCH="ADD_COMMENT_STATUS_BATCH",e.ADD_FILE_JUMP_KEY_CODE="ADD_FILE_JUMP_KEY_CODE",e.RESET_FILE_JUMP="RESET_FILE_JUMP",e.REQUEST_FETCH_FOLDER_SIZES="REQUEST_FETCH_FOLDER_SIZES",e.FETCHED_FOLDER_SIZES="FETCHED_FOLDER_SIZES",e.COMPLETE_FETCH_FOLDER_SIZES="COMPLETE_FETCH_FOLDER_SIZES",e.SET_COLUMN_DEPENDENT_CAPABILITIES="SET_COLUMN_DEPENDENT_CAPABILITIES",e.SET_TILES_PER_ROW="SET_TILES_PER_ROW",e.SET_COLUMN_CONFIGURATION="SET_COLUMN_CONFIGURATION"})(t.BrowseActionType||(t.BrowseActionType={})),t.BROWSE_FILE_VIEWER_ELEMENT_ID="browse-react-file-viewer-container";var n={IMAGE:["bmp","cr2","gif","ico","jpeg","jpg","nef","png","psd","tif","tiff","svg","svgz"],VIDEO:["3gp","3gpp","3gpp2","avi","dv","flv","m2t","m4v","mkv","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],AUDIO:["aif","flac","m4a","m4p","mp3","ogg","wav","wma"],DOCUMENT:["ai","cdr","csv","doc","docx","docm","eps","fla","indd","keynote","numbers","otf","pages","pdf","ppt","pptx","pptm","pps","ppsx","ppsm","ps","rtf","swf","txt","wpd","xls","xlsx","xlsm"],COMPRESSED_FILE:["7z","bz2","gz","gzip","rar","tar","zip"],CODE:["as","as3","asm","aspx","bat","c","cc","cmake","coffee","cpp","cs","css","cxx","diff","erb","erl","groovy","gry","h","haml","hh","hpp","html","htm","hxx","java","js","json","jsx","less","lst","m","make","mk","ml","mm","msg","out","patch","php","pl","pm","plist","properties","py","rb","sass","scala","scm","script","scss","sh","sml","sql","vb","vi","vim","xhtml","xml","xsd","xsl","y","yaml","yml","yxx"],DISK_IMAGE:["dmg","iso"],EXECUTABLE:["exe"],SHORTCUT:["lnk"],LINK:["url","webloc"],FONT:["ttf"]};t.CulledListConstants={ITEM_ROW_HEIGHT_PX:46,MAESTRO_ITEM_ROW_HEIGHT_PX:57,SEARCH_ROW_HEIGHT_PX:53,MAESTRO_SEARCH_ROW_HEIGHT_PX:66,DEFAULT_HEADER_HEIGHT_PX:142,ITEM_BUFFER_SIZE:5},t.OverflowMenuConstants={MENU_ITEM_HEIGHT_PX:32,MENU_MARGIN_PX:8,MENU_POPOVER_ITEM_GROUP_SEPARATOR_HEIGHT_PX:17},t.FileTypeCategoryTranslations={FILE:r._("File"),FOLDER:r._("Folder"),SHARED_FOLDER:r._("Shared folder"),TEAM_SHARED_FOLDER:r._("Team folder"),TEAM_MEMBER_FOLDER:r._("Member folder"),PUBLIC_FOLDER:r._("Folder"),IMAGE:r._("Image"),VIDEO:r._("Video"),AUDIO:r._("Audio"),DOCUMENT:r._("Document"),COMPRESSED_FILE:r._("Archive"),CODE:r._("Code"),DISK_IMAGE:r._("Disk image"),EXECUTABLE:r._("Executable"),SHORTCUT:r._("Shortcut"),LINK:r._("Link"),FONT:r._("Font"),SANDBOX:r._("App folder")},t.FileTypeCapitalizedCategoryTranslations={FILE:r._("FILE"),FOLDER:r._("FOLDER"),SHARED_FOLDER:r._("SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("MEMBER FOLDER"),PUBLIC_FOLDER:r._("FOLDER"),IMAGE:r._("IMAGE"),VIDEO:r._("VIDEO"),AUDIO:r._("AUDIO"),DOCUMENT:r._("DOCUMENT"),COMPRESSED_FILE:r._("ARCHIVE"),CODE:r._("CODE"),DISK_IMAGE:r._("DISK IMAGE"),EXECUTABLE:r._("EXECUTABLE"),SHORTCUT:r._("SHORTCUT"),LINK:r._("LINK"),FONT:r._("FONT"),SANDBOX:r._("APP FOLDER")},t.DeletedFileTypeCategoryTranslations={FILE:r._("Deleted file"),FOLDER:r._("Deleted folder"),SHARED_FOLDER:r._("Deleted shared folder"),TEAM_SHARED_FOLDER:r._("Deleted team folder"),TEAM_MEMBER_FOLDER:r._("Deleted member folder"),PUBLIC_FOLDER:r._("Deleted folder"),IMAGE:r._("Deleted image"),VIDEO:r._("Deleted video"),AUDIO:r._("Deleted audio"),DOCUMENT:r._("Deleted document"),COMPRESSED_FILE:r._("Deleted archive"),CODE:r._("Deleted code"),DISK_IMAGE:r._("Deleted disk image"),EXECUTABLE:r._("Deleted executable"),SHORTCUT:r._("Deleted shortcut"),LINK:r._("Deleted link"),FONT:r._("Deleted font"),SANDBOX:r._("Deleted app folder")},t.DeletedFileTypeCapitalizedCategoryTranslations={FILE:r._("DELETED FILE"),FOLDER:r._("DELETED FOLDER"),SHARED_FOLDER:r._("DELETED SHARED FOLDER"),TEAM_SHARED_FOLDER:r._("DELETED TEAM FOLDER"),TEAM_MEMBER_FOLDER:r._("DELETED MEMBER FOLDER"),PUBLIC_FOLDER:r._("DELETED FOLDER"),IMAGE:r._("DELETED IMAGE"),VIDEO:r._("DELETED VIDEO"),AUDIO:r._("DELETED AUDIO"),DOCUMENT:r._("DELETED DOCUMENT"),COMPRESSED_FILE:r._("DELETED ARCHIVE"),CODE:r._("DELETED CODE"),DISK_IMAGE:r._("DELETED DISK IMAGE"),EXECUTABLE:r._("DELETED EXECUTABLE"),SHORTCUT:r._("DELETED SHORTCUT"),LINK:r._("DELETED LINK"),FONT:r._("DELETED FONT"),SANDBOX:r._("DELETED APP FOLDER")},t.ExtensionCategories={};for(var s=0,o=Object.keys(n);s<o.length;s++)for(var i=o[s],a=n[i],c=0,l=a;c<l.length;c++){var _=l[c];t.ExtensionCategories[_]=i}(function(e){e[e.ShareExisting=1]="ShareExisting",e[e.EditShared=2]="EditShared",e[e.EditSharedSubFolder=3]="EditSharedSubFolder"})(t.ShareFolderModalType||(t.ShareFolderModalType={}));(function(e){e.SET_SHARED_FOLDER_DATA="SET_SHARED_FOLDER_DATA",e.SET_MEMBER_COUNTS_FOR_NS="SET_MEMBER_COUNTS_FOR_NS",e.SET_SHARED_LINK_DATA="SET_SHARED_LINK_DATA",e.SET_SHARED_FILE_DATA="SET_SHARED_FILE_DATA",e.SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE="SIGNAL_SHARED_FILE_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE="SIGNAL_SHARED_FOLDER_DATA_OUT_OF_DATE",e.SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE="SIGNAL_SHARED_LINK_DATA_OUT_OF_DATE",e.CLEAR_SHARED_FOLDER_DATA_FOR_NS="CLEAR_SHARED_FOLDER_DATA_FOR_NS",e.REMOVE_SHARED_LINK_DATA="REMOVE_SHARED_LINK_DATA"})(t.SharedWithActionType||(t.SharedWithActionType={})),t.SEARCH_PREFIX="/search",t.MAX_FOLDERS_PER_CALL=100,t.MAX_FOLDER_SIZE_QUEUE_SIZE=50,t.MAX_FOLDER_SIZE_ITERATIONS=1e3;(function(e){e.GOOGLE_DSS_DOC="gdoc",e.GOOGLE_DSS_SHEET="gsheet",e.GOOGLE_DSS_SLIDES="gslides",e.PAPER="paper"})(t.CloudDoc||(t.CloudDoc={}));(function(e){e.WORD="docx",e.EXCEL="xlsx",e.POWERPOINT="pptx"})(t.MicrosoftFileTypes||(t.MicrosoftFileTypes={})),t.VIEW_TYPE_COOKIE_NAME="browse_view_type",t.COLUMNS_STORAGE_KEY="browse_columns",t.BROWSE_SORT_COOKIE_NAME="browse_current_sort";var u;(function(e){e.country_override="country_override",e.cProfile="cProfile",e.d="d",e.last_fq_path="last_fq_path",e.path="path",e.preview="preview",e.public_mode_override="public_mode_override",e.query="query",e.query_unnormalized="query_unnormalized",e.search_session_id="search_session_id",e.search_token="search_token",e.select="select",e.stormcrow_override="stormcrow_override",e.stormcrow_override_data_field="stormcrow_override_data_field",e.stormcrow_override_population="stormcrow_override_population",e.stormcrow_override_ttl="stormcrow_override_ttl",e.stormcrow_panel="stormcrow_panel",e.uncompressed_js="uncompressed_js",e.use_packages="use_packages",e.file_categories="file_categories"})(u=t.BrowseQueryArg||(t.BrowseQueryArg={})),t.FRAMEWORK_ARGS=[[u.country_override],[u.cProfile],[u.public_mode_override],[u.stormcrow_override],[u.stormcrow_override_data_field],[u.stormcrow_override_population],[u.stormcrow_override_ttl],[u.stormcrow_panel],[u.uncompressed_js],[u.use_packages]]}),define("modules/clean/react/browse/logger_util",["require","exports"],function(e,t){"use strict";function r(e){return!!e&&!!e.fq_path}function n(e){return!!e&&!!e.pad_id}function s(e){return void 0!==e.folder_id}function o(e){var t=e.filter(function(e){return r(e)&&e.is_dir}).count();return{num_files_selected:e.filter(function(e){return r(e)&&!e.is_dir}).count(),num_folders_selected:t}}Object.defineProperty(t,"__esModule",{value:!0}),t.isFile=r,t.isPaper=n,t.isPaperFolder=s,t.countFilesAndFolders=o}),define("modules/clean/react/browse/models",["require","exports","tslib","modules/clean/immutability_helper","modules/clean/filepath","modules/clean/filetypes","modules/clean/react/browse/constants","modules/clean/sharing/access_level","modules/clean/display_format","modules/clean/datetime","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(){function e(e){this.beacon_context=e.beacon_context,this.bytes=e.bytes,this.comment_count=e.comment_count,this.direct_blockserver_link=e.direct_blockserver_link,this.event_type=e.event_type,this.ext=e.ext,this.feedback_off=e.feedback_off,this.file_id=e.file_id,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.fq_path=e.fq_path,this.href=e.href,this.htmlified_link=e.htmlified_link,this.icon=e.icon,this.is_cloud_doc=e.is_cloud_doc,this.is_dir=e.is_dir,this.is_in_team_folder_tree=e.is_in_team_folder_tree,this.is_symlink=e.is_symlink,this.is_unmounted=e.is_unmounted,this.last_modified_name=e.last_modified_name,this.latest_rev=e.latest_rev,this.linkfile_data=e.linkfile_data,this.match_type=e.match_type,this._mount_access_perms=e._mount_access_perms,this.ns_id=e.ns_id,this.ns_path=e.ns_path,this.preview_type=e.preview_type,this.preview_url=e.preview_url,this.preview_thumbnail_url=e.preview_thumbnail_url,this.read_only=!!e.read_only,this.request_id=e.request_id,this.revision_id=e.revision_id,this.sjid=e.sjid,this.sort_key=e.sort_key,this.sort_rank=e.sort_rank,this.sync_setting=e.sync_setting,this.target_ns=e.target_ns,this.team_folder_status=e.team_folder_status,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.ts=e.ts,this.type=e.type,this.unresolved_comment_count=e.unresolved_comment_count,this.video_metadata_url=e.video_metadata_url,this.video_container=e.video_container,this.video_transcode_url=e.video_transcode_url,this.video_thumb_scrubber_vtt_url=e.video_thumb_scrubber_vtt_url,this.preview_ssr_text_url_tmpl=e.preview_ssr_text_url_tmpl,this.preview_ssr_image_url_tmpl=e.preview_ssr_image_url_tmpl,this.preview_ssr_refresh_url=e.preview_ssr_refresh_url,this.isDeleted=!!e.isDeleted,this.fetchFolderSizesStatus=e.fetchFolderSizesStatus}return Object.defineProperty(e.prototype,"ago",{get:function(){return this.is_dir||null===this.ts||void 0===this.ts?"":l.getActingTimeWithAgoEnabled(1e3*this.ts,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.isDeleted||this.bytes<0?_._("Deleted"):void 0===this.bytes?"":c.format_bytes(this.bytes)},enumerable:!0,configurable:!0}),e.fromServerObject=function(t){return new e(r.__assign({},t,{_mount_access_perms:t.mount_access_perms,isDeleted:t.bytes===-1}))},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.merge=function(e){return n.merge(this,e)},e.prototype.toJS=function(){return Object.assign({},this)},e.getExtension=function(e){return e.is_dir?"":s.file_extension(s.filename(e.fq_path))},e.getCategoryDescription=function(t,r){void 0===r&&(r=!1);var n;if(t.is_dir)if(t.is_in_team_folder_tree)n="SHARED_FOLDER";else switch(n="FOLDER",t.type){case o.FileTypes.TEAM_SHARED_FOLDER:n="TEAM_SHARED_FOLDER";break;case o.FileTypes.SHARED_FOLDER:n="SHARED_FOLDER";break;case o.FileTypes.SANDBOX:n="SANDBOX";break;case o.FileTypes.TEAM_MEMBER_FOLDER:n="TEAM_MEMBER_FOLDER";break;default:t.target_ns&&(n="SHARED_FOLDER")}else n=i.ExtensionCategories[e.getExtension(t)]||"FILE";return t.isDeleted?r?i.DeletedFileTypeCapitalizedCategoryTranslations[n]:i.DeletedFileTypeCategoryTranslations[n]:r?i.FileTypeCapitalizedCategoryTranslations[n]:i.FileTypeCategoryTranslations[n]},e.isTeamSharedFolder=function(e){return e.type===o.FileTypes.TEAM_SHARED_FOLDER},e.isTeamMemberFolder=function(e){return e.type===o.FileTypes.TEAM_MEMBER_FOLDER},e.isReadOnlySharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_edit")},e.isNoAccessSharedFolder=function(e){var t=e._mount_access_perms;return null!=t&&!t.includes("can_view")},e.canViewFileMembers=function(e,t){var r=e._mount_access_perms;return!(r&&r.indexOf("can_view_members")<0)&&(!(t&&!t.canViewContainingNSMembers)||!!(r&&r.indexOf("can_view_members")>=0))},e.prototype.updateSize=function(e,t){return this.merge({bytes:e,fetchFolderSizesStatus:t})},e})();t.File=u;var p=(function(){function e(e){void 0===e&&(e={}),this.isPublicFolderEnabled=!!e.isPublicFolderEnabled,this.publicFolderFqPath=e.publicFolderFqPath,this.publicAppToken=e.publicAppToken,Object.freeze(this)}return e.fromServerObject=function(t){return new e({isPublicFolderEnabled:t.public_folder_enabled,publicFolderFqPath:t.public_folder_fq_path,publicAppToken:t.public_app_token})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e})();t.Config=p;var d=(function(){function e(e){var t=void 0===e?{}:e,r=t.canViewContainingNSMembers,n=t.currentNSID,s=t.currentFQPath,o=t.currentMountPoint,i=t.currentNSPath,c=t.currentSharedFolderPermissionRole,l=t.currentNSAllowsNesting,_=t.inactiveNSIDByFQPath,u=t.permanentDeletionDisabledStateByNSID,d=t.isInFolderMode,h=t.isCurrentlyInRoot,E=t.isInsideSandboxFolder,m=t.isInsideSharedFolder,S=t.isInsideTeamFolderRoot,f=t.isInsideArchivedTeamFolder,C=t.isInsideTeamFolderTree,g=t.isInsideMyTeamFolderTree,A=t.isInsideDeletedFolder,T=t.isInsideDeletedSharedFolder,R=t.isInsideDeletedNestedSharedFolder,I=t.isNonUserRelativeContext,O=t.pathRoot,D=t.rootNSID,v=t.showPinnedTeamFolder,y=t.teamFolderOwnerTeamApiId,L=t.blockHash,F=t.config,b=t.syncSetting;this.canViewContainingNSMembers=null==r||r,this.currentNSID=n||0,this.currentFQPath=s||"",this.currentMountPoint=o,this.currentNSPath=i,this.currentSharedFolderPermissionRole=null!=c?c:a.NameSpaceAccess.ACCESS_NO_ACCESS,this.currentNSAllowsNesting=!!l,this.inactiveNSIDByFQPath=_||{},this.permanentDeletionDisabledStateByNSID=u||{},this.isInFolderMode=null==d||d,this.isCurrentlyInRoot=!!h,this.isInsideSandboxFolder=!!E,this.isInsideSharedFolder=!!m,this.isInsideTeamFolderRoot=!!S,this.isInsideArchivedTeamFolder=!!f,this.isInsideTeamFolderTree=!!C,this.isInsideMyTeamFolderTree=!!g,this.isInsideDeletedFolder=!!A,this.isInsideDeletedSharedFolder=!!T,this.isInsideDeletedNestedSharedFolder=!!R,this.isNonUserRelativeContext=!!I,this.pathRoot=O,this.rootNSID=D,this.showPinnedTeamFolder=!!v,this.teamFolderOwnerTeamApiId=y,this.blockHash=L,this.config=F||new p,this.syncSetting=b}return e.fromServerObject=function(t){var r=t.containing_fq_path||"";r.startsWith("/")||(r="/"+r);var n;t.inside_shared_folder&&(n=a.NameSpaceAccess.ACCESS_READER);var s,o=t.containing_ns_permissions||[],i=o.includes("mount_shared_folders");return t.inside_shared_folder&&(o.includes("edit_contents")&&(n=a.NameSpaceAccess.ACCESS_WRITER),o.includes("change_folder_options")&&(n=a.NameSpaceAccess.ACCESS_OWNER),o.includes("view_members")||(s=!1)),new e({blockHash:t.block_hash,canViewContainingNSMembers:s,config:p.fromServerObject(t),currentFQPath:r,currentMountPoint:t.containing_mount_point,currentNSAllowsNesting:i,currentNSID:t.containing_ns_id,currentNSPath:t.containing_ns_path,currentSharedFolderPermissionRole:n,inactiveNSIDByFQPath:t.old_path_to_ns_id,isCurrentlyInRoot:t.in_root_dir,isInFolderMode:t.inside_dir,isInsideSandboxFolder:t.inside_sandbox_folder,isInsideArchivedTeamFolder:t.inside_archived_team_folder,isInsideTeamFolderRoot:t.inside_team_folder_root,isInsideDeletedFolder:t.inside_deleted_dir,isInsideDeletedNestedSharedFolder:t.inside_deleted_nested_shared_folder,isInsideDeletedSharedFolder:t.inside_deleted_shared_folder,isInsideSharedFolder:t.inside_shared_folder,isInsideTeamFolderTree:t.inside_team_folder_tree,isInsideMyTeamFolderTree:t.inside_my_team_folder_tree,isNonUserRelativeContext:t.is_non_user_relative_context,pathRoot:t.path_root,permanentDeletionDisabledStateByNSID:t.permanent_delete_is_disabled_by_ns_id,rootNSID:t.root_ns_id,showPinnedTeamFolder:t.show_pinned_team_folder,teamFolderOwnerTeamApiId:t.team_folder_owner_team_dbtid,syncSetting:t.sync_setting})},e.prototype.set=function(e,t){return n.set(this,e,t)},e.prototype.toJSON=function(){return Object.assign({},this)},e.prototype.toJS=function(){return this.toJSON()},e.prototype.isCurrentPathWriteable=function(){var e=this,t=e.currentSharedFolderPermissionRole;return!e.isInsideSharedFolder||t===a.NameSpaceAccess.ACCESS_WRITER||t===a.NameSpaceAccess.ACCESS_OWNER},e.prototype.getNameOfTargetFolder=function(){return s.filename(this.currentFQPath)},e})();t.BrowseContext=d;var h=(function(){function e(e){this.title=e.title,this.pad_id=e.pad_id,this.url=e.url,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.creator_name=e.creator_name,this.last_editor_name=e.last_editor_name,this.request_id=e.request_id,this.sort_rank=e.sort_rank,this.ts=e.ts}return Object.defineProperty(e.prototype,"last_modified_date",{get:function(){if(!this.ts)return"";var e=new Date(this.ts).getTime();return l.getActingTimeWithAgoEnabled(e,!1,!0,0,!0,!0,!0)},enumerable:!0,configurable:!0}),e.fromServerObject=function(t){return new e(t)},e})();t.Paper=h;var E=(function(){function e(e){this.name=e.name,this.url=e.url,this.folder_id=e.folder_id,this.title_highlights=e.title_highlights,this.highlight_spans=e.highlight_spans,this.request_id=e.request_id,this.sort_rank=e.sort_rank}return e.fromServerObject=function(t){return new e(t)},e})();t.PaperFolder=E}),define("modules/clean/react/browse/uri_helper",["require","exports"],function(e,t){"use strict";function r(e,t){return e.is_paired?"personal"===t.role?"/personal":"/work":"/home"}Object.defineProperty(t,"__esModule",{value:!0}),t.browse_root=r}),define("modules/clean/react/maestro/a11y_constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.TITLE=0]="TITLE",e[e.SEARCH_BAR=1]="SEARCH_BAR",e[e.NOTIFICATION_BELL=2]="NOTIFICATION_BELL",e[e.CALENDAR_FLYOUT=3]="CALENDAR_FLYOUT",e[e.ACCOUNT_MENU=4]="ACCOUNT_MENU",e[e.MAIN_CONTENT=5]="MAIN_CONTENT",e[e.SIDE_BAR=6]="SIDE_BAR"})(t.LAYOUT_TAB_ORDER||(t.LAYOUT_TAB_ORDER={}))}),define("modules/clean/react/maestro/header",["require","exports","tslib","external/react","modules/clean/react/css","modules/clean/react/maestro/top_menu_container","modules/clean/react/maestro_nav/shared_code/dropbox_logo","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive","external/classnames","modules/clean/user_education/react/user_education_effect"],function(e,t,r,n,s,o,i,a,c,l,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return n.createElement("header",{className:"maestro-header page-header__shadow"},n.createElement(c.VerticallyFixedWrapper,{className:"page-header",responsive:this.props.responsive},n.createElement("div",{className:l("page-header__title",this.props.titleClass),tabIndex:a.LAYOUT_TAB_ORDER.TITLE},n.createElement(_.UserEducationEffect,{containerName:"PageletMaestroHeader",name:"Title",useSpan:!0},this.props.title)),n.createElement(o.TopMenuContainer,r.__assign({},this.props))))},t.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1},t})(n.Component),p=function(e){var t=e.children;return n.createElement("h1",{className:"page-header__heading"},t)};t.MaestroHeaderTitle=p;var d=function(){return n.createElement("a",{href:"/",className:"page-header__logo"},n.createElement(i.DropboxLogo,{alt:"Dropbox"}))};t.MaestroHeaderLogo=d;var h=s(u,["/static/css/maestro_layout-vflK26Kjh.css"]);t.PageletMaestroHeader=h}),define("modules/clean/react/maestro/layout",["require","exports","tslib","external/react","spectrum/match","modules/clean/react/maestro/header","modules/clean/react/maestro/secondary_sidebar","modules/clean/react/maestro/a11y_constants","modules/clean/react/maestro/responsive"],function(e,t,r,n,s,o,i,a,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=(function(e){function t(t){var r=e.call(this,t)||this;r.isPageResponsive=function(){return!(!document||!document.documentElement)&&document.documentElement.classList.contains(c.RESPONSIVE_CLASS)},r.handleSetup=function(){r.setState({setupComplete:!0})},r.handleMatchMedium=function(){r.setState({isMatchedMedium:!0})},r.handleUnmatchMedium=function(){r.setState({isMatchedMedium:!1})},r.handleMatchLarge=function(){r.setState({isMatchedLarge:!0})},r.handleUnmatchLarge=function(){r.setState({isMatchedLarge:!1})};var n=r.isPageResponsive();return r.state={isResponsive:n,isMatchedMedium:!n,isMatchedLarge:!n,setupComplete:!n},r}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.user,l=e.titleRegion,_=e.titleClass,u=e.embeddedAppRegion,p=e.actionSidebarRegion,d=e.searchBarProps,h=this.state,E=h.setupComplete,m=r.__rest(h,["setupComplete"]);return n.createElement("div",{className:"maestro-chrome"},m.isResponsive&&n.createElement(s.Match,{media:c.BREAKPOINT_LARGE,onSetup:this.handleSetup,onMatch:this.handleMatchLarge,onUnmatch:this.handleUnmatchLarge}),m.isResponsive&&n.createElement(s.Match,{media:c.BREAKPOINT_MEDIUM,onSetup:this.handleSetup,onMatch:this.handleMatchMedium,onUnmatch:this.handleUnmatchMedium}),E&&n.createElement(o.PageletMaestroHeader,r.__assign({user:t,title:l,titleClass:_,responsive:m},d||{})),E&&n.createElement("main",{className:"maestro-app"},n.createElement("div",{className:"maestro-app-content",tabIndex:a.LAYOUT_TAB_ORDER.MAIN_CONTENT},"function"==typeof u?u(m):u),p&&n.createElement("div",{className:"maestro-secondary-sidebar__shadow",tabIndex:a.LAYOUT_TAB_ORDER.SIDE_BAR},n.createElement(i.MaestroSecondarySidebar,{responsive:m},"function"==typeof p?p(m):p))))},t})(n.PureComponent);t.MaestroChrome=l}),define("modules/clean/react/maestro/responsive",["require","exports","tslib","external/react","spectrum/vertically_fixed"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RESPONSIVE_CLASS="maestro--responsive",t.BREAKPOINT_MEDIUM="(min-width: 736px)",t.BREAKPOINT_LARGE="(min-width: 1025px)";var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.responsive,o=r.__rest(e,["responsive"]),i=t&&t.isResponsive?"div":s.VerticallyFixed;return n.createElement(i,o)},t.displayName="VerticallyFixedWrapper",t
})(n.Component);t.VerticallyFixedWrapper=o}),define("modules/clean/react/maestro/secondary_sidebar",["require","exports","tslib","external/react","external/classnames","modules/clean/react/maestro/responsive","modules/clean/react/prompt/ha","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s,o,i,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.state={},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;a.promptBufferedEventEmitter.on(a.Events.ON_HA_LOADED,function(t){e.setState({haProps:t})})},t.prototype.render=function(){var e=s({"maestro-secondary-sidebar":!0,"has-inline-ha":!!this.state.haProps});return n.createElement(o.VerticallyFixedWrapper,{responsive:this.props.responsive,className:e},this.props.children,n.createElement(i.MaestroSecondarySidebarHA,{haProps:this.state.haProps}))},t})(n.Component);t.MaestroSecondarySidebar=c}),define("modules/clean/react/maestro/top_menu_container",["require","exports","tslib","external/react","external/lodash","modules/clean/browse_uri_interface","modules/clean/filepath","modules/clean/react/browse/models","modules/core/browser","modules/clean/search/search_bar/controller","modules/clean/search/search_bar/log_helper","modules/clean/search/search_helpers","modules/core/uri","modules/clean/react/css","modules/clean/web_user_action_events"],function(e,t,r,n,s,o,i,a,c,l,_,u,p,d,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onSearch=function(e){var r=e.query,n=e.searchToken,s=e.searchSessionId,o=e.searchPath,i=e.qargs,a=t.props.user;r&&c.redirect(u.buildSearchURL({user:a,searchPath:o,normalizedQuery:r,searchSessionId:s,searchToken:n,qargs:i}).toString())},t.onSlimSearchResultOpen=function(e){var r=t.props.user;if(e instanceof a.Paper||e instanceof a.PaperFolder)c.open_tab(e.url);else{var n=e;if(n.is_dir){var s=new p.URI({path:"/"+r.role+n.fq_path});c.open_tab(s.toString())}else{var o=n.fq_path.substring(1),s=new p.URI({path:"/"+r.role}).updateQuery({preview:o});c.open_tab(s.toString())}}},t.logSearchResultOpen=function(e){var r=t.props.user;e instanceof a.File?_.logDropdownSearchAction({result:e,user:r,action_type:e.is_dir?h.WebUserActionLogEvent.FOLDER_OPEN:h.WebUserActionLogEvent.FILE_VIEW,viewport:"top-menu-dropdown-view"}):(e instanceof a.Paper||e instanceof a.PaperFolder)&&_.logDropdownSearchAction({result:e,user:r,action_type:h.WebUserActionLogEvent.PAPER_OPEN,viewport:"top-menu-dropdown-view"})},t.onResultObjectPathClick=function(e){var r=t.props.user;_.logDropdownSearchAction({result:e,user:r,action_type:h.WebUserActionLogEvent.CLICK_PATH_LINK,viewport:"dropdown-view"});var n=i.parent_dir(e.fq_path),s=o.browse_uri_for_fq_path(r,n||"").toString();c.open_tab(s)},t}return r.__extends(t,e),t.prototype.renderSearchBar=function(){return this.props.showSearchBar&&this.props.user?n.createElement(l.SearchBarController,{user:this.props.user,currentPath:this.props.currentPath,isExpanded:this.props.isSearchBarExpanded,onSearch:this.props.onSearch||this.onSearch,onCancelSearch:this.props.onCancelSearch,onSearchResultOpen:this.props.onSearchResultOpen||this.logSearchResultOpen,onSlimSearchResultOpen:this.props.onSearchResultOpen?void 0:this.onSlimSearchResultOpen,onResultObjectPathClick:this.props.onResultObjectPathClick||this.onResultObjectPathClick,searchBarExperiments:this.props.searchBarExperiments||{},onSearchFiltersChanged:this.props.onSearchFiltersChanged||s.noop}):null},t.prototype.renderRightContent=function(){return this.props.rightContent?this.props.rightContent:n.createElement("div",{className:"top-menu-container--search-bar-empty-space"})},t.prototype.render=function(){return n.createElement("div",{className:"top-menu-container "+this.props.classNames},this.renderSearchBar(),this.renderRightContent())},t.defaultProps={showSearchBar:!0,isSearchBarExpanded:!1,classNames:"",currentPath:"/"},t})(n.Component);t.TopMenuContainer=d(E,["/static/css/pagelet-vflBp79rc.css"],[l.SearchBarController])}),define("modules/clean/react/prompt/button",["require","exports","tslib","external/classnames","external/purify","external/react","modules/core/cookies","modules/clean/prompt/api/rendering"],function(e,t,r,n,s,o,i,a){"use strict";function c(e){return e?{__html:s.sanitize(e)}:void 0}function l(e){function t(){return e.campaign.content.confirmText?o.createElement(_,{className:"button-primary",confirmInNewTab:e.campaign.content.confirmInNewTab,confirmIsPost:e.confirmIsPost,confirmUrl:e.confirmUrl,onConfirm:e.onConfirm,html:e.campaign.content.confirmText}):null}function r(){var t=e.campaign,r=e.onRemindMeLater;return a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&r?o.createElement(u,{className:"remind-me-later cancel-button button-tertiary",onDismiss:r,html:t.content.remindMeLaterText}):null}function s(){var t=e.campaign,r=e.onDismiss,s=e.onRemindMeLater,i={"cancel-button":!0};return t.content.cancelText?(a.isHomeModalContent(t.content)&&t.content.remindMeLaterText&&s?i["cancel-link"]=!0:i["button-tertiary"]=!0,o.createElement(u,{className:n(i),onDismiss:r,html:t.content.cancelText||void 0})):null}return o.createElement("div",{className:"upsell-buttons"},t(),r(),s())}Object.defineProperty(t,"__esModule",{value:!0}),t.sanitizeOptionalHTML=c;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n(this.props.className,{"confirm-button":!0,enabled:!0});if(this.props.confirmIsPost){var t=i.Cookies.read("__Host-js_csrf");return o.createElement("form",{className:"form-button-primary",action:this.props.confirmUrl,method:"POST",target:this.getTarget(),onSubmit:this.props.onConfirm},o.createElement("input",{type:"hidden",name:"t",value:t}),o.createElement("button",{type:"submit",className:e,dangerouslySetInnerHTML:c(this.props.html)},this.props.children))}return o.createElement("a",{href:this.props.confirmUrl,className:e,target:this.getTarget(),dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onConfirm},this.props.children)},t.prototype.getTarget=function(){return this.props.confirmInNewTab?"_blank":"_self"},t})(o.Component);t.ConfirmButton=_;var u=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=n(this.props.className,{"dismiss-button":!0,enabled:!0});return o.createElement("a",{href:"#",className:e,dangerouslySetInnerHTML:c(this.props.html),onClick:this.props.onDismiss},this.props.children)},t})(o.Component);t.DismissButton=u,t.PromptButtons=l}),define("modules/clean/react/prompt/campaign_state_manager",["require","exports","tslib","modules/core/uri","modules/clean/react/prompt/version","modules/clean/upsell/prompt_event_logger"],function(e,t,r,n,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROMPT_CONFIRM_ENDPOINT_URL="/prompt/confirm_v2";var i=(function(){function e(e){var n=this;this.buildConfirmEndpointURI=function(e){if(e=e||n.getConfirmUrlFromContent(),!e||"#"===e)return"#";var r=n.eventLogger.getUpsellControllerURI(t.PROMPT_CONFIRM_ENDPOINT_URL),s=n.component.props.campaign.content.confirmIsPost,o=n.getRedirectURL(e);return o&&r.updateQuery({redirect_url:o}),s&&r.updateQuery({preserve_post:"1"}),r.toString()},this.shouldConfirmUsingPost=function(){var e=n.getConfirmUrlFromContent();return!!(e&&"#"!==e||n.component.props.campaign.content.confirmIsPost)},this.onShow=function(){n.component.state.isShown||(n.component.setState(function(e){return r.__assign({},e,{isShown:!0})}),n.eventLogger.triggerExternalEvent("db:prompt:show"),n.eventLogger.recordClientImpression())},this.onConfirm=function(e){n.isAckInProgress()||(n.component.setState(function(e){return r.__assign({},e,{isConfirmed:!0})}),n.eventLogger.triggerExternalEvent("db:prompt:pre-confirm"),n.ensureConfirmIsRecorded(e))},this.isHTMLAnchorElement=function(e){return void 0!==e.href},this.isHTMLFormElement=function(e){return void 0!==e.action},this.onDismiss=function(e,t){n.isAckInProgress()||(n.component.setState(function(e){return r.__assign({},e,{isDismissed:!0})}),e.preventDefault(),n.eventLogger.triggerExternalEvent("db:prompt:pre-dismiss"),n.eventLogger.recordDismiss(t&&t.remindMeLater))},this.enhanceHTMLButtons=function(e,t){var r=void 0===t?{}:t,s=r.confirmButtonSelector,o=void 0===s?".confirm-button":s,i=r.dismissButtonSelector,a=void 0===i?".dismiss-button":i,c=r.onConfirmOverride,l=void 0===c?void 0:c,_=r.onDismissOverride,u=void 0===_?void 0:_;if(e){for(var p=null,d=e.querySelectorAll(o),h=e.querySelectorAll(a),E=0;E<d.length;E++)p=d[E],n.mayEnhanceButton(p)&&(p.href=n.buildConfirmEndpointURI(p.getAttribute("href")),p.target=n.component.props.campaign.content.confirmInNewTab?"_blank":"_self",p.addEventListener("click",l||n.onConfirm));for(var E=0;E<h.length;E++)p=h[E],n.mayEnhanceButton(p)&&p.addEventListener("click",u||n.onDismiss)}},this.component=e,this.eventLogger=new o.PromptEventLogger(this.component.props)}return e.prototype.getConfirmUrlFromContent=function(){var e=this.component.props.campaign.content;return s.isTopNotificationContent(e)?e.buttonUrl:e.confirmUrl},e.prototype.getRedirectURL=function(e){if(e){if(this.component.props.campaign.addTkParams){var t=n.URI.parse(e),r=this.component.props.campaign.versionId;return null==r&&(r=this.component.props.campaign.campaignId),t.updateQuery({_tk:this.component.props.campaign.campaignLocationTkId,_camp:r.toString()}),t.toString()}return e}},e.prototype.ensureConfirmIsRecorded=function(e){if(!this.eventWillRecordConfirm(e)){this.eventLogger.recordConfirm();var t=this.getEventHrefOrAction(e);t&&"#"!==t||e.preventDefault()}},e.prototype.eventWillRecordConfirm=function(e){return(this.getEventHrefOrAction(e)||"").indexOf(t.PROMPT_CONFIRM_ENDPOINT_URL)>-1},e.prototype.getEventHrefOrAction=function(e){var t=null,r=e.currentTarget;return r&&this.isHTMLAnchorElement(r)?t=r.getAttribute("href"):r&&this.isHTMLFormElement(r)&&(t=r.getAttribute("action")),t},e.prototype.mayEnhanceButton=function(e){return!e.classList.contains("prompt-enhanced")&&(e.classList.add("prompt-enhanced"),!0)},e.prototype.isAckInProgress=function(){return this.component.state.isConfirmed||this.component.state.isDismissed},e})();t.CampaignStateManager=i}),define("modules/clean/react/prompt/ha",["require","exports","tslib","jquery","external/classnames","external/lodash","external/react","external/react-dom","modules/clean/react/prompt/legacy_ha_wrapper","modules/clean/react/css","modules/clean/react/sprite","modules/clean/upsell/prompt_event_emitter","modules/clean/react/prompt/button","modules/clean/react/prompt/image","modules/clean/react/prompt/prompt_location","modules/core/i18n"],function(e,t,r,n,s,o,i,a,c,l,_,u,p,d,h,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m;(function(e){e[e.HIDE=1]="HIDE",e[e.NO_IMAGE=2]="NO_IMAGE",e[e.SHOW=3]="SHOW"})(m=t.ShowState||(t.ShowState={})),t.UPDATE_STATE_PERIODIC_INTERVAL=1e3;var S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.renderImage=function(){var e=this.props.content;return e.imageUrl?i.createElement(p.ConfirmButton,{className:"confirm-button--illustration",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,onConfirm:this.props.onConfirm},i.createElement(d.Image,{src:e.imageUrl,srcHiRes:e.imageUrlHiRes,alt:e.confirmText,onLoad:this.props.onImageLoad})):null},t.prototype.renderText=function(){var e=this.props.content;return i.createElement("p",null,i.createElement(p.ConfirmButton,{confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.text,onConfirm:this.props.onConfirm}))},t.prototype.renderConfirmButton=function(){var e=this.props.content;return e.confirmText?i.createElement(p.ConfirmButton,{className:"button",confirmInNewTab:e.confirmInNewTab,confirmIsPost:this.props.confirmIsPost,confirmUrl:this.props.confirmUrl,html:e.confirmText,onConfirm:this.props.onConfirm}):null},t.prototype.renderDismissButton=function(){return i.createElement(p.DismissButton,{onDismiss:this.props.onDismiss,"aria-label":E._("Close")},i.createElement(_.Sprite,{group:"web",name:"close_small",alt:E._("Close")}))},t.prototype.render=function(){var e=this.props.isDismissed,t=s({ha:!0,"no-image":!e&&this.props.showState===m.NO_IMAGE,visible:!e&&this.props.showState===m.SHOW,invisible:this.props.isInvisible});return i.createElement("div",{className:t},this.renderImage(),this.renderText(),this.renderConfirmButton(),this.renderDismissButton())},t.displayName="HARendererWithoutCSS",t})(i.Component);t.HARendererWithoutCSS=S,t.HARendererWithCSS=l(S,["/static/css/upsell/prompt_pagelet-vflzdH6PS.css"]);var f=(function(e){function s(t){var r=e.call(this,t,{cloneShowState:m.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:m.HIDE,topOffsetToFit:0})||this;return r.setHaRef=function(e){r.ha=e},r.setHaCloneRef=function(e){r.haClone=e},r.onPageUpdate=r.onPageUpdate.bind(r),r}return r.__extends(s,e),s.prototype.componentDidMount=function(){this.onUpdate(),n(window).resize(this.onPageUpdate),u.eventEmitter.addListener(u.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),this.intervalID=setInterval(this.onPageUpdate,t.UPDATE_STATE_PERIODIC_INTERVAL)},s.prototype.componentWillUnmount=function(){n(window).off("resize",this.onPageUpdate),u.eventEmitter.off(u.Events.REACT_HA_DID_UPDATE,this.onPageUpdate),clearInterval(this.intervalID)},s.prototype.componentDidUpdate=function(){this.onUpdate()},s.prototype.onPageUpdate=function(){this.setState(function(e){return e.cloneShowState=m.SHOW,e})},s.prototype.onUpdate=function(){var e=this;if(this.state.cloneShowState>m.HIDE&&this.canFit())this.state.showState!==this.state.cloneShowState&&this.setState(function(e){return e.showState=e.cloneShowState,e},function(){e.state_manager.onShow()});else{var t=this.state.cloneShowState-1;t>m.HIDE?this.setState(function(e){return e.cloneShowState=t,e}):this.state.showState!==m.HIDE&&this.setState(function(e){return e.showState=m.HIDE,e})}},s.prototype.render=function(){return i.createElement("div",null,i.createElement(t.HARendererWithCSS,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.createElement(t.HARendererWithCSS,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},s.prototype.canFit=function(){var e=this.getMenuHeight();if(null===e)return!1;var t=this.getHAHeight();return null!==t&&e+t<=this.getWindowHeight()},s.prototype.getHAHeight=function(){var e=n(a.findDOMNode(this.haClone));if(0===e.length)return null;return e.outerHeight()+75},s.prototype.getMenuHeight=function(){var e=n(".maestro-secondary-sidebar, .appactions-menu").first();if(0===e.length)return null;var t=e.children(),r=e.offset().top-n(document).scrollTop();return t.each(function(e,t){r+=n(t).outerHeight(!0)}),r},s.prototype.getWindowHeight=function(){return n(window).height()},s})(h.PromptLocation);t.HA=f;var C=(function(e){function s(t){var r=e.call(this,t,{cloneShowState:m.SHOW,isConfirmed:!1,isDismissed:!1,isShown:!1,showState:m.HIDE,topOffsetToFit:0})||this;return r.onWindowResize=o.debounce(function(){r.onPageUpdate()},250),r.setHaRef=function(e){r.ha=e},r.setHaCloneRef=function(e){r.haClone=e},r.onPageUpdate=r.onPageUpdate.bind(r),r}return r.__extends(s,e),s.prototype.componentDidMount=function(){this.onUpdate(),window.addEventListener("resize",this.onWindowResize),this.intervalID=setInterval(this.onPageUpdate,t.UPDATE_STATE_PERIODIC_INTERVAL)},s.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.onWindowResize),clearInterval(this.intervalID)},s.prototype.componentDidUpdate=function(){this.onUpdate()},s.prototype.onPageUpdate=function(){this.setState({cloneShowState:m.SHOW})},s.prototype.onUpdate=function(){var e,t=this;if(this.state.cloneShowState>m.HIDE&&(e=this.getTopOffsetToFit())>-1)this.state.showState===this.state.cloneShowState&&this.state.topOffsetToFit===e||this.setState({showState:this.state.cloneShowState,topOffsetToFit:e},function(){t.state_manager.onShow()});else{var r=this.state.cloneShowState-1;r>m.HIDE?this.setState({cloneShowState:r}):this.state.showState!==m.HIDE&&this.setState({showState:m.HIDE})}},s.prototype.render=function(){return i.createElement("div",{className:"inline-ha-wrapper",style:{top:this.state.topOffsetToFit}},i.createElement(t.HARendererWithCSS,{isInvisible:!1,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,ref:this.setHaRef,showState:this.state.showState}),i.createElement(t.HARendererWithCSS,{isInvisible:!0,content:this.props.campaign.content,confirmUrl:this.state_manager.buildConfirmEndpointURI(),confirmIsPost:this.state_manager.shouldConfirmUsingPost(),isDismissed:this.state.isDismissed,onConfirm:this.state_manager.onConfirm,onDismiss:this.state_manager.onDismiss,onImageLoad:this.onPageUpdate,ref:this.setHaCloneRef,showState:this.state.cloneShowState}))},s.prototype.getTopOffsetToFit=function(){var e=this.getHAHeight();if(null===e)return-1;var t=this.getMenuHeight();return null===t?-1:this.getWindowHeight()-t-e},s.prototype.getHAHeight=function(){var e=n(a.findDOMNode(this.haClone));return 0===e.length?null:e.outerHeight(!0)},s.prototype.getMenuHeight=function(){var e=n(".maestro-secondary-sidebar, .appactions-menu").first();if(0===e.length)return null;var t=e.children(":not(.inline-ha-wrapper)"),r=e.offset().top-n(document).scrollTop();return t.each(function(e,t){"none"!==getComputedStyle(t).display&&(r+=n(t).outerHeight(!0))}),r},s.prototype.getWindowHeight=function(){return n(window).height()},s})(h.PromptLocation);t.InlineHA=C;var g=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){return this.props.campaign.delegateRendering?(u.promptBufferedEventEmitter.emit(u.Events.ON_HA_LOADED,this.props),null):i.createElement(f,r.__assign({},this.props))},t})(h.PromptLocation);t.DelegatingHARenderer=g,t.MaestroSecondarySidebarHA=function(e){return e.haProps?i.createElement(C,r.__assign({},e.haProps)):i.createElement(c.LegacyHAWrapper,null)}}),define("modules/clean/react/prompt/image",["require","exports","tslib","external/react"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.srcHiRes?this.props.srcHiRes+" 2x":"";return n.createElement("img",{src:this.props.src,srcSet:e,alt:this.props.alt,onLoad:this.props.onLoad})},t})(n.Component);t.Image=s}),define("modules/clean/react/prompt/legacy_ha_wrapper",["require","exports","tslib","external/react","modules/clean/upsell/prompt_event_emitter"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.emitUpdateEvent=function(){s.eventEmitter.emit(s.Events.REACT_HA_DID_UPDATE)},t.prototype.componentDidMount=function(){t.emitUpdateEvent()},t.prototype.componentDidUpdate=function(){t.emitUpdateEvent()},t.prototype.render=function(){return n.createElement("div",null)},t.displayName="LegacyHAWrapper",t})(n.Component);t.LegacyHAWrapper=o}),define("modules/clean/react/prompt/prompt_location",["require","exports","tslib","external/react","modules/clean/react/prompt/campaign_state_manager"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(t,r){var n=e.call(this,t)||this;return n.state=r,n.state_manager=new s.CampaignStateManager(n),n}return r.__extends(t,e),t})(n.Component);t.PromptLocation=o;var i=(function(e){function t(t){return e.call(this,t,{isConfirmed:!1,isDismissed:!1,isShown:!1})||this}return r.__extends(t,e),t})(o);t.PromptLocationWithDefaultState=i}),define("modules/clean/react/prompt/version",["require","exports"],function(e,t){"use strict";function r(e){var t=e;return void 0!==t.buttonText&&void 0!==t.buttonUrl}Object.defineProperty(t,"__esModule",{value:!0}),t.isTopNotificationContent=r}),define("modules/clean/search/api_helpers",["require","exports"],function(e,t){"use strict";function r(){return(new Date).getTimezoneOffset()}Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrentTimezoneOffset=r}),define("modules/clean/search/constants",["require","exports","modules/clean/search/types"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxResults={MAX_SEARCH_SUGGESTIONS:8,MAX_SEARCH_RESULTS:100},t.FOCUS_SEARCH_BAR_ACTION="search__FOCUS_SEARCH_BAR",t.BLUR_SEARCH_BAR_ACTION="search__BLUR_SEARCH_BAR",t.SET_SEARCH_QUERY_ACTION="search__SET_SEARCH_QUERY",t.SET_SEARCH_SUGGESTIONS_ACTION="search__SET_SEARCH_SUGGESTIONS",t.SET_SLIM_SEARCH_SUGGESTIONS_ACTION="search__SET_SLIM_SEARCH_SUGGESTIONS",t.SET_HIGHLIGHTED_ROW_ACTION="search__SET_HIGHLIGHTED_ROW",t.HIGHLIGHT_PREVIOUS_ROW_ACTION="search__HIGHLIGHT_PREVIOUS_ROW",t.HIGHLIGHT_NEXT_ROW_ACTION="search__HIGHLIGHT_NEXT_ROW",t.CLEAR_SEARCH_BAR_ACTION="search__CLEAR_SEARCH_BAR",t.SEARCH_SUCCESSFUL_ACTION="search__SEARCH_SUCCESSFUL",t.CLEAR_ALL_HISTORY_ACTION="search__CLEAR_ALL_HISTORY",t.START_SEARCH_ACTION="search__START_SEARCH",t.SET_SEARCH_RESULTS_ACTION="search__SET_SEARCH_RESULTS",t.CONTINUE_SEARCH_ACTION="search__CONTINUE_SEARCH",t.APPEND_SEARCH_RESULTS_ACTION="search__APPEND_SEARCH_RESULTS",t.SET_FULL_SEARCH_RESULTS_ACTION="search__SET_FULL_SEARCH_RESULTS_ACTION",t.CLEAR_SEARCH_ACTION="search__CLEAR_SEARCH",t.SET_SEARCH_SELECTION_ACTION="search__SET_SEARCH_SELECTION",t.CHANGE_FILES_ACTION="search__CHANGE_SEARCH_FILES",t.SET_SCOPE_CHIP_ACTION="search__SET_SCOPE_CHIP_ACTION",t.SET_FILE_TYPE_FILTER_ACTION="search__SET_FILE_TYPE_FILTER_ACTION",t.ADMIN_CONSOLE_SEARCH_ENDPOINT="/search/admin_console_search",t.FULLTEXT_SEARCH_ENDPOINT="/ajax_fulltext_search",t.PARTIAL_SEARCH_FRONTEND_SERVICE_ENDPOINT="/search/full_search_result",t.SEARCH_METADATA_ENDPOINT="/search/search_metadata",t.FILE_INFO_ENDPOINT="/browse_file_info";(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_ADDITIONAL_PAGE="LOADING_ADDITIONAL_PAGE"})(t.SearchLoadingState||(t.SearchLoadingState={})),t.SEARCH_RECENT_HISTORY_CAPACITY=5,t.SEARCH_RECENT_HISTORY_STORAGE_KEY="search_recent_history",t.FILE_CATEGORIES_UNCHECKED=(n={},n[r.FileCategory.IMAGE]="unchecked",n[r.FileCategory.DOCUMENT]="unchecked",n[r.FileCategory.PDF]="unchecked",n[r.FileCategory.SPREADSHEET]="unchecked",n[r.FileCategory.PRESENTATION]="unchecked",n[r.FileCategory.AUDIO]="unchecked",n[r.FileCategory.VIDEO]="unchecked",n[r.FileCategory.FOLDER]="unchecked",n[r.FileCategory.PAPER]="unchecked",n[r.FileCategory.OTHER]="unchecked",n);var n}),define("modules/clean/search/logger",["require","exports","tslib","modules/clean/analytics","modules/clean/search/api_helpers","modules/clean/react/browse/logger_util"],function(e,t,r,n,s,o){"use strict";function i(e){var t=e.searchSessionId,i=e.result,a=e.user,c=e.action_type,l=e.search_type,_=e.viewport,u=void 0===_?"full-view":_,p=e.view_type,d=(e.latency,e.displayed,s.getCurrentTimezoneOffset()),h={viewport:u,action_type:c,search_type:l,search_session_id:t,view_type:p,position:i.sort_rank,request_id:i.request_id,timezone_offset:d};if(o.isFile(i)){var E=i;h=r.__assign({},h,{file_nsid:E.ns_id,file_sjid:E.sjid,match_type:E.match_type})}else if(o.isPaper(i)){var m=i;h=r.__assign({},h,{paper_pad_id:m.pad_id,position:m.sort_rank,request_id:m.request_id})}else if(o.isPaperFolder(i)){var S=i;h=r.__assign({},h,{paper_folder_id:S.folder_id,position:S.sort_rank,request_id:S.request_id})}n.SearchClientActivityLogger.log("result_action",a.id,h)}function a(e){var t=e.searchSessionId,r=e.user,o=e.history,i=s.getCurrentTimezoneOffset(),a=o.map(function(e){return e.rawQuery}).reduce(function(e,t,r){return e[r]=t,e},{}),c={search_session_id:t,recent_history_map:JSON.stringify(a),timezone_offset:i,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_history_displayed",r.id,c)}function c(e){var t=e.searchSessionId,r=e.user,o=s.getCurrentTimezoneOffset(),i={search_session_id:t,timezone_offset:o,viewport:"dropdown-view"};n.SearchClientActivityLogger.log("recent_history_cleared",r.id,i)}function l(e){var t=e.searchSessionId,r=e.query,o=e.user,i=e.rank,a=e.action_type,c=s.getCurrentTimezoneOffset(),l={search_session_id:t,query_string:r.rawQuery,position:i,timezone_offset:c,viewport:"dropdown-view",action_type:a};n.SearchClientActivityLogger.log("recent_query_selected",o.id,l)}function _(e){var t=e.searchSessionId,r=e.requestId,o=e.query,i=e.user,a=e.previousPosition,c=e.viewport,l=void 0===c?"dropdown-view":c,_=s.getCurrentTimezoneOffset(),u={search_session_id:t,request_id:r,query_string:o.rawQuery,position:a,timezone_offset:_,viewport:l};n.SearchClientActivityLogger.log("recent_query_stored",i.id,u)}function u(e){var t=e.searchSessionId,r=e.user,o=e.chipAdded,i=e.filePath,a=e.searchType,c=e.viewport,l=s.getCurrentTimezoneOffset(),_={search_session_id:t,timezone_offset:l,path_scoped:o,file_path:i,viewport:c,search_type:a};n.SearchClientActivityLogger.log("scope_chip_changed",r.id,_)}function p(e){var t=e.searchSessionId,r=e.user,o=e.deletedFiles,i=e.searchType,a=e.viewport,c=s.getCurrentTimezoneOffset(),l={search_session_id:t,timezone_offset:c,deleted_filter:o,viewport:a,search_type:i};n.SearchClientActivityLogger.log("deleted_filter_changed",r.id,l)}function d(e){var t=e.searchSessionId,r=e.user,o=s.getCurrentTimezoneOffset(),i={search_session_id:t,timezone_offset:o};n.SearchClientActivityLogger.log("search_bar_focus_lost",r.id,i)}function h(e,t){var n=e;return r.__assign({},t,{file_nsid:n.ns_id,file_sjid:n.sjid,match_type:n.match_type||void 0})}function E(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=s.getCurrentTimezoneOffset(),_={search_session_id:t,preview_request_id:i,timezone_offset:l,viewport:c};n.SearchClientActivityLogger.log("preview_started",o.id,h(r,_))}function m(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=e.latency,_=e.displayed,u=s.getCurrentTimezoneOffset(),p={search_session_id:t,preview_request_id:i,timezone_offset:u,viewport:c,latency:l,displayed:_?"true":"false"};n.SearchClientActivityLogger.log("preview_completed",o.id,h(r,p))}function S(e){var t=e.searchSessionId,r=e.result,o=e.user,i=e.previewRequestId,a=e.viewport,c=void 0===a?"dropdown-view":a,l=e.failureType,_=s.getCurrentTimezoneOffset(),u={search_session_id:t,preview_request_id:i,timezone_offset:_,viewport:c,failure_type:l};n.SearchClientActivityLogger.log("preview_failed",o.id,h(r,u))}Object.defineProperty(t,"__esModule",{value:!0}),t.logSearchAction=i,t.logRecentHistoryDisplayed=a,t.logRecentHistoryCleared=c,t.logRecentQuerySelected=l,t.logRecentQueryStored=_,t.logScopeChipChanged=u,t.logDeletedFilterChanged=p,t.logSearchBarFocusLost=d,t.logHoverPreviewStarted=E,t.logHoverPreviewCompleted=m,t.logHoverPreviewFailed=S}),define("modules/clean/search/models",["require","exports","external/deep-freeze","modules/clean/react/browse/models"],function(e,t,r,n){"use strict";function s(e){return new n.BrowseContext({isInFolderMode:e.inside_dir,inactiveNSIDByFQPath:e.old_path_to_ns_id,blockHash:e.block_hash})}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){this.fq_path=e.fq_path,this.is_unmounted=e.is_unmounted,this.icon=e.icon,this.filename_highlights=e.filename_highlights,this.highlight_spans=e.highlight_spans,this.ns_id=e.ns_id,this.sjid=e.sjid,this.is_dir=e.is_dir,this.is_symlink=e.is_symlink,this.type=e.type,this.ns_path=e.ns_path,this.match_type=e.match_type,this._mount_access_perms=e.mount_access_perms,this.thumbnail_url_tmpl=e.thumbnail_url_tmpl,this.hover_preview_url=e.hover_preview_url,this.request_id=e.request_id,this.sort_rank=e.sort_rank,r(this)}return e.fromServerObject=function(t){return new e(t)},e})();t.SlimFileSearchResult=o,t.extractBrowseContext=s}),define("modules/clean/search/search_bar/api",["require","exports","tslib","modules/clean/ajax","modules/clean/filepath","modules/clean/search/constants","modules/clean/analytics","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/clean/search/api_helpers"],function(e,t,r,n,s,o,i,a,c,l,_){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(function(e){function t(t){var r=this.constructor,n=this,s=r.prototype;return n=e.call(this,t)||this,n.__proto__=s,n}return r.__extends(t,e),t})(Error);t.RequestAbortedError=u;var p=(function(){function e(){this._searchApiUrl="/search/dropdown_search",this._activeRequest=null}return e.prototype.getSearchApiUrl=function(){return this._searchApiUrl},e.prototype.abortPreviousLoading=function(){null!=this._activeRequest&&this._activeRequest.abort()},e.prototype._extractSlimSearchResultsList=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var s=n[r];switch(s.search_result_type){case c.SearchResultTypes.FILE:t.push(l.SlimFileSearchResult.fromServerObject(s));break;case c.SearchResultTypes.PAPER:t.push(a.Paper.fromServerObject(s));break;case c.SearchResultTypes.PAPER_FOLDER:t.push(a.PaperFolder.fromServerObject(s))}}return t},e.prototype.loadSlimResults=function(e){var t=e.user,r=e.path,n=e.query,s=e.searchSessionId,o=e.experiments,i=e.webTimer,a=_.getCurrentTimezoneOffset(),c=o.expPaperFolders,l=o.expShowSymlinkIcon,u={query:n,fq_path:r,timezone_offset:a,show_paper_folder_results:c,show_symlink_icon:l,search_session_id:s};return this._fetchSlimResults(u,t,s,i)},e.prototype.fetchAdditionalFileMetadata=function(e){var t=this,r=e.searchResults,s=e.user,i=e.useFileInfoEndpoint;return new Promise(function(e,a){var c=r.filter(function(e){return e instanceof l.SlimFileSearchResult}),_=c.map(function(e){return[e.ns_id,e.sjid]}),p=c.map(function(e){return[e.ns_id,e.sjid,e.fq_path.substr(0,e.fq_path.length-e.ns_path.length)]});_.length>0?n.WebRequest({url:i?o.FILE_INFO_ENDPOINT:o.SEARCH_METADATA_ENDPOINT,data:i?{nsid_sjid_fq_mount_point_tuples:JSON.stringify(p)}:{nsid_sjid_pairs:JSON.stringify(_)},dataType:"json",subject_user:s,success:function(n,s,o){var a=i?n.file_results:n.search_results;e(t._mergeFullResultsIntoSlimResults(a,r,i))},error:function(e,t,r){a("abort"===r?new u:new Error(r))}}):e(r)})},e.prototype._mergeFullResultsIntoSlimResults=function(e,t,n){for(var o=[],i=function(t){if(t instanceof l.SlimFileSearchResult){var i=e.find(function(e){return e.search_result_type===c.SearchResultTypes.FILE&&s.paths_are_equal(e.fq_path,t.fq_path)});i&&(n?o.push(a.File.fromServerObject(r.__assign({},t,i))):o.push(a.File.fromServerObject(r.__assign({},i,{request_id:t.request_id,sort_rank:t.sort_rank,match_type:t.match_type}))))}else(t instanceof a.Paper||t instanceof a.PaperFolder)&&o.push(t)},_=0,u=t;_<u.length;_++){i(u[_])}return o},e.prototype._fetchSlimResults=function(e,t,r,s){var o=this;return new Promise(function(a,c){var _;null!=o._activeRequest&&o._activeRequest.abort();var p={
path_scoped:"/"!==e.fq_path,search_type:"dropdown",query_string:e.query,search_session_id:r,timezone_offset:e.timezone_offset};i.SearchClientActivityLogger.log("query_started",t.id,p);var d=(new Date).getTime();o._activeRequest=n.WebRequest({url:o._searchApiUrl,data:e,dataType:"json",subject_user:t,success:function(n,c,_){for(var u=l.extractBrowseContext(n),h=n.search_results,E=_.getResponseHeader("x-dropbox-request-id"),m=0,S=0,f=h;S<f.length;S++){var C=f[S];C.request_id=E,C.sort_rank=m++}var g=o._extractSlimSearchResultsList(h),A=i.SearchClientActivityLogger.create_search_log_dict(p,E,d,e.query,g.length,null,r);i.SearchClientActivityLogger.log("query_completed",t.id,A),s&&s.end(E?E:void 0),a({context:u,searchResults:g,deleted:!1})},error:function(n,o,a){_=n.getResponseHeader("x-dropbox-request-id");var l=i.SearchClientActivityLogger.create_search_log_dict(p,_,d,e.query,null,o,r);i.SearchClientActivityLogger.log("query_failed",t.id,l),s&&s.abort(),c("abort"===a?new u:new Error(a))},complete:function(){this._activeRequest=null}})})},e})();t.SearchBarApiClient=p,t.searchBarApiClient=new p}),define("modules/clean/search/search_bar/chips",["require","exports","modules/clean/filepath"],function(e,t,r){"use strict";function n(e){return r.paths_are_equal(e,"/")}function s(e){return!!e&&!n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isScopeChipRoot=n,t.isValidPathForChip=s}),define("modules/clean/search/search_bar/controller",["require","exports","tslib","external/react","external/react-redux","modules/clean/keycode","modules/clean/react/browse/models","modules/clean/search/logger","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/action_creators","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/log_helper","modules/clean/search/search_bar/view","modules/clean/search/search_helpers","modules/clean/search/search_bar/chips","modules/clean/storage","modules/clean/viewer","modules/clean/web_timing_logger","modules/clean/web_user_action_events","modules/core/notify","modules/clean/search/types","modules/clean/react/css","modules/clean/search/search_bar/experiments"],function(e,t,r,n,s,o,i,a,c,l,_,u,p,d,h,E,m,S,f,C,g,A,T,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var I=(function(e){function t(t){var r=e.call(this,t)||this;return r._searchBarWebTimer=null,r._logHistoryItemSelected=function(e,t,n){a.logRecentQuerySelected({searchSessionId:r.props.searchSessionId,query:e,user:r.props.user,rank:t-r.props.headerItems.length,action_type:n})},r._handleHistoryItemClick=function(e,t){r._logHistoryItemSelected(e,t),r._setSearchQuery(e.rawQuery)},r._handleRecentSearchContextMenuCapture=function(e,t){r._logHistoryItemSelected(e,t,C.WebUserActionLogEvent.CONTEXT_MENU)},r._handleInputChange=function(e){r._setSearchQuery(e.currentTarget.value)},r._handleCancelSearch=function(){r._setSearchQuery("")},r._handleScopeChipChange=function(e){a.logScopeChipChanged({searchSessionId:r.props.searchSessionId,user:r.props.user,chipAdded:e,searchType:"dropdown",filePath:e?r.props.browseScope:"/",viewport:r.props.isExpanded?"full-view":void 0}),e?r.props.setScopeChip({scopeChip:r.props.browseScope}):r.props.setScopeChip({}),r._setSearchQuery(r.props.rawQuery,!0)},r._handleDeletedChipChange=function(e){r.props.setDeletedChip({deletedChip:e}),r._setSearchQuery(r.props.rawQuery,!0)},r._onBrowseScopeChange=function(e){r.props.setScopeChip({scopeChip:E.isValidPathForChip(e)?e:void 0})},r._handleInputKeydown=function(e,t){if(e.keyCode===o.KeyCode.ESC){r._handleCancelSearch();var n=r.props.onCancelSearch;return void(n&&n())}if(e.keyCode===o.KeyCode.BACKSPACE&&0===t){if(!E.isScopeChipRoot(r.props.scopeChip))return void r._handleScopeChipChange(!1);if(r.props.deletedChip)return void r._handleDeletedChipChange(!1)}e.stopPropagation(),e.keyCode===o.KeyCode.UP?(e.preventDefault(),r.props.highlightPreviousRow()):e.keyCode===o.KeyCode.DOWN&&(e.preventDefault(),r.props.highlightNextRow())},r._handleSearch=function(e){r.props.onSearch({query:e,searchToken:h.getSearchCsrfToken(),searchSessionId:r.props.searchSessionId,searchPath:r.props.scopeChip,qargs:{d:R.isInDeletedFilterRightRailExperiment(r.props.searchBarExperiments)?r.props.deletedChip?"1":"0":void 0}})},r._navToSelection=function(e,t){var n=r.props.searchSuggestions[e-t],s=r.props.slimSearchSuggestions[e-t];n?(r._handleSlimSearchResultOpen(s),r._openSearchResult(n)):r._handleSearchResultOpen(s)},r._handleInputSubmit=function(e,t){e.preventDefault();var n=r.props.headerItems;if(t<n.length)switch(n[t]){case A.SearchBarDropdownHeaderItemType.SEARCH_ALL:r._handleSearch(r.props.normalizedQuery);break;case A.SearchBarDropdownHeaderItemType.SCOPE_CHIPS:var s=!E.isValidPathForChip(r.props.scopeChip);r._handleScopeChipChange(s)}else r._navToSelection(t,n.length)},r._handleContextMenuCapture=function(e){var t=r.props,n=t.user,s=t.searchSessionId,o=t.searchBarExperiments,a=o.expUseFileInfoEndpoint;h.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:n,onSuccess:function(e){r._dispatchSearchSuccessful(e.request_id||""),p.logDropdownSearchAction({result:e,user:n,action_type:e instanceof i.File?C.WebUserActionLogEvent.CONTEXT_MENU:C.WebUserActionLogEvent.PAPER_CONTEXT_MENU,viewport:"dropdown-view",searchSessionId:s})},useFileInfoEndpoint:!!a})},r._handleSlimSearchResultOpen=function(e){var t=r.props.onSlimSearchResultOpen;t&&t(e)},r._handleSearchResultOpen=function(e){var t=r.props,n=t.user,s=t.searchBarExperiments,o=s.expUseFileInfoEndpoint;r._handleSlimSearchResultOpen(e),h.fetchFullSearchResult({searchBarApiClient:c.searchBarApiClient,searchResult:e,user:n,onSuccess:function(e){r._openSearchResult(e)},onError:function(e){g.Notify.error(e)},useFileInfoEndpoint:!!o})},r._handleResultObjectPathClick=function(e){r._dispatchSearchSuccessful(e.request_id||""),r.props.onResultObjectPathClick(e)},r._handleHighlightDropdownItem=function(e){r.props.setHighlightedRow({highlightedSearchRow:e})},r._handleSearchBarFocus=function(){var e=r.props.user;r.props.focusSearchBar({user:e})},r._handleSearchBarBlur=function(){r.props.blurSearchBar()},r._dispatchSearchSuccessful=function(e){var t=r.props,n=t.user,s=t.rawQuery,o=t.normalizedQuery,i=t.searchSessionId;(0,t.addQueryToHistory)({user:n,query:{rawQuery:s,normalizedQuery:o},searchSessionId:i,requestId:e})},r._logSearchBarTTI=function(){r._searchBarWebTimer&&r._searchBarWebTimer.markTimeToInteractive()},r._handleHistoryClearAllClick=function(){var e=r.props,t=e.user;(0,e.clearAllHistory)({user:t})},t.setExperiments({experiments:t.searchBarExperiments}),r.props.setScopeChip({scopeChip:t.currentPath}),r}return r.__extends(t,e),t.prototype.componentWillMount=function(){var e=S.Viewer.get_viewer().get_users().map(function(e){return e.id});m.UserLocalStorage.clearOtherUsers(e)},t.prototype.componentWillUnmount=function(){this._logFocusLost(this.props.isFocused,!1)},t.prototype.componentWillReceiveProps=function(e){this.props.currentPath!==e.currentPath&&this._onBrowseScopeChange(e.currentPath),this.props.searchBarExperiments!==e.searchBarExperiments&&this.props.setExperiments({experiments:e.searchBarExperiments})},t.prototype.componentDidUpdate=function(e){this._logFocusLost(e.isFocused,this.props.isFocused)},t.prototype._logFocusLost=function(e,t){e&&!t&&a.logSearchBarFocusLost({user:this.props.user,searchSessionId:this.props.searchSessionId})},t.prototype._setSearchQuery=function(e,t){void 0===t&&(t=!1);var r=this.props,n=r.user,s=r.setSearchQueryAndFetchResults,o=r.searchBarExperiments;s({user:n,query:e,webTimer:this._startSearchBarTimer(),keepHighlightedRow:t}),R.isInSinglePageSearchExperiment(o)&&this._handleSearch(e)},t.prototype._openSearchResult=function(e){this._dispatchSearchSuccessful(e.request_id||""),this.props.onSearchResultOpen(e)},t.prototype._startSearchBarTimer=function(){return this._searchBarWebTimer?this._searchBarWebTimer.restart():(this._searchBarWebTimer=f.get_timer("search_bar"),this._searchBarWebTimer.initialize({requireTTI:!0,requireTTV:!1,url:c.searchBarApiClient.getSearchApiUrl()})),this._searchBarWebTimer},t.prototype.render=function(){var e=this.props,t=e.user,r=e.isExpanded,s=e.placeholder,o=e.isFocused,i=e.isActive,a=e.rawQuery,c=e.normalizedQuery,l=e.slimSearchSuggestions,_=e.searchBarLoading,u=e.searchSessionId,p=e.highlightedRow,h=e.searchHistory,E=e.scopeChip,m=e.deletedChip,S=e.searchPath,f=e.headerItems,C=e.searchBarExperiments,g=e.browseScope,A=this.props.deletedChipEnabled&&R.isInDeletedFilterRightRailExperiment(C);return R.isInSinglePageSearchExperiment(C)?n.createElement("div",{className:"sps-placeholder"},"SINGLE PAGE SEARCH"):n.createElement(d.SearchBarView,{user:t,isExpanded:r,searchBarExperiments:C,placeholder:s,isFocused:o,isActive:i,rawQuery:a,normalizedQuery:c,suggestions:l,searchBarLoading:_,searchSessionId:u,highlightedRow:p,searchHistory:h,scopeChip:E,deletedChip:m,enableDeletedChip:A,browseScope:g,searchPath:S,dropdownHeaderItems:f,onSearch:this._handleSearch,onHistoryClearAllClick:this._handleHistoryClearAllClick,onHistoryItemClick:this._handleHistoryItemClick,onInputChange:this._handleInputChange,onInputKeydown:this._handleInputKeydown,onInputSubmit:this._handleInputSubmit,onSearchResultOpen:this._handleSearchResultOpen,onContextMenuCapture:this._handleContextMenuCapture,onRecentSearchContextMenuCapture:this._handleRecentSearchContextMenuCapture,onResultObjectPathClick:this._handleResultObjectPathClick,onSearchBarFocus:this._handleSearchBarFocus,onSearchBarBlur:this._handleSearchBarBlur,onHighlightDropdownItem:this._handleHighlightDropdownItem,onSearchChipInteraction:this._handleScopeChipChange,onDeletedChipInteraction:this._handleDeletedChipChange,onDropdownTTI:this._logSearchBarTTI,onDismissUpsell:this.props.dismissUpsell,showUpsell:this.props.showUpsell})},t})(n.PureComponent);t.SearchBarControllerElement=I;var O=u.getStoreForSearchBar(),D=function(e){var t=_.isSearchBarFocused,r=_.isSearchBarActive,n=_.rawQuery,s=_.normalizedQuery,o=_.searchSuggestions,i=_.slimSearchSuggestions,a=_.isSearchBarLoading,c=_.searchSessionId,l=_.highlightedSearchRow,u=_.searchHistory,p=_.scopeChip,d=_.deletedChip,h=_.deletedChipEnabled,E=_.searchPath,m=_.headerItems,S=_.browseScope,f=_.showUpsell;return{isFocused:t(e),isActive:r(e),rawQuery:n(e),normalizedQuery:s(e),searchSuggestions:o(e),slimSearchSuggestions:i(e),searchBarLoading:a(e),searchSessionId:c(e),highlightedRow:l(e),searchHistory:u(e),scopeChip:p(e),deletedChip:d(e),deletedChipEnabled:h(e),searchPath:E(e),headerItems:m(e),browseScope:S(e),showUpsell:f(e)}},v={blurSearchBar:l.blurSearchBar,focusSearchBar:l.focusSearchBar,highlightPreviousRow:l.highlightPreviousRow,highlightNextRow:l.highlightNextRow,setHighlightedRow:l.setHighlightedRow,addQueryToHistory:l.addQueryToHistory,setSearchQueryAndFetchResults:l.setSearchQueryAndFetchResults,clearAllHistory:l.clearAllHistory,setExperiments:l.setExperiments,setScopeChip:l.setScopeChip,setDeletedChip:l.setDeletedChip,dismissUpsell:l.dismissUpsell},y=s.connect(D,v)(I),L=function(e){return n.createElement(s.Provider,{store:O},n.createElement(y,r.__assign({},e)))};t.SearchBarController=T(L,["/static/css/search/search_bar_react-vflPFfhax.css"])}),define("modules/clean/search/search_bar/data/action_creators",["require","exports","tslib","modules/clean/search/search_bar/api","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/data/types","modules/clean/search/search_bar/history","modules/core/exception"],function(e,t,r,n,s,o,i,a){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0}),t.focusSearchBar=function(e){var r=e.user;return function(e){e(t.updateHistoryInternal({searchHistory:i.getHistory(r)})),e(t.focusSearchBarActionInternal())}},t.focusSearchBarActionInternal=function(){return{type:o.ActionTypes.FOCUS}},t.blurSearchBar=function(){return{type:o.ActionTypes.BLUR}},t.clearSearchBar=function(){return{type:o.ActionTypes.CLEAR}},t.updateHistoryInternal=function(e){var t=e.searchHistory;return{type:o.ActionTypes.UPDATE_HISTORY,payload:{searchHistory:t}}},t.addQueryToHistory=function(e){var r=e.user,n=e.query,s=e.searchSessionId,o=e.requestId;return function(e,a){var c=i.addQuery(r,n,s,o);e(t.updateHistoryInternal({searchHistory:c}))}},t.clearAllHistory=function(e){var r=e.user;return function(e,n){var s=i.clearAll(r);e(t.updateHistoryInternal({searchHistory:s}))}},t.setSearchQuery=function(e){var t=e.query,r=e.searchSessionId,n=e.keepHighlightedRow,s=e.searchPath;return{type:o.ActionTypes.SET_QUERY,payload:{query:t,searchSessionId:r,keepHighlightedRow:n,searchPath:s}}},t.setSearchSuggestions=function(e){var t=e.searchSuggestions,r=e.hasMoreResults;return{type:o.ActionTypes.SET_SUGGESTIONS,payload:{searchSuggestions:t,hasMoreResults:r}}},t.setSlimSearchSuggestions=function(e){var t=e.slimSearchSuggestions,r=e.hasMoreResults;return{type:o.ActionTypes.SET_SLIM_SUGGESTIONS,payload:{slimSearchSuggestions:t,hasMoreResults:r}}},t.setHighlightedRow=function(e){var t=e.highlightedSearchRow;return{type:o.ActionTypes.SET_HIGHLIGHTED_ROW,payload:{highlightedSearchRow:t}}},t.highlightPreviousRow=function(){return{type:o.ActionTypes.HIGHLIGHT_PREVIOUS_ROW}},t.highlightNextRow=function(){return{type:o.ActionTypes.HIGHLIGHT_NEXT_ROW}},t.setBrowseScope=function(e){var t=e.browseScope;return{type:o.ActionTypes.SET_BROWSE_SCOPE,payload:{browseScope:t}}},t.setScopeChip=function(e){var t=e.scopeChip;return{type:o.ActionTypes.SET_SCOPE_CHIP,payload:{scopeChip:t}}},t.setDeletedChip=function(e){var t=e.deletedChip;return{type:o.ActionTypes.SET_DELETED_CHIP,payload:{deletedChip:t}}},t.setDeletedChipEnabled=function(e){var t=e.enabled;return{type:o.ActionTypes.SET_DELETED_CHIP_ENABLED,payload:{enabled:t}}},t.setFileCategories=function(e){var t=e.fileCategories;return{type:o.ActionTypes.SET_FILE_CATEGORIES,payload:{fileCategories:t}}},t.setSearchQueryAndFetchResults=function(o){var i=o.user,l=o.query,_=o.webTimer,u=o.searchSessionId,p=o.keepHighlightedRow;return function(o,d){return r.__awaiter(c,void 0,void 0,function(){var c,h,E,m,S,f,C,g;return r.__generator(this,function(r){switch(r.label){case 0:if(c=s.scopeChip(d()),(h=function(){return l===s.rawQuery(d())&&c===s.searchPath(d())})())return[2];if(o(t.setSearchQuery({query:l,searchPath:c,searchSessionId:u,keepHighlightedRow:p})),s.deletedChip(d()))return o(t.setSearchSuggestions({searchSuggestions:[],hasMoreResults:!1})),[2];if(!s.isSearchBarLoading(d()))return[3,5];E=s.experiments(d()),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,n.searchBarApiClient.loadSlimResults({user:i,path:c,query:s.normalizedQuery(d()),searchSessionId:s.searchSessionId(d()),experiments:E,webTimer:_})];case 2:if(m=r.sent().searchResults,!h())return[2];try{S=e("modules/clean/react/starred/browse_exports").checkForMissingStarredData,S({items:m,user:i})}catch(e){a.reportException({err:e,severity:a.SEVERITY.NONCRITICAL,tags:["search_bar"]})}return o(t.setSlimSearchSuggestions({slimSearchSuggestions:m})),f=E.expUseFileInfoEndpoint,[4,n.searchBarApiClient.fetchAdditionalFileMetadata({searchResults:m,user:i,useFileInfoEndpoint:!!f})];case 3:return C=r.sent(),h()?(o(t.setSearchSuggestions({searchSuggestions:C})),[3,5]):[2];case 4:if(g=r.sent(),!(g instanceof n.RequestAbortedError))throw g;return[3,5];case 5:return[2]}})})}},t.setExperiments=function(e){var t=e.experiments;return{type:o.ActionTypes.SET_EXPERIMENTS,payload:{experiments:t}}},t.dismissUpsell=function(){return{type:o.ActionTypes.DISMISS_UPSELL}}}),define("modules/clean/search/search_bar/data/reducer",["require","exports","tslib","modules/clean/search/search_bar/data/types","modules/clean/search/store_helpers","modules/clean/search/search_bar/chips","modules/clean/search/search_bar/experiments","modules/clean/search/constants"],function(e,t,r,n,s,o,i,a){"use strict";function c(e,t){switch(void 0===e&&(e=l),t.type){case n.ActionTypes.FOCUS:return _(e,t);case n.ActionTypes.BLUR:return u(e,t);case n.ActionTypes.UPDATE_HISTORY:return p(e,t);case n.ActionTypes.SET_QUERY:return d(e,t);case n.ActionTypes.SET_SUGGESTIONS:return h(e,t);case n.ActionTypes.SET_SLIM_SUGGESTIONS:return E(e,t);case n.ActionTypes.SET_HIGHLIGHTED_ROW:return m(e,t);case n.ActionTypes.HIGHLIGHT_PREVIOUS_ROW:return f(e,t);case n.ActionTypes.HIGHLIGHT_NEXT_ROW:return S(e,t);case n.ActionTypes.SET_BROWSE_SCOPE:return C(e,t);case n.ActionTypes.SET_SCOPE_CHIP:return g(e,t);case n.ActionTypes.SET_DELETED_CHIP:return A(e,t);case n.ActionTypes.SET_DELETED_CHIP_ENABLED:return T(e,t);case n.ActionTypes.CLEAR:return R(e,t);case n.ActionTypes.SET_EXPERIMENTS:return I(e,t);case n.ActionTypes.DISMISS_UPSELL:return O(e,t);case n.ActionTypes.SET_FILE_CATEGORIES:return D(e,t);default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var l={isSearchBarFocused:!1,searchHistory:[],query:"",searchSessionId:s.generateRandomId(),searchPath:"",isSearchBarLoading:!1,searchSuggestions:[],hasMoreResults:!1,slimSearchSuggestions:[],highlightedSearchRow:0,browseScope:"/",canScope:!1,scopeChip:"/",deletedChip:!1,deletedChipEnabled:!1,experiments:{},upsellDismissed:!1,fileCategories:r.__assign({},a.FILE_CATEGORIES_UNCHECKED)},_=function(e,t){return r.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!0})},u=function(e,t){return r.__assign({},e,{highlightedSearchRow:0,isSearchBarFocused:!1})},p=function(e,t){var n=t.payload.searchHistory;return r.__assign({},e,{searchHistory:n})},d=function(e,t){var n=t.payload,o=n.query,i=n.searchPath,a=n.searchSessionId,c=n.keepHighlightedRow,l=e.searchSessionId;a?l=a:s.shouldStartNewSearchSession(e.query,o)&&(l=s.generateRandomId());var _=c?e.highlightedSearchRow:0;return r.__assign({},e,{query:o,searchPath:i,searchSessionId:l,searchSuggestions:[],hasMoreResults:!1,isSearchBarLoading:!s.isBlank(o),slimSearchSuggestions:[],highlightedSearchRow:_})},h=function(e,t){var n=t.payload,s=n.searchSuggestions,o=n.hasMoreResults;return r.__assign({},e,{searchSuggestions:s,hasMoreResults:!!o,isSearchBarLoading:!1})},E=function(e,t){var n=t.payload,s=n.slimSearchSuggestions,o=n.hasMoreResults;return r.__assign({},e,{slimSearchSuggestions:s,hasMoreResults:!!o,isSearchBarLoading:!1})},m=function(e,t){var n=t.payload.highlightedSearchRow;return r.__assign({},e,{highlightedSearchRow:n})},S=function(e,t){var n=!s.isBlank(e.query),o=e.slimSearchSuggestions.length||e.searchSuggestions.length||!n&&e.searchHistory.length||0,i=0;i+=n?1:0,i+=e.canScope?1:0;var a=Math.min(o+i-1,e.highlightedSearchRow+1);return r.__assign({},e,{highlightedSearchRow:a})},f=function(e,t){return r.__assign({},e,{highlightedSearchRow:Math.max(0,e.highlightedSearchRow-1)})},C=function(e,t){var n=t.payload.browseScope,s=e.scopeChip,i=o.isValidPathForChip(n);return r.__assign({},e,{browseScope:n,canScope:i,scopeChip:i?s:"/"})},g=function(e,t){var n=t.payload.scopeChip;return r.__assign({},e,{scopeChip:n||"/"})},A=function(e,t){var n=t.payload.deletedChip;return r.__assign({},e,{deletedChip:n,searchSuggestions:[]})},T=function(e,t){var n=t.payload.enabled;return r.__assign({},e,{deletedChipEnabled:n,searchSuggestions:[]})},R=function(e,t){var n=e.scopeChip,s=e.searchHistory,o=e.browseScope,a=e.experiments,c=e.isSearchBarFocused;return i.isInSinglePageSearchExperiment(e.experiments)?r.__assign({},l,{scopeChip:n,searchHistory:s,browseScope:o,experiments:a,isSearchBarFocused:c}):r.__assign({},l,{scopeChip:n,searchHistory:s,browseScope:o,experiments:a})},I=function(e,t){var n=t.payload.experiments;return r.__assign({},e,{experiments:n})},O=function(e,t){return r.__assign({},e,{upsellDismissed:!0})},D=function(e,t){var n=t.payload.fileCategories;return r.__assign({},e,{fileCategories:n})};t.searchBarReducer=c}),define("modules/clean/search/search_bar/data/selectors",["require","exports","external/reselect","modules/clean/filepath","modules/clean/react/browse/models","modules/clean/redux/types","modules/clean/search/search_bar/experiments","modules/clean/search/store_helpers","modules/clean/search/types","modules/clean/redux/selectors"],function(e,t,r,n,s,o,i,a,c,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(e){return l.getStateAtNamespace(e,o.SEARCH_BAR_NAMESPACE_KEY)};t.isSearchBarFocused=function(e){return _(e).isSearchBarFocused},t.searchHistory=function(e){return _(e).searchHistory},t.rawQuery=function(e){return _(e).query},t.normalizedQuery=function(e){return a.normalize(t.rawQuery(e))},t.searchSessionId=function(e){return _(e).searchSessionId},t.isSearchBarActive=function(e){return!!t.rawQuery(e)},t.searchPath=function(e){return _(e).searchPath},t.isSearchBarLoading=function(e){return _(e).isSearchBarLoading},t.searchSuggestions=function(e){return _(e).searchSuggestions},t.hasMoreResults=function(e){return _(e).hasMoreResults},t.slimSearchSuggestions=function(e){return _(e).slimSearchSuggestions},t.highlightedSearchRow=function(e){return _(e).highlightedSearchRow},t.searchResultForPath=function(e,r){return t.searchSuggestions(e).find(function(e){return e instanceof s.File&&n.paths_are_equal(e.fq_path,r)})},t.browseScope=function(e){return _(e).browseScope},t.scopeChip=function(e){return _(e).scopeChip},t.canScope=function(e){return _(e).canScope},t.deletedChip=function(e){return _(e).deletedChip},t.deletedChipEnabled=function(e){return _(e).deletedChipEnabled},t.experiments=function(e){return _(e).experiments},t.fileCategories=function(e){return _(e).fileCategories},t.upsellDismissed=function(e){return _(e).upsellDismissed},t.showUpsell=r.createSelector(t.experiments,t.upsellDismissed,t.normalizedQuery,t.searchSuggestions,t.slimSearchSuggestions,t.isSearchBarLoading,function(e,t,r,n,s,o){return i.dropdownUpsellEnabled(e)&&!!r&&!o&&!t&&!n.length&&!s.length}),t.headerItems=r.createSelector(t.normalizedQuery,t.canScope,t.showUpsell,t.deletedChipEnabled,t.experiments,function(e,t,r,n,s){var o=""!==e,a=[];return o&&a.push(c.SearchBarDropdownHeaderItemType.SEARCH_ALL),n&&i.isInDeletedFilterRightRailExperiment(s)?a.push(c.SearchBarDropdownHeaderItemType.DELETED_FILES):t&&a.push(c.SearchBarDropdownHeaderItemType.SCOPE_CHIPS),r&&a.push(c.SearchBarDropdownHeaderItemType.SEARCH_UPSELL),a})}),define("modules/clean/search/search_bar/data/store",["require","exports","modules/clean/redux/store","modules/clean/redux/types","modules/clean/search/search_bar/data/reducer"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.getStoreForSearchBar=function(){return o||(o=r.getStoreAndRegisterReducers((e={},e[n.SEARCH_BAR_NAMESPACE_KEY]=s.searchBarReducer,e))),o;var e}}),define("modules/clean/search/search_bar/data/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.FOCUS="SEARCH_BAR/FOCUS",e.BLUR="SEARCH_BAR/BLUR",e.CLEAR="SEARCH_BAR/CLEAR",e.UPDATE_HISTORY="SEARCH_BAR/UPDATE_HISTORY",e.SET_QUERY="SEARCH_BAR/SET_QUERY",e.SET_SUGGESTIONS="SEARCH_BAR/SET_SUGGESTIONS",e.SET_SLIM_SUGGESTIONS="SEARCH_BAR/SET_SLIM_SUGGESTIONS",e.SET_HIGHLIGHTED_ROW="SEARCH_BAR/SET_HIGHLIGHTED_ROW",e.HIGHLIGHT_PREVIOUS_ROW="SEARCH_BAR/HIGHLIGHT_PREVIOUS_ROW",e.HIGHLIGHT_NEXT_ROW="SEARCH_BAR/HIGHLIGHT_NEXT_ROW",e.SET_BROWSE_SCOPE="SEARCH_BAR/SET_BROWSE_SCOPE",e.SET_SCOPE_CHIP="SEARCH_BAR/SET_SCOPE_CHIP",e.SET_DELETED_CHIP="SEARCH_BAR/SET_DELETED_CHIP",e.SET_DELETED_CHIP_ENABLED="SEARCH_BAR/SET_DELETED_CHIP_ENABLED",e.SET_EXPERIMENTS="SEARCH_BAR/SET_EXPERIMENTS",e.DISMISS_UPSELL="SEARCH_BAR/DISMISS_UPSELL",e.SET_FILE_CATEGORIES="SEARCH_BAR/SET_FILE_CATEGORIES"})(t.ActionTypes||(t.ActionTypes={}))}),define("modules/clean/search/search_bar/experiments",["require","exports","modules/clean/search/types"],function(e,t,r){"use strict";function n(e){return!!e&&e.expSinglePageSearch===r.SinglePageSearchVariants.ON}function s(e){return!!e&&e.expDeletedFilterRightRail===r.DeletedFilterRightRailVariants.ON}Object.defineProperty(t,"__esModule",{value:!0}),t.dropdownUpsellEnabled=function(e){var t=e.expSearchDropdownUpsell;return t===r.DropdownUpsellVariants.V1||t===r.DropdownUpsellVariants.V2},t.isInSinglePageSearchExperiment=n,t.isInDeletedFilterRightRailExperiment=s}),define("modules/clean/search/search_bar/history",["require","exports","external/lodash","modules/clean/search/constants","modules/clean/storage","modules/clean/search/logger"],function(e,t,r,n,s,o){"use strict";function i(e){return s.UserLocalStorage.get(e.id,n.SEARCH_RECENT_HISTORY_STORAGE_KEY)||[]}function a(e,t,a,c){void 0===a&&(a=""),void 0===c&&(c="");var l=i(e),_=function(e,t){return e.normalizedQuery===t.normalizedQuery},u=r.findIndex(l,function(e){return _(e,t)});return o.logRecentQueryStored({searchSessionId:a,requestId:c,query:t,user:e,previousPosition:u}),l=l.filter(function(e){return!_(e,t)}),l=[t].concat(l).slice(0,n.SEARCH_RECENT_HISTORY_CAPACITY),s.UserLocalStorage.set(e.id,n.SEARCH_RECENT_HISTORY_STORAGE_KEY,l),l}function c(e,t){void 0===t&&(t=""),o.logRecentHistoryCleared({searchSessionId:t,user:e});var r=[];return s.UserLocalStorage.set(e.id,n.SEARCH_RECENT_HISTORY_STORAGE_KEY,r),r}function l(){s.UserLocalStorage.clearOtherUsers([])}function _(){s.UserLocalStorage.clearOtherUsers([])}Object.defineProperty(t,"__esModule",{value:!0}),t.getHistory=i,t.addQuery=a,t.clearAll=c,t.testMockSetup=l,t.testMockTeardown=_}),define("modules/clean/search/search_bar/log_helper",["require","exports","modules/clean/search/logger","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors"],function(e,t,r,n,s){"use strict";function o(e){var t=e.result,o=e.user,i=e.action_type,a=e.viewport,c=e.view_type,l=e.searchSessionId;r.logSearchAction({searchSessionId:l||s.searchSessionId(n.getStoreForSearchBar().getState()),result:t,user:o,action_type:i,search_type:"dropdown",viewport:a,view_type:c})}Object.defineProperty(t,"__esModule",{value:!0}),t.logDropdownSearchAction=o}),define("modules/clean/search/search_bar/view",["require","exports","tslib","external/classnames","spectrum/icon_global","spectrum/icon_content","spectrum/icon_action/index","external/react","modules/clean/keycode","modules/clean/react/maestro/a11y_constants","modules/clean/search/types","modules/core/i18n","modules/clean/web_timing_logger","modules/clean/search/search_bar/chips","modules/clean/filepath","modules/clean/em_string","modules/clean/react/title_bubble","modules/clean/search/search_bar/experiments"],function(e,t,r,n,s,o,i,a,c,l,_,u,p,d,h,E,m,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=(function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e._renderDropdown=function(){},e._handleNavigation=function(){e._searchBarInput.blurSearchBarTextInput()},e._onHistoryItemClick=function(t,r){e.props.onHistoryItemClick&&e.props.onHistoryItemClick(t,r)},e._onSearchResultOpen=function(t){e.props.onSearchResultOpen(t),e._handleNavigation()},e._onResultObjectPathClick=function(t){e.props.onResultObjectPathClick(t),e._handleNavigation()},e._onSearch=function(t){var r=e.props.onSearch;r&&r(t),e._handleNavigation()},e._setSearchBarInputRef=function(t){return e._searchBarInput=t},e._setSearchBarDropdownRef=function(t){e._searchBarDropdown=t},e}return r.__extends(s,t),s.prototype.getSearchBarInput=function(){return this._searchBarInput},s.prototype.getSearchBarDropdown=function(){return this._searchBarDropdown},s.prototype._shouldRenderDropdown=function(){var e=this.props,t=e.searchHistory,r=e.normalizedQuery,n=e.dropdownHeaderItems;return!!(t&&t.length||n&&(n.indexOf(_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS)!==-1||n.indexOf(_.SearchBarDropdownHeaderItemType.DELETED_FILES)!==-1)||r&&r.length)},s.prototype.componentDidMount=function(){var t=this;p.waitForTTI().then(function(){e(["modules/clean/search/search_bar/dropdown","modules/clean/react/starred/browse_exports"],function(e,r){var n=e.SearchBarDropdown;r.Star,r.HOME_RESOURCE_ID_TYPE,r.StarredSource,r.checkForMissingStarredData;t._renderDropdown=function(){var e=t.props,r=e.browseScope,s=e.children,o=e.dropdownHeaderItems,i=e.highlightedRow,c=e.isFocused,l=e.normalizedQuery,_=e.onContextMenuCapture,u=e.onDropdownTTI,p=e.onHighlightDropdownItem,d=e.onHistoryClearAllClick,h=e.onRecentSearchContextMenuCapture,E=e.onSearchChipInteraction,m=e.scopeChip,S=e.onDeletedChipInteraction,f=e.deletedChip,C=e.enableDeletedChip,g=e.searchBarExperiments,A=e.searchBarLoading,T=e.searchHistory,R=e.searchPath,I=e.searchSessionId,O=e.showLinkToResultsPage,D=e.suggestions,v=e.user;return a.createElement(n,{browseScope:r,children:s,dropdownHeaderItems:o||[],highlightedRow:i,isOpen:c,normalizedQuery:l,onContextMenuCapture:_,onDropdownTTI:u,onHighlightDropdownItem:p,onHistoryClearAllClick:d,onHistoryItemClick:t._onHistoryItemClick,onRecentSearchContextMenuCapture:h,onResultObjectPathClick:t._onResultObjectPathClick,onSearch:t._onSearch,onSearchChipInteraction:E,onDeletedChipInteraction:S,onSearchResultOpen:t._onSearchResultOpen,onDismissUpsell:t.props.onDismissUpsell,showUpsell:t.props.showUpsell,ref:t._setSearchBarDropdownRef,scopeChip:m,deletedChip:f,enableDeletedChip:C,searchBarExperiments:g,searchBarLoading:A,searchHistory:T||[],searchPath:R,searchSessionId:I,showLinkToResultsPage:O,suggestions:D,user:v})},t._shouldRenderDropdown()&&t.forceUpdate()})})},s.prototype.render=function(){var e=this.props,t=e.isActive,s=e.isExpanded,o=e.isFocused,i=e.searchBarExperiments,c={"search-bar--container":!0,"u-l-fr":!0,"sps--search-bar--container":S.isInSinglePageSearchExperiment(i),"is-expanded":s,"is-focused":o},l={"is-active":t,"is-collapsed":!(s||o),"is-expanded":s,"is-focused":o,"search-bar":!0},_=this._shouldRenderDropdown();return a.createElement("div",{className:n(c)},a.createElement("div",{className:n(l)},a.createElement(C,r.__assign({},this.props,{shouldRenderDropdown:_,ref:this._setSearchBarInputRef})),_&&this._renderDropdown()))},s.defaultProps={rawQuery:"",normalizedQuery:"",showLinkToResultsPage:!0},s})(a.Component);t.SearchBarView=f;var C=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusSearchBarTextInput=function(){t.props.isFocused||t._searchBarTextInput.focus()},t._onKeyDown=function(e){e.keyCode===c.KeyCode.ESC&&t.blurSearchBarTextInput(),t.props.onInputKeydown(e,t._getCursorPosition())},t._onSubmit=function(e){var r=t.props.highlightedRow,n=t.props.searchHistory||[],s=!t.props.normalizedQuery&&n.length>0,o=t.props.dropdownHeaderItems||[],i=r-o.length;if(s&&i>=0){e.preventDefault();var a=n[i];return void(t.props.onHistoryItemClick&&t.props.onHistoryItemClick(a,i))}return r<o.length&&o[r]===_.SearchBarDropdownHeaderItemType.SCOPE_CHIPS||t.blurSearchBarTextInput(),t.props.onInputSubmit(e,r)},t._handleButtonMouseDown=function(e){t.props.rawQuery&&t.props.rawQuery.length&&(t._onSubmit(e),e.preventDefault())},t._setSearchBarTextInputRef=function(e){return t._searchBarTextInput=e},t}return r.__extends(t,e),t.prototype._getCursorPosition=function(){return this._searchBarTextInput.selectionEnd},t.prototype.getSearchBarTextInput=function(){return this._searchBarTextInput},t.prototype.blurSearchBarTextInput=function(){this._searchBarTextInput.blur(),this.props.onSearchBarBlur()},t.prototype.render=function(){var e=this.props,t=e.onInputChange,n=e.onSearchBarFocus,o=e.onSearchBarBlur,i=e.placeholder,c=e.isFocused,_=e.highlightedRow,p=e.rawQuery,d=e.shouldRenderDropdown,h=d?{"aria-expanded":c,"aria-activedescendant":"search-dropdown-suggestion"+_,"aria-autocomplete":"list","aria-owns":"search-bar__suggestions",role:"combobox"}:void 0;return a.createElement("form",{className:"search-bar__input",onSubmit:this._onSubmit},a.createElement("button",{"aria-label":u._("Search"),className:"search-bar__button",type:"submit",onMouseDown:this._handleButtonMouseDown},a.createElement(s.IconGlobal,{name:"search-small"})),a.createElement(g,r.__assign({},this.props,{focusSearchInput:this.focusSearchBarTextInput})),a.createElement("input",r.__assign({"aria-label":u._("Search")},h,{
className:"search-bar__text-input",maxLength:1e3,onChange:t,onFocus:n,onBlur:o,onKeyDown:this._onKeyDown,placeholder:i?i:u._("Search"),ref:this._setSearchBarTextInputRef,value:p,tabIndex:l.LAYOUT_TAB_ORDER.SEARCH_BAR})))},t})(a.Component);t.SearchBarInput=C;var g=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onScopeChipClosed=function(){t.props.onSearchChipInteraction&&t.props.onSearchChipInteraction(!1)},t._onDeletedChipClosed=function(){t.props.onDeletedChipInteraction&&t.props.onDeletedChipInteraction(!1)},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.scopeChip,r=e.user,n=e.isFocused,s=e.isExpanded;if(this.props.deletedChip&&S.isInDeletedFilterRightRailExperiment(this.props.searchBarExperiments))return a.createElement(A,{key:"deleted",isFocused:n,isExpanded:s,icon:a.createElement(i.IconAction,{name:"delete",className:"search-bar__chip-icon--dark"}),text:u._("Deleted files"),onClose:this._onDeletedChipClosed,onClick:this.props.focusSearchInput});if(t&&d.isValidPathForChip(t)){var c=r.cdm_tmf_path&&t&&h.paths_are_equal(r.cdm_tmf_path,t),l=c?"folder_team_member_child-small":"folder-small",_=h.child_dir(t);return a.createElement(A,{key:"scope",isFocused:n,isExpanded:s,icon:a.createElement(o.IconContent,{name:l,height:"18px",width:"18px"}),text:_,onClose:this._onScopeChipClosed,onClick:this.props.focusSearchInput})}return null},t})(a.Component),A=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onMouseDownOnChipItem=function(e){e.stopPropagation(),e.preventDefault()},t._onMouseDownClose=function(e){e.stopPropagation(),e.preventDefault(),t.props.onClose()},t._onMouseDownOnChipButton=function(e){e.stopPropagation(),e.preventDefault(),t.props.onClick()},t}return r.__extends(t,e),t.prototype.render=function(){var e=this.props,t=e.isFocused,r=e.isExpanded,n=e.text,s=e.icon;if(!n)return null;var o=E.Emstring.em_snippet(n,8,.6),i=a.createElement("span",{className:"search_bar__chip_text",key:"text"},o),c=o!==n;return r||t?a.createElement("span",{className:"search_bar__chip"},a.createElement("span",{className:"search_bar__chip_item",tabIndex:0,onMouseDown:this._onMouseDownOnChipItem},s,c?a.createElement(m.TitleBubble,{content:n,position:m.TitleBubble.POSITIONS.BOTTOM,key:"text"},i):i),a.createElement("button",{type:"button","aria-label":u._("Remove filter"),className:"search_bar__chip_close_button",key:"close",onMouseDown:this._onMouseDownClose})):a.createElement("span",{className:"search_bar__chip"},a.createElement("button",{type:"button","aria-label":u._("Search"),className:"search_bar__chip_button",onMouseDown:this._onMouseDownOnChipButton},s))},t})(a.PureComponent)}),define("modules/clean/search/search_helpers",["require","exports","tslib","external/sjcl","modules/clean/search/search_bar/data/store","modules/clean/search/search_bar/data/selectors","modules/clean/search/search_bar/api","modules/clean/react/browse/models","modules/clean/search/types","modules/clean/search/models","modules/core/i18n","modules/core/uri","modules/clean/browse_uri_interface","modules/core/cookies","modules/clean/search/constants"],function(e,t,r,n,s,o,i,a,c,l,_,u,p,d,h){"use strict";function E(e){var t=e.user,n=e.searchPath,s=e.normalizedQuery,o=e.searchSessionId,i=e.searchToken,a=e.qargs,c=r.__assign({path:n,query:s,search_session_id:o,search_token:i},a);return new u.URI({path:"/search/"+t.role,query:c})}function m(e,t){return e instanceof l.SlimFileSearchResult?p.browse_uri_for_fq_path(t,e.fq_path).toString():e.url}function S(e){var t=e.searchBarApiClient,r=e.searchResult,n=e.user,c=e.onSuccess,u=e.onError,p=e.useFileInfoEndpoint;if(r instanceof l.SlimFileSearchResult){var d=o.searchResultForPath(s.getStoreForSearchBar().getState(),r.fq_path);d?c(d):t.fetchAdditionalFileMetadata({searchResults:[r],user:n,useFileInfoEndpoint:p}).then(function(e){if(e.length>0)c(e[0]);else if(u){var t=_._("There was a problem completing this request.");u(t)}}).catch(function(e){!u||e instanceof i.RequestAbortedError||u(e.message)})}else(r instanceof a.Paper||r instanceof a.PaperFolder)&&c(r)}function f(e){return 0===e.button&&!e.altKey&&!e.ctrlKey&&!e.metaKey}function C(){var e=n.codec.utf8String.toBits(d.Cookies.read("__Host-js_csrf")),t=n.codec.utf8String.toBits("search"),r=new n.misc.hmac(e);return n.codec.base64.fromBits(r.encrypt(t))}function g(e){return e.expFileTypeFilter===c.FileTypeFilterVariants.ON}function A(e){var t=[];return Object.keys(e).forEach(function(r){"checked"===e[r]&&t.push(r)}),t.join(",")}function T(e){var t=r.__assign({},h.FILE_CATEGORIES_UNCHECKED);return e&&e.split(",").forEach(function(e){e in t&&(t[e]="checked")}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.buildSearchURL=E,t.resultObjectToUrl=m,t.fetchFullSearchResult=S,t.shouldHandleClick=f,t.getSearchCsrfToken=C,t.isInFileTypeFilterExperiment=g,t.fileCategoriesToString=A,t.fileCategoriesFromString=T}),define("modules/clean/search/store_helpers",["require","exports"],function(e,t){"use strict";function r(e){return e.trim().replace(/\ +/g," ")}function n(e){return!r(e)}function s(e,t){return!(n(e)||!n(t))||e.length>=3&&1===t.length}function o(){for(var e="",t=0;t<32;t++){var r=Math.floor(10*Math.random());e+=String(r)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.normalize=r,t.isBlank=n,t.shouldStartNewSearchSession=s,t.generateRandomId=o}),define("modules/clean/search/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchResultTypes={FILE:"FILE",PAPER:"PAPER",PAPER_FOLDER:"PAPER_FOLDER"};(function(e){e.OFF="OFF",e.CONTROL="CONTROL",e.V1="V1",e.V2="V2"})(t.DropdownUpsellVariants||(t.DropdownUpsellVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.DeletedFilterRightRailVariants||(t.DeletedFilterRightRailVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL",e.HOLDOUT="HOLDOUT"})(t.SinglePageSearchVariants||(t.SinglePageSearchVariants={}));(function(e){e.ON="ON",e.OFF="OFF",e.CONTROL="CONTROL"})(t.FileTypeFilterVariants||(t.FileTypeFilterVariants={}));(function(e){e.IMAGE="image",e.DOCUMENT="document",e.PDF="pdf",e.SPREADSHEET="spreadsheet",e.PRESENTATION="presentation",e.AUDIO="audio",e.VIDEO="video",e.FOLDER="folder",e.PAPER="paper",e.OTHER="other"})(t.FileCategory||(t.FileCategory={}));(function(e){e.SEARCH_ALL="SEARCH_ALL",e.SCOPE_CHIPS="SCOPE_CHIPS",e.DELETED_FILES="DELETED_FILES",e.SEARCH_UPSELL="SEARCH_UPSELL"})(t.SearchBarDropdownHeaderItemType||(t.SearchBarDropdownHeaderItemType={}))}),define("modules/clean/sharing/access_level",["require","exports","external/lodash"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e[e.ACCESS_NO_ACCESS=0]="ACCESS_NO_ACCESS",e[e.ACCESS_READER_NO_COMMENT=-10]="ACCESS_READER_NO_COMMENT",e[e.ACCESS_READER=1]="ACCESS_READER",e[e.ACCESS_WRITER=2]="ACCESS_WRITER",e[e.ACCESS_OWNER=3]="ACCESS_OWNER"})(t.NameSpaceAccess||(t.NameSpaceAccess={})),t.ACCESS_LEVEL={OWNER:"owner",WRITER:"writer",READER:"reader",READER_NO_COMMENT:"reader_no_comment"},t.ACCESS_VALUES=r.values(t.ACCESS_LEVEL);var n={reader_no_comment:-10,reader:1,writer:2,owner:3};t.isLowerAccess=function(e,r){var s=Object.keys(n);return e!==r&&s.indexOf(e)!==-1&&s.indexOf(r)!==-1&&t.getMaxAccess([e,r])===e},t.getMaxAccess=function(e){if(0===e.length)throw Error("Argument accessLevels are not valid.");for(var t=e[0],r=n[t],s=0;s<e.length;s++){var o=e[s],i=n[o];i>r&&(r=i,t=o)}return t}}),define("modules/clean/upsell/exception",["require","exports","modules/core/exception","modules/core/xhr"],function(e,t,r,n){"use strict";function s(e){var t=e.severity,s=void 0===t?r.SEVERITY.CRITICAL:t;n.sendXhr("/prompt/log_jse",{severity:s})}function reportException(e){var n=e.err,s=e.tags,o=void 0===s?[]:s,i=e.severity,a=void 0===i?r.SEVERITY.CRITICAL:i,c=e.exc_extra,l=void 0===c?{}:c;o.push(t.TAGS.PROMPT),o.push(t.TAGS.MEGAPHONE),r.reportException({err:n,tags:o,severity:a,exc_extra:l}),t.logExceptionRate({severity:a})}function o(e){var n=e.err,s=e.js_controller_options,o=void 0===s?{}:s,i=e.severity,a=void 0===i?r.SEVERITY.CRITICAL:i,c=e.tags,l=void 0===c?[]:c,_={"campaign-name":"campaignName",location:"campaignLocationId"};for(var u in _)if(_.hasOwnProperty(u)){var p=_[u],d=o[p];d&&l.push("prompt-"+u+"-"+d)}t.reportException({err:n,tags:l,severity:a,exc_extra:o})}Object.defineProperty(t,"__esModule",{value:!0}),t.SEVERITY=r.SEVERITY,t.TAGS={MEGAPHONE:"megaphone",PROMPT:"prompt",PROMPT_ADMIN:"prompt-admin",PROMPT_REACT_LOADER:"prompt-react-loader",PROMPT_HA_LOADER:"prompt-ha-loader",PROMPT_LOADER:"prompt-loader",PROMPT_MAIN_AND_ACCOUNT_HEADER_LOADER:"prompt-main-and-account-header-loader",PROMPT_MUTUALLY_EXCLUSIVE_LOADER:"prompt-mutually-exclusive-loader",LEGACY_TOP_NOTIFICATIONS:"legacy-top-notifications"},t.logExceptionRate=s,t.reportException=reportException,t.reportJsControllerException=o}),define("modules/clean/upsell/legacy_prompt_event_logging",["require","exports","modules/core/uri","modules/clean/ajax_minimal"],function(e,t,r,n){"use strict";function s(e,t){var n={campaign_id:t.campaignId.toString()};if(t.versionId&&(n.campaign_id=t.versionId.toString(),n.version_id=t.versionId.toString()),"number"==typeof t.promptQueriedAtMs&&(n.prompt_queried_at_ms=t.promptQueriedAtMs.toString()),window&&window.performance&&window.performance.now){var s=Math.round(window.performance.now());n.delta_from_request_start_ms=s.toString()}return t.activeUserId&&(n._subject_uid=String(t.activeUserId)),t.requestId&&(n.prompt_parent_request_id=t.requestId),t.eventName&&(n.event_name=t.eventName),void 0!==t.remindMeLater&&(n.remind_me_later=(!!t.remindMeLater).toString()),t.csrfToken&&(n.csrf_token=encodeURIComponent(t.csrfToken)),t.csrfTokenType&&(n.csrf_token_type=encodeURIComponent(t.csrfTokenType)),new r.URI({path:e,query:n})}Object.defineProperty(t,"__esModule",{value:!0}),t.LEGACY_EVENT_CONFIRM="db:prompt:confirm",t.LEGACY_EVENT_DISMISS="db:prompt:dismiss",t.LEGACY_EVENT_PRE_CONFIRM="db:prompt:pre-confirm",t.LEGACY_EVENT_PRE_DISMISS="db:prompt:pre-dismiss",t.LEGACY_EVENT_SHOW="db:prompt:show",t.getUpsellControllerURI=s;var o=(function(){function e(e){this.params=e}return e.prototype.logImpression=function(){var e=s("/prompt/log_impression",this.params);n.post(e.toString(),"")},e.prototype.logDismissal=function(){var e=s("/prompt/dismiss",this.params);n.post(e.toString(),"")},e})();t.LegacyEventLogger=o}),define("modules/clean/upsell/prompt_event_emitter",["require","exports","tslib","external/eventemitter3"],function(e,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={ON_HA_LOADED:"ON_HA_LOADED",REACT_HA_DID_UPDATE:"REACT_HA_DID_UPDATE",ON_PROMPT_INITIALIZED:"ON_PROMPT_INITIALIZED"};t.Events=s;var o=new n;t.eventEmitter=o;var i=(function(e){function t(){var t=e.call(this)||this;return t.allEventBuffers={},t}return r.__extends(t,e),t.prototype.on=function(t,r){var n=this;e.prototype.on.call(this,t,r);var s=this.allEventBuffers[t];return void 0!==s&&s.forEach(function(e){n.emit(t,e)}),this},t.prototype.emit=function(t,r){return void 0===this.allEventBuffers[t]&&(this.allEventBuffers[t]=[]),this.allEventBuffers[t].push(r),e.prototype.emit.call(this,t,r)},t.prototype.reset=function(){this.allEventBuffers={},this.removeAllListeners()},t})(n);t.BufferedEventEmitter=i,window.ensemble&&!window.ensemble.bufferedEventEmitter&&(window.ensemble.bufferedEventEmitter=new i);var a=window.ensemble&&window.ensemble.bufferedEventEmitter?window.ensemble.bufferedEventEmitter:new i;t.promptBufferedEventEmitter=a}),define("modules/clean/upsell/prompt_event_logger",["require","exports","jquery","modules/clean/ajax","modules/clean/upsell/legacy_prompt_event_logging"],function(e,t,r,n,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e){this.campaignProps=e}return e.prototype.recordClientImpression=function(){var e=this.getUpsellControllerURI("/prompt/log_impression");this.recordAck(e)},e.prototype.recordConfirm=function(){var e=this.getUpsellControllerURI("/prompt/confirm");this.recordAck(e,"db:prompt:confirm")},e.prototype.recordDismiss=function(e){var t=this.getUpsellControllerURI("/prompt/dismiss",{remindMeLater:e});this.recordAck(t,"db:prompt:dismiss")},e.prototype.recordEvent=function(e){var t=this.getUpsellControllerURI("/prompt/log_event",{eventName:e});this.recordAck(t)},e.prototype.recordAck=function(e,t){var r=this;n.SilentBackgroundRequest({type:"POST",url:e.toString()}).done(function(e){t&&r.triggerExternalEvent(t)})},e.prototype.getUpsellControllerURI=function(e,t){return s.getUpsellControllerURI(e,{campaignId:this.campaignProps.campaign.campaignId,versionId:this.campaignProps.campaign.versionId,activeUserId:this.campaignProps.subjectUser,promptQueriedAtMs:this.campaignProps.promptQueriedAtMs,requestId:this.campaignProps.requestId,csrfToken:this.campaignProps.csrfToken,csrfTokenType:this.campaignProps.csrfTokenType,eventName:t&&t.eventName,remindMeLater:t&&t.remindMeLater})},e.prototype.triggerExternalEvent=function(e){r(document).trigger(e,{campaignName:this.campaignProps.campaign.campaignName})},e})();t.PromptEventLogger=o}),define("modules/clean/web_user_action_events",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ADD_COMMENT="add_comment",e.ARCHIVE="archive",e.ATTACHMENT_ADD_SUCCESS="attachment_add_success",e.ATTACHMENT_CLICKED="attachment_clicked",e.ATTACHMENT_REMOVED="attachment_removed",e.CALENDAR_TAB_CLICKED="calendar_tab_clicked",e.CALENDAR_SUGGESTIONS_REMOVED="calendar_suggestions_removed",e.CLICK_ADD_ATTACHMENT="click_add_attachment",e.CLICK_CONVERT_INDIVIDUAL_ACCOUNT="click_convert_individual_account",e.CLICK_LEARN_MORE_ACCOUNT_CONVERSION="click_learn_more_account_conversion",e.CLICK_PATH_LINK="click_path_link",e.CLICK_REVIEW_SUMMARY_DELETE_USER="click_review_summary_delete_user",e.CONTEXT_MENU="context_menu",e.COPY="copy",e.COPY_ACCEPT_CLICK="copy_accept_click",e.CREATE_FOLDER="create_folder",e.DISBAND_TEAM_KEEP="disband_team_keep",e.DISBAND_TEAM_LEARN_MORE="disband_team_learn_more",e.DISBAND_TEAM_VIEW="disband_team_view",e.DELETE="delete",e.DELETE_ACCEPT_CLICK="delete_accept_click",e.DOWNLOAD="download",e.EVENTS="events",e.FILE_VIEW="file_view",e.FOLDER_OPEN="folder_open",e.LEAVE_TEAM_CANCEL="leave_team_cancel",e.LEAVE_TEAM_LEARN_MORE="leave_team_learn_more",e.LEAVE_TEAM_VIEW="leave_team_view",e.LINK_GOOGLE_CAL_CLICKED="link_google_cal_clicked",e.LINK_GOOGLE_CAL_SUCCESS="link_google_cal_success",e.MOVE="move",e.MOVE_ACCEPT_CLICK="move_accept_click",e.MOVE_SUGGESTION_MODAL_FOLDER_CLICK="move_suggestion_modal_folder_click",e.MOVE_SUGGESTION_MODAL_SUGGESTION_CLICK="move_suggestion_modal_suggestion_click",e.OPEN_ADD_TO_COLLECTION_MODAL="open_add_to_collection_modal",e.OPEN_CALENDAR_FLYOUT="open_calendar_flyout",e.OPEN_COPY_MODAL="open_copy_modal",e.OPEN_DELETE_USER_MODAL="open_delete_user_modal",e.OPEN_MOVE_MODAL="open_move_modal",e.OPEN_MOVE_SUGGESTION_MODAL="open_move_suggestion_modal",e.OPEN_ROW="open_row",e.PAPER_CONTEXT_MENU="paper_context_menu",e.PAPER_OPEN="paper_open",e.PERMANENT_DELETE="permanent_delete",e.PERMANENT_DELETE_ACCEPT_CLICK="permanent_delete_accept_click",e.RENAME="rename",e.RESTORE="restore",e.RESTORE_ACCEPT_CLICK="restore_accept_click",e.SELECT_ROW="select_row",e.SHARE="share",e.SHOW_IN_FOLDER="show_in_folder",e.SORT_RECORDS="sort_records",e.STAR="star",e.REMOVE_STAR="remove_star",e.SWITCH_ACCOUNT="switch_account",e.SWITCH_VIEW_TYPE="switch_view_type",e.TOGGLE_DELETED_FILES="toggle_deleted_files",e.UNMOUNTED_VIEW="unmounted_view",e.VERSIONS="versions",e.VIEW_SHARE_MODEL="view_share_model",e.OPEN_DESKTOP="open_via_unity",e.CONF_BY_REMOVE_MEMBER="conf_by_remove_member",e.CONF_BY_DOWNGRADE_MEMBER="conf_by_downgrade_member",e.CONF_BY_MANAGE_ACCESS="conf_by_manage_access",e.CONF_BY_UNDO_AFTER_RESTORE_ACCESS="conf_by_undo_after_restore_access",e.CONF_BY_CREATE_CONFIDENTIAL_FOLDER="conf_by_create_confidential_folder",e.ADD_MORE_FILES_CLICK="add_more_files_click",e.CLOSE_MODAL_CLICK="close_modal_click",e.DISMISS_INLINE_STATUS="dismiss_inline_status",e.UPLOAD_BUTTON_CLICK="upload_button_click",e.VIEW_DETAILS_CLICK="view_details_click",e.CANCEL_UPLOAD_CLICK="cancel_upload_click",e.UPLOAD_CLICK="upload_click",e.UPLOAD_FILES_CLICK="upload_files_click",e.UPLOAD_FOLDER_CLICK="upload_folder_click",e.CREATE_COLLECTION_SUCCESS="create_collection_success",e.CREATE_COLLECTION_FAIL="create_collection_fail",e.FILE_CREATE_OPEN_MENU="file_create_open_menu",e.FILE_CREATE_WORD="file_create_word",e.FILE_CREATE_POWERPOINT="file_create_powerpoint",e.FILE_CREATE_EXCEL="file_create_excel"})(t.WebUserActionLogEvent||(t.WebUserActionLogEvent={}));(function(e){e.SHARED_FOLDER="shared folder",e.FILE_FOLDER="file folder",e.EVERYONE_GROUP_VIEW_ACCESS="everyone group view access",e.SPECIFIC_PEOPLE="specific people",e.BROWSE="browse",e.CONTENT_MANAGER="content manager"})(t.WebUserActionLogExtraValue||(t.WebUserActionLogExtraValue={}))}),define("modules/clean/web_user_action_logger",["require","exports","modules/clean/ajax"],function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_ERRORS=3;var n=(function(){function e(){this.errorCount=0,this.lastError=Date.now(),this.shouldReport=!0}return e.prototype.log=function(e,n,s){var o=this;return this.shouldReport&&(this.errorCount<t.MAX_ERRORS||Date.now()-this.lastError>6e5)?new Promise(function(i,a){r.SilentBackgroundRequest({url:"/log/web_user_action",data:{_subject_uid:e,event_type:n,extra_params:JSON.stringify(s)},error:function(e){429===e.status?o.errorCount=t.MAX_ERRORS:o.errorCount++,o.lastError=Date.now(),a(e)},success:function(e){try{var t=JSON.parse(e);t&&!t.continue_sending&&(o.shouldReport=!1),o.errorCount=0,i(e)}catch(e){throw o.errorCount++,o.lastError=Date.now(),a(e),e}}})}):Promise.resolve({})},e})();t.WebUserActionLogClass=n,t.WebUserActionLog=new n});
//# sourceMappingURL=pkg-embedded_app.min.js-vflQGLyW1.map