define(["require","exports","modules/clean/ajax","modules/core/browser","modules/clean/sharing/api/client","modules/constants/file_viewer","modules/clean/file_store/utils","modules/clean/viewer","modules/clean/react/paper/paper_log","modules/core/i18n","modules/clean/react/bubble_dropdown_v2","modules/core/notify","modules/clean/react/size_class/constants","modules/clean/react/sign_in/utils"],function(e,o,r,n,t,i,a,s,l,d,u,c,p,_){"use strict";function f(e){var o=e.file,r=e.sharedLink;return m(e)?P(o)?r?v.Button:v.Dropdown:v.Ellipsis:v.Off}function b(e){return e===v.Dropdown||e===v.Ellipsis?u.BubbleDropdownPositions.BOTTOM_LEFT:u.BubbleDropdownPositions.BOTTOM}function h(){return"ON"===i.EMBED_TO_PAPER_ONBOARDING_VARIANT}function m(e){var o=e.file,r=e.user,t=e.sharedLink;return!!o&&((P(o)&&x.includes(i.OPEN_IN_PAPER_VARIANT)||A(o)&&C.includes(i.EMBED_TO_PAPER_VARIANT))&&!s.Viewer.get_viewer().is_assume_user_session&&!n.is_mobile_or_tablet()&&n.is_supported_paper_browser()&&(!r&&!!t||!!r&&!r.is_paper_disabled))}function A(e){var o=a.getExtension(e);return!!o&&E.includes(o)}function P(e){var o=a.getExtension(e);return!!o&&(B.includes(o)&&e.bytes<20971520)}function g(e){var o=d._("Copy to Paper");return A(e)&&(o=d._("Add to Paper doc")),o}function T(e,o){return A(e)&&o===p.SizeClass.Large}function k(e){return A(e)?d._("Bring it all together"):d._("Bring this doc to life")}function O(e){return A(e)?d._("Add this file to a Paper doc to collect ideas and organize your thoughts."):d._("Copy to Paper and make changes or ask for feedback.")}function w(e){var o=e.file,n=e.sharedLink,t=e.contUrl,i=e.successCallback,a=e.errorCallback,s=e.extension,l=e._tk,d=e.oqa,u=e.fromModal;r.WebRequest({url:"/paper/sign_request_data",data:{path:o.file_id,sharedLink:n,cont_url:t,extension:s,_tk:l,oqa:d,fromModal:u},success:i,error:a})}function I(e){var o=e.file,r=e.user,i=e.fromModal;if(!r)return void n.redirect(_.getSignInAndContinueUrl());var s=window.open("","_blank"),u=function(e){s?n.redirect(e,s):n.redirect(e)},p=function(){s&&s.close(),c.Notify.error(d._("Canâ€™t copy file to Paper"))},f=e.sharedLink?e.sharedLink:"",b=e.sharedLink?"shared_file_actions":"mounted_file_actions",h=a.getExtension(o);l.paperLog(l.PaperEventTypes.CTA_CLICK,{source:b,cta:"open_in_paper_button",extension:h});var m=h,A={file:o,sharedLink:f,contUrl:"/create-doc-from-dropbox-file",extension:h,successCallback:u,errorCallback:p,_tk:"dropbox_web_copy_from_previews",oqa:m,fromModal:i};if(P(o))w(A);else if(A._tk="dropbox_web_embed_from_previews",!f&&r){var g=new t.FileShareApiClient({userId:r.id});g.sharedLinkInfo({fileIdOrPath:o.file_id}).then(function(e){e?(A.sharedLink=e.url,A.contUrl="/dropbox-file-embed",w(A)):g.createSharedLink({fileIdOrPath:o.file_id}).then(function(e){A.sharedLink=e.url,A.contUrl="/dropbox-file-embed",w(A)}).catch(function(e){p&&p()})}).catch(function(e){p&&p()})}else A.contUrl="/dropbox-file-embed",w(A)}Object.defineProperty(o,"__esModule",{value:!0});var v,x=["VARIANT_A","VARIANT_B1","VARIANT_B2","VARIANT_B3","VARIANT_B4","ON"],C=["BUTTON","DROPDOWN","ELLIPSIS"],B=["docx"],E=["jpg","jpeg","png","pdf","xls","xlsx","mp4","mov","pptx","ppt","zip","rar","mp3"];(function(e){e[e.Off=1]="Off",e[e.Control=2]="Control",e[e.Button=3]="Button",e[e.Dropdown=4]="Dropdown",e[e.Ellipsis=5]="Ellipsis"})(v=o.OpenInPaperButtonVariant||(o.OpenInPaperButtonVariant={})),o.getOpenInPaperButtonVariant=f,o.getCalloutPosition=b,o.shouldShowEmbedToPaperModal=h,o.shouldShowOpenInPaper=m,o.fileSupportsEmbedToPaper=A,o.fileSupportsCopyToPaper=P,o.getCTAText=g,o.shouldShowCTADescription=T,o.getCalloutTitle=k,o.getCalloutMessage=O,o.createPaperAccountAndRedirect=w,o.openFileInPaper=I});
//# sourceMappingURL=utils.min.js-vflUiHxm4.map