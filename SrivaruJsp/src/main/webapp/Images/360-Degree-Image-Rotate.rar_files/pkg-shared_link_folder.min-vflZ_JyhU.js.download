define("modules/clean/loggers/folder_preview_logger",["require","exports","tslib","modules/clean/ajax","modules/core/browser","modules/constants/request","modules/clean/react/previews/constants","modules/clean/web_timing_logger","modules/clean/uuid","modules/constants/file_viewer"],function(e,r,t,n,o,i,a,l,s,d){"use strict";function c(e){return t.__assign({},e,{shared_link_folder_spa:d.SHARED_LINK_FOLDER_SPA?1:0,folder_preview_timeline:JSON.stringify(e.folder_preview_timeline),subfolder_nav_tracking:e.subfolder_nav_tracking?1:0,web_timing_data:JSON.stringify(e.web_timing_data)})}function u(e){var r=t.__assign({},e.extra),n=o.performance();if(null!=n){var i=n.timing;i&&i.fetchStart&&(r.time_to_first_byte=i.responseStart-i.fetchStart,r.web_timing_data=i)}var s=e.extra.source_action===a.PreviewSourceAction.Click?e.extra.start_time:l.start_time();s&&r.primary_mark_ts&&(r.time_to_primary_mark=r.primary_mark_ts-s);var d=c(r);return{device_type:e.deviceType,folder_preview_session_id:e.id,folder_ns_id:e.ns_id||0,web_request_id:e.web_request_id,extra:JSON.stringify(d)}}function f(e,r){return n.SilentBackgroundBeaconRequest({url:"/log/folder_preview",data:t.__assign({},u(r),{event_name:e})})}function p(e){var r=void 0===e?{}:e,t=r.id,n=r.ns_id,l=r.deviceType,d=r.web_request_id,c=r.source_action,u=r.subfolder_nav_tracking;return{id:t||s.v4({allowInsecure:!0}),ns_id:n||0,web_request_id:d||i.REQUEST_ID,deviceType:l||o.is_supported_mobile_browser()?h.mobile:o.is_tablet()?h.tablet:h.desktop,extra:{start_time:o.now(),subfolder_nav_tracking:u,source_action:c||a.PreviewSourceAction.Visit,folder_preview_timeline:{}}}}function m(e){if(!e.extra.primary_mark_ts){var r=o.now();e.extra.primary_mark_ts=r}}function _(e,r){var t=r.extra,n=t.folder_preview_timeline,i=o.now();switch(e){case v.attempted:if(n.preview_attempted_ts)return;n.preview_attempted_ts=i;break;case v.ended:if(n.preview_session_ended_ts)return;n.preview_session_ended_ts=i;break;case v.renderSucceeded:if(n.render_succeeded_ts)return;n.render_succeeded_ts=i;break;case v.renderFailed:if(n.render_failed_ts)return;n.render_failed_ts=i}return f(e,r)}Object.defineProperty(r,"__esModule",{value:!0});var h;(function(e){e.desktop="desktop",e.mobile="mobile",e.tablet="tablet"})(h=r.DeviceType||(r.DeviceType={}));var v;(function(e){e.attempted="preview_attempted",e.renderSucceeded="render_succeeded",e.renderFailed="render_failed",e.ended="preview_session_ended",e.appDownloadInterstitialClose="app_download_interstitial_close",e.appDownloadInterstitialContinue="app_download_interstitial_continue",e.appDownloadInterstitialInstall="app_download_interstitial_install",e.appDownloadInterstitialView="app_download_interstitial_view"})(v=r.EventType||(r.EventType={})),r.createSession=p,r.markPrimaryEvent=m,r.logEvent=_}),define("modules/clean/photos/batching_thumb_store",["require","exports","modules/clean/photos/thumb_loading/batching_thumb_loader","modules/clean/photos/thumb_loading/generic_thumb_store","modules/constants/request"],function(e,r,t,n,o){"use strict";return function(e){var r=!(!e||!e.allow_http2)&&e.allow_http2,i=o.IS_HTTP2&&r,a=i?void 0:new t.BatchingThumbLoader;return new n.GenericThumbStore(a,!i)}}),define("modules/clean/photos/thumb_loading/batching_thumb_loader",["require","exports","modules/clean/photos/batch_thumb_loader","modules/clean/photos/thumb_loading/utils"],function(e,r,t,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=(function(){function e(){this.batch_thumb_loader=new t.BatchThumbLoader({})}return e.prototype.get_request_id=function(){return this.batch_thumb_loader.vend_request_id()},e.prototype.load_image=function(e,r,t,n,o,i){this.batch_thumb_loader.queue_thumb(e,this._thumb_loaded.bind(this,{url:e,request_id:r,success:n,error:o,should_retry:i}),{onrequest:t,request_id:r}),window.setTimeout(this.batch_thumb_loader.flush.bind(this.batch_thumb_loader,10))},e.prototype._thumb_loaded=function(e,r){var t=e.url,o=(e.request_id,e.success),i=e.error,a=e.should_retry;r&&0===r.indexOf("data:")?o(r):n.load_individual_image(t,0,o,i,a)},e.prototype.cancel_thumb=function(e){this.batch_thumb_loader.cancel_thumb(e)},e})();r.BatchingThumbLoader=o}),define("modules/clean/prefetch/prefetch",["require","exports"],function(e,r){"use strict";function t(e){var r=window[e];if(r)return n(r)}function n(e){return new Promise(function(r,t){var n=e.getDataIfAvailable();n?n.payload?r(JSON.parse(n.payload)):t(n.error):e(function(e){return r(JSON.parse(e))},t)})}Object.defineProperty(r,"__esModule",{value:!0}),r.getPrefetchData=t}),define("modules/clean/react/shared_link/utils",["require","exports","modules/clean/history"],function(e,r,t){"use strict";function n(e){return function(r){r.ctrlKey||r.metaKey||e(r)}}function o(){s("preview")}function i(e){l("preview",e.filename)}function a(e){t.push_state(e.getPath(),e.getQuery())}function l(e,r){var n={};n[e]=r;var o=t.get_uri();o.updateQuery(n),a(o)}function s(e){var r=t.get_uri();r.removeQuery(e),a(r)}Object.defineProperty(r,"__esModule",{value:!0}),r.linkClickHandler=n,r.closeFile=o,r.openFile=i}),define("modules/clean/react/shared_link_folder/api",["require","exports","modules/clean/prefetch/prefetch","modules/clean/ajax"],function(e,r,t,n){"use strict";function o(e){return{is_dir:e.is_dir,filename:e.filename,sort_key:e.sort_key,href:e.href,bytes:e.bytes,direct_blockserver_link:e.direct_blockserver_link,ns_id:e.ns_id,preview_type:e.preview_type?e.preview_type:null,preview_url:e.preview_url,sjid:e.sjid,ts:e.ts,thumbnail_url_tmpl:e.thumbnail_url_tmpl,beacon_context:e.beacon_context,file_id:e.file_id,video_container:e.video_container,video_transcode_url:e.video_transcode_url,video_metadata_url:e.video_metadata_url,video_thumb_scrubber_vtt_url:e.video_thumb_scrubber_vtt_url,preview_ssr_image_url_tmpl:e.preview_ssr_image_url_tmpl,preview_ssr_text_url_tmpl:e.preview_ssr_text_url_tmpl,preview_ssr_refresh_url:e.preview_ssr_refresh_url,htmlified_link:e.htmlified_link,linkfile_data:e.linkfile_data,revision_id:e.revision_id,is_symlink:!1}}function i(e){return{_mount_access_perms:e._mount_access_perms,filename:e.filename,href:e.href,is_dir:e.is_dir,ns_id:e.ns_id,open_in_app_data:e.open_in_app_data,shared_folder_id:e.shared_folder_id,sort_key:e.sort_key}}function a(e){return{url:e.url,displayName:e.displayName,downloadTestUrl:e.downloadTestUrl,ownerName:e.ownerName,ownerTeamName:e.ownerTeamName,ownerTeamLogo:e.ownerTeamLogo}}function l(e){return{canCopyToDropboxRoles:e.canCopyToDropboxRoles,canDownloadRoles:e.canDownloadRoles,canPrintRoles:e.canPrintRoles,canRemoveLinkUids:e.canRemoveLinkUids,canSyncToDropboxRoles:e.canSyncToDropboxRoles,canViewContextMenuRoles:e.canViewContextMenuRoles,canViewMetadataRoles:e.canViewMetadataRoles}}function s(e){return{itemId:e.itemId,linkKey:e.linkKey,linkType:e.linkType,secureHash:e.secureHash,subPath:e.subPath}}function d(e){for(var r=[],t=0,n=e.entries;t<n.length;t++){var d=n[t];d.is_dir?r.push(i(d)):r.push(o(d))}var c=e.shared_link_infos.map(a),u=e.share_permissions.map(l),f=e.share_tokens.map(s);return{entries:r,folder:i(e.folder),folderSharedLinkInfo:a(e.folder_shared_link_info),folderSharePermission:l(e.folder_share_permission),folderShareToken:s(e.folder_share_token),hasMoreEntries:e.has_more_entries,nextRequestVoucher:e.next_request_voucher,sharedLinkInfos:c,sharePermissions:u,shareTokens:f,takedownRequestType:e.takedown_request_type}}function c(e,r,t){var o={link_key:e.linkKey,link_type:e.linkType,secure_hash:e.secureHash,sub_path:e.subPath||""};return r&&(o.voucher=r),new Promise(function(e,r){return n.WebRequest({type:"POST",url:"/list_shared_link_folder_entries",data:o,dataType:"json",success:function(r,n,o){if(t){var i=o.getResponseHeader("x-dropbox-request-id");t.end(i?i:void 0)}e(d(r))},error:function(e,t,n){r(new Error(n))}})})}function u(){var e=t.getPrefetchData("__REGISTER_SHARED_LINK_FOLDER_PRELOAD_HANDLER");if(e)return e.then(d)}function f(e){return u()||c(e)}function p(e,r){return c(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.fetchPage=c,r.prefetchFirstPage=f,r.fetchNextPage=p}),define("modules/clean/react/shared_link_folder/app",["require","exports","tslib","external/lodash","external/react","external/react-redux","modules/clean/loggers/folder_preview_logger","modules/clean/open_in_app/actions","modules/clean/react/async/loadable","modules/clean/react/file_viewer/data/actions","modules/clean/react/file_viewer/data/selectors","modules/clean/react/file_viewer/location_utils","modules/clean/react/location/with_location","modules/clean/react/shared_link/utils","modules/clean/react/previews/constants","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/store","modules/clean/react/shared_link_folder/page","modules/clean/viewer","modules/clean/web_timing_logger","modules/constants/python","modules/clean/web_timing_logger","modules/clean/react/shared_link_folder/utils","modules/clean/react/shared_link_folder/data/selectors"],function(e,r,t,n,o,i,a,l,s,d,c,u,f,p,m,_,h,v,g,w,b,y,k,S){"use strict";function E(){var e=y.get_timer();return e.timeToInteractive()&&(e=y.get_timer("shared_link_folder_ajax"),e.initialize({requireTTI:!0,requireTTV:!0,url:"shared_link_folder_ajax"})),e}function F(e,r){var t=c.getAppDownloadInterstitial(e);void 0===t&&(t=r.appDownloadInterstitialDismissed);var n=r.folderShareToken.secureHash,o=r.viewingFilename;return{appDownloadInterstitialDismissed:t,file:S.getSharedFilePackageByFilenameForFolderPath(e,n,o||""),folder:S.getFolderByPath(e,n),files:S.getSharedFilePackagesForFolderPath(e,n),subfolders:S.getSubfoldersForFolderPath(e,n)}}Object.defineProperty(r,"__esModule",{value:!0});var T=n.memoize(function(){return new Promise(function(r,t){e(["modules/clean/react/file_viewer/collection_viewer"],r,t)})});r.AsyncFileCollectionViewer=s.Loadable({loader:function(){return T().then(function(e){return e.FileCollectionViewer})}});var P=(function(e){function n(r){var t=e.call(this,r)||this,n=g.Viewer.get_viewer(),o=n.work_user||n.personal_user;return t.state={pageYOffset:0,user:o,previewSourceAction:m.PreviewSourceAction.Visit},t.folderPreviewSession=a.createSession({subfolder_nav_tracking:r.subfolderNavTracking}),t.webTimer=E(),t}return t.__extends(n,e),n.prototype.componentWillMount=function(){if(this.webTimer.applicationStart(),this.props.openImmediatelyInApp)return this.openImmediatelyInApp()},n.prototype.componentWillUnmount=function(){this.unsubscribe()},n.prototype.componentWillReceiveProps=function(e){!this.props.viewingFilename&&e.viewingFilename&&this.setState({pageYOffset:window.pageYOffset}),this.props.viewingFilename!==e.viewingFilename&&this.setState({previewSourceAction:m.PreviewSourceAction.Click}),(this.props.viewingFilename&&!e.viewingFilename||e.folderShareToken.secureHash!==this.props.folderShareToken.secureHash)&&(this.webTimer=E(),this.webTimer.restart(),this.folderPreviewSession=a.createSession({source_action:m.PreviewSourceAction.Click})),e.folder&&e.folder.folder&&k.setPageTitle(e.folder.folder.filename)},n.prototype.componentDidMount=function(){var e=this.props.folderShareToken;e&&this.props.onFolderPrefetch(e),w.waitForTTI().then(T)},n.prototype.componentDidUpdate=function(e,r){var t=this.props,n=t.viewingFilename,o=t.folderShareToken,i=this.state.pageYOffset;n!==e.viewingFilename&&(n||window.scrollTo(0,i)),o.secureHash!==e.folderShareToken.secureHash&&this.props.onFolderLoad(o,this.webTimer)},n.prototype.openImmediatelyInApp=function(){var e=this.props.folder;if(e)try{e.folder.open_in_app_data&&l.openImmediately(e.folder.open_in_app_data)}catch(e){}},n.prototype.render=function(){var e=this.props,t=e.accountMenuOptions,n=e.activityContext,i=e.appDownloadInterstitialDismissed,a=e.file,l=e.files,s=e.fileViewOrigin,d=e.fileViewTarget,c=e.folder,u=e.onAppDownloadInterstitialDismissed,f=e.outOfQuota,_=e.shouldForceListMode,h=e.showSyncCoachmark,g=e.subfolders,w=e.viewingFilename,y=this.state,S=y.user,E=y.previewSourceAction;if(w&&a){var F=[],T=[],P=[],I=[];return Array.isArray(l)&&l.length?l.forEach(function(e,r){T.push(e.shareToken),P.push(e.sharedLinkInfo),F.push(e.sharePermission),I.push(e.file)}):(I=[a.file],F=[a.sharePermission],T=[a.shareToken],P=[a.sharedLinkInfo]),o.createElement(r.AsyncFileCollectionViewer,{activityContext:n,canClose:!0,className:"no-background",file:a.file,files:I,fileViewOrigin:s,fileViewTarget:d,fileViewAction:b.FileViewActionType.CLICK,initialPreviewSourceContext:m.PreviewSourceContext.SharedLinkFolder,initialPreviewSourceAction:E,skipOuterRouting:!0,sharedLinkInfos:P,sharePermissions:F,shareTokens:T,onCloseViewer:p.closeFile,user:S})}if(!c)return null;var C=c.shareToken,L=c.sharedLinkInfo,O=c.folder,A=c.sharePermission,M=c.hasMore,N=c.takedownRequestType,x={files:Array.isArray(l)?l.map(function(e){return e.file}):[],folders:Array.isArray(g)?g.map(function(e){return e.folder}):[]};return o.createElement(v.SharedLinkFolderPage,{accountMenuOptions:t,appDownloadInterstitialDismissed:i,contents:x,folder:O,folderPreviewSession:this.folderPreviewSession,folderSharedLinkInfo:L,folderSharePermission:A,folderShareToken:C,hasMore:M,onAppDownloadInterstitialDismissed:u,onFileOpen:p.openFile,onFolderOpen:k.openFolder,onListModeDisable:k.disableListMode,onListModeEnable:k.enableListMode,outOfQuota:f,shouldForceListMode:_,showSyncCoachmark:h,takedownRequestType:N,user:S,webTimer:this.webTimer})},n})(o.PureComponent);r._SharedLinkFolderApp=P;var I=i.connect(F,{onAppDownloadInterstitialDismissed:d.dismissAppDownloadInterstitial,onFolderLoad:_.fetchFolder,onFolderPrefetch:_.prefetchFolder})(P),C=f.withLocation(I,function(e){return{folderShareToken:k.getFolderShareTokenFromUrl(e),viewingFilename:u.getFilenameFromLocation(e),shouldForceListMode:"lst"in e.query,subfolderNavTracking:"subfolder_nav_tracking"in e.query}}),L=(function(e){function r(r){var t=e.call(this,r)||this;return t.store=h.getStoreForSharedLinkFolder(),h.hydrateStore(t.store,{initialFolder:t.props.folderData,initialPreview:t.props.preview,folderSharedLinkInfo:t.props.folderSharedLinkInfo,folderSharePermission:t.props.folderSharePermission,folderShareToken:t.props.folderShareToken}),t}return t.__extends(r,e),r.prototype.render=function(){return o.createElement(i.Provider,{store:this.store},o.createElement(C,t.__assign({},this.props)))},r})(o.Component);r.SharedLinkFolderApp=L}),define("modules/clean/react/shared_link_folder/data/actions",["require","exports","tslib","modules/clean/file_store/actions","modules/clean/react/shared_link_folder/api","modules/clean/react/shared_link_folder/data/types","modules/clean/file_store/utils"],function(e,r,t,n,o,i,a){"use strict";function l(e){return e?{file:e.file,fileMetadata:t.__rest(e,["file"])}:{file:void 0,fileMetadata:void 0}}function s(e,r){var n=l(r),o=n.file,s=n.fileMetadata,d=o&&a.getFileStoreId(o);return{type:i.Actions.HydrateSharedFolder,payload:{fileId:d,fileMetadata:s,folderPackage:t.__assign({},e,{entries:e.entries.length?e.entries:d?[{type:"file",id:d}]:[]})}}}function d(e,r){return function(t){r&&t(n.putFile(r.file)),t(s(e,r))}}function c(e){return{type:i.Actions.FetchPageRequest,payload:e}}function u(e,r){return{type:i.Actions.FetchPageSuccess,payload:{fileMetadata:e,folderPackage:r}}}function f(e,r,t){void 0===t&&(t=0);var n=e.entries,o=e.hasMoreEntries,l=e.sharedLinkInfos,s=e.sharePermissions,d=e.shareTokens,c=e.takedownRequestType,u={},f=(m={},m[r]={entries:[],fromIndex:t,hasMore:o,takedownRequestType:c,folder:e.folder,sharedLinkInfo:e.folderSharedLinkInfo,sharePermission:e.folderSharePermission,shareToken:e.folderShareToken},m),p=[];return n.forEach(function(e,t){if(i.isFile(e)){var n=a.getFileStoreId(e);p.push(e),f[r].entries.push({type:"file",id:n}),u[n]={sharedLinkInfo:l[t],sharePermission:s[t],shareToken:d[t]}}else{var o=d[t].secureHash;f[r].entries.push({type:"folder",id:o}),f[o]={folder:e,fromIndex:0,hasMore:!0,sharedLinkInfo:l[t],sharePermission:s[t],shareToken:d[t]}}}),{files:p,fileMetadata:u,folderPackage:f};var m}function p(e,r){return function t(i,a){void 0===a&&(a=0);var l=f(i,r.secureHash,a),s=l.files,d=l.fileMetadata,c=l.folderPackage;e(n.putFiles(s)),e(u(d,c)),i.hasMoreEntries&&i.nextRequestVoucher&&o.fetchNextPage(r,i.nextRequestVoucher).then(function(e){return t(e,a+i.entries.length)})}}function m(e){return function(r){return r(c(e.secureHash)),o.prefetchFirstPage(e).then(p(r,e))}}function _(e,r){return function(t){return t(c(e.secureHash)),o.fetchPage(e,void 0,r).then(p(t,e))}}Object.defineProperty(r,"__esModule",{value:!0}),r.hydrateSharedFolderAndFile=d,r.fetchPageSuccess=u,r.prefetchFolder=m,r.fetchFolder=_}),define("modules/clean/react/shared_link_folder/data/reducer",["require","exports","tslib","modules/clean/react/shared_link_folder/data/types","modules/clean/react/shared_link_folder/utils"],function(e,r,t,n,o){"use strict";function i(e,r){switch(void 0===e&&(e=a),r.type){case n.Actions.FetchPageRequest:var i=r.payload,l=e.folderPackage[i];return l?t.__assign({},e,{folderPackage:t.__assign({},e.folderPackage,(h={},h[i]=t.__assign({},l,{hasMore:!0}),h))}):e;case n.Actions.HydrateSharedFolder:var s=r.payload,d=s.fileId,c=s.fileMetadata,u=s.folderPackage,i=u.shareToken.secureHash,f=null!=d?(v={},v[d]=c,v):{};return t.__assign({},e,{fileMetadata:t.__assign({},e.fileMetadata,f),folderPackage:t.__assign({},e.folderPackage,(g={},g[i]=t.__assign({},u,{hasMore:!0}),g))});case n.Actions.FetchPageSuccess:var p=r.payload,c=p.fileMetadata,m=p.folderPackage,_={};return Object.keys(m).forEach(function(r){var n=e.folderPackage[r]||{},i=m[r],a=i.fromIndex,l=t.__rest(i,["fromIndex"]);_[r]=t.__assign({},n,l,{entries:o.mergeFolderEntries(n.entries,l.entries,a,!l.hasMore)})}),t.__assign({},e,{fileMetadata:t.__assign({},e.fileMetadata,c),folderPackage:t.__assign({},e.folderPackage,_)})}return e;var h,v,g}Object.defineProperty(r,"__esModule",{value:!0});var a={fileMetadata:{},folderPackage:{}};r.sharedLinkFolderReducer=i}),define("modules/clean/react/shared_link_folder/data/selectors",["require","exports","tslib","external/lodash","modules/clean/redux/types","modules/clean/file_store/selectors"],function(e,r,t,n,o,i){"use strict";function a(e,r){var n=i.getFile(e,r);if(n){var o=c(e,r);return t.__assign({},o,{file:n})}}Object.defineProperty(r,"__esModule",{value:!0});var l=function(e){return e[o.SHARED_LINK_FOLDER_NAMESPACE_KEY]},s=function(e,r){return l(e).folderPackage[r]};r.getFolderByPath=function(e,r){return l(e).folderPackage[r]};var d=function(e,t){var n=r.getFolderByPath(e,t);return n?n.entries.filter(function(e){return"file"===e.type}).map(function(e){return e.id}):[]},c=function(e,r){return l(e).fileMetadata[r]},u=function(e,r,t){if(t){var o=d(e,r);return n.find(o,function(r){var n=i.getFile(e,r);return n&&n.filename===t})}};r.getSubfoldersForFolderPath=function(e,t){var n=r.getFolderByPath(e,t);if(n)return n.entries.filter(function(e){return"folder"===e.type}).map(function(r){return s(e,r.id)})},r.getSharedFilePackagesForFolderPath=function(e,r){return d(e,r).map(function(r){return a(e,r)}).filter(Boolean)},r.getSharedFilePackageByFilenameForFolderPath=function(e,r,t){var n=u(e,r,t);if(n)return a(e,n)}}),define("modules/clean/react/shared_link_folder/data/store",["require","exports","external/lodash","modules/clean/file_store/reducer","modules/clean/react/file_viewer/data/reducer","modules/clean/react/shared_link_folder/data/actions","modules/clean/react/shared_link_folder/data/reducer","modules/clean/redux/store","modules/clean/redux/types"],function(e,r,t,n,o,i,a,l,s){"use strict";function d(e,r){var t=r.initialPreview,n=r.initialFolder,o=r.folderSharedLinkInfo,a=r.folderSharePermission,l=r.folderShareToken,s={folder:n,sharedLinkInfo:o,sharePermission:a,shareToken:l,hasMore:!0,entries:[]};e.dispatch(i.hydrateSharedFolderAndFile(s,t))}Object.defineProperty(r,"__esModule",{value:!0}),r.getStoreForSharedLinkFolder=t.once(function(){var e=(r={},r[s.FILE_NAMESPACE_KEY]=n.fileNamespaceReducer,r[s.FILE_VIEWER_NAMESPACE_KEY]=o.fileViewerReducer,r[s.SHARED_LINK_FOLDER_NAMESPACE_KEY]=a.sharedLinkFolderReducer,r);return l.getStoreAndRegisterReducers(e);var r}),r.hydrateStore=d}),define("modules/clean/react/shared_link_folder/data/types",["require","exports"],function(e,r){"use strict";function t(e){return!e.is_dir}Object.defineProperty(r,"__esModule",{value:!0}),r.isFile=t;(function(e){e.HydrateSharedFolder="SHARED_FOLDER/HYDRATE",e.FetchPageSuccess="SHARED_FOLDER/FETCH_SUCCESS",e.FetchPageRequest="SHARED_FOLDER/FETCH_REQUEST"})(r.Actions||(r.Actions={}))}),define("modules/clean/react/shared_link_folder/folder_icon",["require","exports","external/react","modules/clean/react/shared_link_folder/utils","modules/clean/react/icon/icon_helper","modules/clean/react/icon/old_icons"],function(e,r,t,n,o,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SharedLinkFolderFolderIcon=function(e){var r=e.className,o=e.folder,a=e.size;return t.createElement(i.OldFolderIcon,{alt:o.filename,className:r,isConfidential:n.isNoAccessFolder(o),size:a})},r.SharedLinkFolderFolderIcon.defaultProps={size:o.ICON_SIZES.LARGE}}),define("modules/clean/react/shared_link_folder/grid",["require","exports","tslib","external/react","modules/clean/em_string","modules/clean/previews/constants","modules/clean/react/icon/old_icons","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link/utils","modules/clean/react/thumbnail","spectrum/tooltip"],function(e,r,t,n,o,i,a,l,s,d,c){"use strict";function u(e){var r=e.label,t=e.filename,o=n.createElement("span",{className:"sl-grid-filename"},r);return t===r?o:n.createElement(c.Tooltip,{positioning:"below",tooltipContent:t},o)}function f(e){var r=e.entry,t=e.onFolderOpen,i=e.onFileOpen,a=o.Emstring.em_snippet(r.filename,16);return r.is_dir?n.createElement(_,{folder:r,label:a,onOpen:t}):n.createElement(m,{file:r,label:a,onOpen:i})}function p(e){var r=e.entries,t=e.onFileOpen,o=e.onFolderOpen;return n.createElement("div",{className:"sl-grid"},n.createElement("div",{className:"sl-grid-header clearfix"},n.createElement("div",{className:"sl-grid-header-column sl-grid-header-column--sort"},"Sorted by name")),n.createElement("ol",{className:"sl-grid-body"},r.map(function(e){return n.createElement("li",{className:"sl-grid-cell",key:e.href},n.createElement(f,{entry:e,onFolderOpen:o,onFileOpen:t}))})))}Object.defineProperty(r,"__esModule",{value:!0});r.FileTitle=u,r.SharedLinkFolderGrid=p;var m=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleClick=s.linkClickHandler(function(e){e.preventDefault(),r.props.onOpen(r.props.file)}),r}return t.__extends(r,e),r.prototype.isVideo=function(){return this.props.file.preview_type===i.PreviewType.Video},r.prototype.render=function(){var e=this.props,r=e.file,t=e.label;return n.createElement("a",{href:r.href,onClick:this.handleClick,className:"sl-link sl-link--file"},n.createElement("div",{className:"sl-grid-thumbnail-container"},n.createElement(d.ThumbnailIcon,{alt:r.filename,className:"sl-grid-thumbnail",file:r,iconSize:a.ICON_SIZES.XLARGE}),this.isVideo()?n.createElement("div",{className:"sl-video-watermark"}):null),n.createElement(u,{label:t,filename:r.filename}))},r})(n.PureComponent);r.FileCell=m;var _=(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.handleClick=s.linkClickHandler(function(e){e.preventDefault(),r.props.onOpen(r.props.folder)}),r}return t.__extends(r,e),r.prototype.render=function(){var e=this.props,r=e.folder,t=e.label;return n.createElement("a",{href:r.href,onClick:this.handleClick,className:"sl-link sl-link--folder"},n.createElement("div",{className:"sl-grid-thumbnail-container"},n.createElement(l.SharedLinkFolderFolderIcon,{className:"sl-grid-thumbnail",folder:r,size:a.ICON_SIZES.XLARGE})),n.createElement(u,{label:t,filename:r.filename}))},r})(n.PureComponent);r.FolderCell=_}),define("modules/clean/react/shared_link_folder/list",["require","exports","external/react","spectrum/table","spectrum/media_table","modules/clean/datetime","modules/clean/em_string","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/thumbnail","modules/core/i18n","modules/core/uri","modules/clean/react/size_class/constants"],function(e,r,t,n,o,i,a,l,s,d,c,u){"use strict";function f(e){var r=e.entries,o=e.sizeClass,i=e.onFileOpen,a=e.onFolderOpen;return t.createElement(n.Table,{className:"sl-list-container"},t.createElement(n.TableHead,null,t.createElement(n.TableHeadCell,null,d._("Name")),o!==u.SizeClass.Small?t.createElement(n.TableHeadCell,null,d._("Modified",{comment:"label for last modified time"})):null),t.createElement(n.TableBody,null,r.map(function(e){return t.createElement(p,{key:e.href,entry:e,sizeClass:o,onFileOpen:i,onFolderOpen:a})})))}function p(e){var r=e.entry,n=e.sizeClass,o=e.onFolderOpen,i=e.onFileOpen;return r.is_dir?t.createElement(_,{folder:r,sizeClass:n,onOpen:o}):t.createElement(h,{file:r,sizeClass:n,onOpen:i})}function m(e){function r(e){e.preventDefault(),"function"==typeof c&&c()}var n=e.icon,l=e.lastModified,s=e.name,d=e.sizeClass,c=e.onClick,f=e.href;return t.createElement(o.MediaRow,{className:"sl-list-row"},t.createElement(o.MediaCell,{className:"sl-list-column--filename",icon:n,title:a.Emstring.em_snippet(s,40)},t.createElement("a",{href:f,"aria-label":s,onClick:r})),d!==u.SizeClass.Small?t.createElement(o.MediaCell,{className:"sl-list-column--modified",title:l?i.format_date(l,i.localized_datetime_format):"--"}):null)}function _(e){var r=e.folder,n=e.sizeClass,o=e.onOpen,i=c.URI.parse(r.href).updateQuery({lst:""}),a=i.toString();return t.createElement(m,{icon:t.createElement(l.SharedLinkFolderFolderIcon,{className:"sl-list-icon",folder:r}),href:a,name:r.filename,onClick:function(){return o(r)},sizeClass:n})}function h(e){var r=e.file,n=e.sizeClass,o=e.onOpen;return t.createElement(m,{icon:t.createElement(s.ThumbnailIcon,{alt:r.filename,className:"sl-list-icon",file:r}),lastModified:new Date(1e3*r.ts),name:r.filename,href:r.href,onClick:function(){return o(r)},sizeClass:n})}Object.defineProperty(r,"__esModule",{value:!0});r.SharedLinkFolderList=f}),define("modules/clean/react/shared_link_folder/page",["require","exports","tslib","external/classnames","external/react","modules/clean/analytics","modules/clean/components/loading_indicator","modules/clean/react/browse/sort_helpers","modules/clean/react/css","modules/clean/react/async/loadable","modules/clean/em_string","modules/clean/previews/responsive_utils","modules/clean/react/open_in_app/banner","modules/clean/react/shared_link_folder/folder_icon","modules/clean/react/shared_link_folder/grid","modules/clean/react/shared_link_folder/list","modules/clean/react/shared_link_folder/view_toggle","modules/clean/react/takedown_warning","modules/clean/sharing/constants","modules/clean/web_timing_logger","modules/constants/trademark","modules/core/i18n","modules/core/uri","modules/clean/react/icon/icon_helper","modules/clean/react/size_class/size_class","modules/clean/react/size_class/constants","modules/clean/loggers/folder_preview_logger","modules/clean/react/file_viewer/app_download_interstitial/app_download_interstitial"],function(e,r,t,n,o,i,a,l,s,d,c,u,f,p,m,_,h,v,g,w,b,y,k,S,E,F,T,P){"use strict";function I(e,r){return l.compare(e.sort_key,r.sort_key,1)}function C(e,r){return void 0===e&&(e=[]),void 0===r&&(r=[]),r.concat(e).sort(I)}function L(e){return o.createElement("div",{className:"sl-body sl-body--empty-folder"},o.createElement(p.SharedLinkFolderFolderIcon,{className:"sl-empty-folder-icon",folder:e.folder,size:S.ICON_SIZES.XLARGE}),o.createElement("h3",{className:"sl-empty-folder-message"},y._("This folder is empty")))}function O(e){var r=e.files,t=e.folder,n=e.hasMore,i=e.shouldForceListMode,a=e.sizeClass,l=e.subfolders,s=e.onFileOpen,d=e.onFolderOpen,c=C(r,l);return c.length||n?o.createElement("div",{className:"sl-body"},i?[o.createElement(_.SharedLinkFolderList,{key:"list",entries:c,sizeClass:a,onFolderOpen:d,onFileOpen:s}),o.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"grid_light",label:y._("View as grid"),onClick:e.onListModeDisable})]:[o.createElement(m.SharedLinkFolderGrid,{key:"grid",entries:c,onFolderOpen:d,onFileOpen:s}),o.createElement(h.FolderViewToggleOption,{key:"toggler",icon:"list_light",label:y._("View as list"),onClick:e.onListModeEnable})]):o.createElement(L,{folder:t})}function A(e){var r=e.title,t=e.ownerName,n=e.ownerTeamName,i=e.ownerTeamLogo,a=e.sizeClass;return o.createElement("span",null,r,a===F.SizeClass.Small?o.createElement("br",null):null,o.createElement(M,{ownerName:t,ownerTeamName:n,ownerTeamLogo:i}))}function M(e){var r=e.ownerName,t=e.ownerTeamName,n=e.ownerTeamLogo;return t?o.createElement("div",{className:"sl-subtitle"},null!=r?y._("from %(owner)s (%(team)s)").format({owner:r,team:t}):y._("from %(team)s").format({team:t}),null!=n?o.createElement("span",null," ","via ",o.createElement("a",{href:q},b.TRADEMARK_BUSINESS)):null):null}Object.defineProperty(r,"__esModule",{value:!0});var N=d.Loadable({loader:function(){return new Promise(function(r,t){e(["modules/clean/react/shared_link_folder/title_bar"],r,t)}).then(function(e){return e.SharedLinkFolderTitleBar})}}),x=(function(e){function r(r){var t=e.call(this,r)||this;return t.state={openInAppBannerClosed:!1},t.shouldShowOpenInAppBanner=function(){var e=t.props.folder,r=t.state.openInAppBannerClosed;return e&&e.open_in_app_data&&!r},t.onOpenInAppClosed=function(){t.setState({openInAppBannerClosed:!0})},t.onInterstitialClose=function(){T.logEvent(T.EventType.appDownloadInterstitialClose,t.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onInterstitialContinue=function(){T.logEvent(T.EventType.appDownloadInterstitialContinue,t.folderPreviewSession),t.props.onAppDownloadInterstitialDismissed()},t.onAppDownload=function(){T.logEvent(T.EventType.appDownloadInterstitialInstall,t.folderPreviewSession)},t.folderPreviewSession=r.folderPreviewSession,r.folder&&(t.folderPreviewSession.ns_id=r.folder.ns_id),t}return t.__extends(r,e),r.prototype.componentWillMount=function(){T.logEvent(T.EventType.attempted,this.folderPreviewSession)},r.prototype.componentWillUnmount=function(){T.logEvent(T.EventType.ended,this.folderPreviewSession)},r.prototype.componentDidMount=function(){this.ensureWebTimingMarked(),this.logSclTiming(),this.shouldShowAppDownloadInterstitial()&&T.logEvent(T.EventType.appDownloadInterstitialView,this.folderPreviewSession)},r.prototype.componentDidUpdate=function(){this.ensureWebTimingMarked()},r.prototype.componentWillReceiveProps=function(e){this.folderPreviewSession=e.folderPreviewSession,e.folder&&(this.folderPreviewSession.ns_id=e.folder.ns_id)},r.prototype.shouldShowAppDownloadInterstitial=function(){var e=this.props,r=e.folder;return!e.appDownloadInterstitialDismissed&&r&&r.open_in_app_data},r.prototype.ensureWebTimingMarked=function(){var e=this.props,r=e.contents,t=r.files,n=r.folders,o=e.hasMore,i=e.webTimer;(t.length>0||n.length>0||!o)&&(i&&(i.timeToView()||i.markTimeToView(),i.timeToInteractive()||i.markTimeToInteractive()),T.markPrimaryEvent(this.folderPreviewSession),T.logEvent(T.EventType.renderSucceeded,this.folderPreviewSession))},r.prototype.logSclTiming=function(){if(this.props.user&&this.props.folderShareToken.linkType===g.SharedLinkType.Content){var e=(new Date).getTime(),r={ns_id:this.props.folder.shared_folder_id,timing:e-w.start_time()};i.ShareTibEventLogger.log(this.props.user.id,"PREVIEW_RENDER",g.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE,r)}},r.prototype.render=function(){var e,r=this.props,t=r.accountMenuOptions,i=r.contents,l=r.folder,s=r.folderSharedLinkInfo,d=r.folderSharePermission,u=r.folderShareToken,p=r.hasMore,m=r.outOfQuota,_=r.shouldForceListMode,h=r.showSyncCoachmark,g=r.sizeClass,w=r.takedownRequestType,b=r.user,y=r.onFileOpen,k=r.onFolderOpen,S=o.createElement(A,{sizeClass:g,title:c.Emstring.em_snippet(s.displayName,g!==F.SizeClass.Small?35:20),ownerName:s.ownerName,ownerTeamName:s.ownerTeamName,
ownerTeamLogo:s.ownerTeamLogo}),E=n({"sl-page-body":!0,"view-in-app-bar-present":this.shouldShowOpenInAppBanner()});if(this.shouldShowAppDownloadInterstitial()){var T=s.displayName;e=o.createElement("div",{"aria-label":T},o.createElement(P.AppDownloadInterstitial,{isFolder:!0,fileOrFolderName:T,open_in_app_data:l.open_in_app_data,ownerName:s.ownerName,ownerTeamName:s.ownerTeamName,onClose:this.onInterstitialClose,onContinue:this.onInterstitialContinue,onAppDownload:this.onAppDownload}))}return o.createElement("div",null,o.createElement("div",{className:"sl-page-container"},o.createElement("div",{className:"sl-page-header"},o.createElement(N,{accountMenuOptions:t,folder:l,outOfQuota:m,sharedLinkInfo:s,shareToken:u,sharePermission:d,showSyncCoachmark:h,sizeClass:g,title:g===F.SizeClass.Small?S:void 0,user:b}),this.shouldShowOpenInAppBanner()?o.createElement(f.OpenInAppBanner,{urls:l.open_in_app_data,onClose:this.onOpenInAppClosed}):null),o.createElement("div",{className:E},o.createElement("div",{className:"sl-header clearfix"},o.createElement("h3",{className:"sl-title"},null!=w?o.createElement("div",{className:"sl-takedown-warning"},o.createElement(v,{type:w})):null,g!==F.SizeClass.Small?S:null)),o.createElement(O,{files:i.files,folder:l,hasMore:p,shouldForceListMode:_,sizeClass:g,subfolders:i.folders,onListModeDisable:this.props.onListModeDisable,onListModeEnable:this.props.onListModeEnable,onFolderOpen:k,onFileOpen:y}),p?o.createElement("div",{className:"sl-loading-indicator"},o.createElement(a.LoadingIndicator,{style:a.LoadingIndicator.LoadingIndicatorStyle.BLUE_SPINNER})):null)),e)},r.defaultProps={shouldForceListMode:!1,webTimer:w.get_timer()},r})(o.PureComponent);r._SharedLinkFolderPage=x;var D=s(x,["/static/css/react_title_bar-vflzpT8c1.css","/static/css/react_file_viewer-vflnqLj1q.css"]),R=E.withSizeClass(D,{isResponsiveEnabled:u.isResponsiveEnabled});r.SharedLinkFolderPage=R;var q=new k.URI({scheme:"https",authority:"www.dropbox.com",path:"/business",query:{src:"schmodel"}}).toString()}),define("modules/clean/react/shared_link_folder/utils",["require","exports","modules/core/uri","modules/clean/history","modules/core/notify","modules/core/i18n","modules/clean/sharing/constants","modules/clean/viewer","modules/constants/file_viewer","modules/core/browser"],function(e,r,t,n,o,i,a,l,s,d){"use strict";function c(e){var r=e._mount_access_perms;return null!=r&&!r.includes("can_view")}function u(e){var r=e.getPath();try{decodeURIComponent(r)}catch(e){r=t.URI.encode_parts(r)}n.push_state(r,e.getQuery())}function f(e,r){var t={};t[e]=r;var o=n.get_uri();o.updateQuery(t),u(o)}function p(e){var r=n.get_uri();r.removeQuery(e),u(r)}function m(e){if(c(e))return void o.Notify.error(i._("Can’t open %(folder_name)s. Ask your admin for access.").format({folder_name:e.filename}));var r=t.URI.parse(e.href);"lst"in n.get_uri().getQuery()&&r.updateQuery({lst:""}),r.updateQuery({subfolder_nav_tracking:"1"}),s.SHARED_LINK_FOLDER_SPA?u(r):d.redirect(r)}function _(){f("lst","")}function h(){p("lst")}function v(e){var r=e.path,t=a.SharedLinkType.Shmodel;"/sh"===r.substr(0,3)?(t=a.SharedLinkType.Shmodel,r=r.substring(4,r.length)):"/scl/fo"===r.substr(0,7)&&(t=a.SharedLinkType.Content,r=r.substring(8,r.length));var n=r.split("/");return{linkKey:n[0],linkType:t,secureHash:n[1],subPath:n.slice(2).join("/")}}function g(e){return l.Viewer.get_viewer().is_signed_in?i._("%(folder_name)s - Dropbox").format({folder_name:e}):i._("Dropbox - %(folder_name)s - Simplify your life").format({folder_name:e})}function w(e){document.title=g(e)}function b(e,r,t,n){if(void 0===t&&(t=0),void 0===n&&(n=!1),!Array.isArray(r))return e||[];if(!r.length)return[];if(!Array.isArray(e))return r;var o=e.slice();return o.splice.apply(o,[t,r.length].concat(r)),n?o.slice(0,t+r.length):o}Object.defineProperty(r,"__esModule",{value:!0}),r.isNoAccessFolder=c,r.openFolder=m,r.enableListMode=_,r.disableListMode=h,r.getFolderShareTokenFromUrl=v,r.generatePageTitle=g,r.setPageTitle=w,r.mergeListChunk=b,r.mergeFolderEntries=b}),define("modules/clean/react/shared_link_folder/view_toggle",["require","exports","external/classnames","external/react","modules/clean/react/sprite"],function(e,r,t,n,o){"use strict";function i(e){var r=e.icon,i=e.label,a=e.onClick;return n.createElement("button",{"aria-label":i,className:t({"sl-view-toggle-option":!0}),name:i,onClick:a,value:i},n.createElement(o.Sprite,{group:"web",name:r,alt:i}))}Object.defineProperty(r,"__esModule",{value:!0}),r.FolderViewToggleOption=i}),define("modules/clean/react/takedown_warning",["require","exports","tslib","external/react","external/react-dom-factories","external/prop-types","modules/clean/react_format","modules/constants/python","modules/core/i18n"],function(e,r,t,n,o,i,a,l,s){"use strict";var d=o.a,c=o.div;return(function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r._getWarningMessage=function(){switch(r.props.type){case l.TakedownRequestTypes.DMCA:return a.reactFormat(s._("Certain files in this folder can’t be shared due to a takedown request in accordance with the DMCA. <a>Learn more</a>"),{a:d({target:"_top",href:"/help/210"})});default:return a.reactFormat(s._("Certain files in this folder are unavailable. For more information <a>contact Dropbox support</a>."),{a:d({target:"_top",href:"/ticket"})})}},r}return t.__extends(r,e),r.prototype.render=function(){return c({className:"notify server-success"},this._getWarningMessage())},r.displayName="TakedownWarning",r.propTypes={type:i.number},r})(n.Component)}),define("modules/clean/react/thumbnail",["require","exports","tslib","external/classnames","external/react","modules/clean/photos/batching_thumb_store","modules/clean/react/icon/old_icons","modules/constants/python","modules/core/uri","modules/clean/file_store/utils"],function(e,r,t,n,o,i,a,l,s,d){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var c=i(),u=(function(e){function r(r){var t=e.call(this,r)||this;return t.bindingId=null,t.handleImageError=function(){t.setState({src:null})},t.state=t.getStateForTemplateUrl(t.props.file.thumbnail_url_tmpl),t}return t.__extends(r,e),r.prototype.componentDidMount=function(){this.bindThumbStore()},r.prototype.componentWillReceiveProps=function(e){var r=e.file.thumbnail_url_tmpl;r!==this.props.file.thumbnail_url_tmpl&&this.setState(this.getStateForTemplateUrl(r))},r.prototype.componentWillUpdate=function(){this.unbindThumbStore()},r.prototype.componentDidUpdate=function(){this.bindThumbStore()},r.prototype.componentWillUnmount=function(){this.unbindThumbStore()},r.prototype.bindThumbStore=function(){var e=this;if(this.state.isLoading&&!this.bindingId){var r=this.state.url;r&&(this.bindingId=c.bind_url(r,{onSuccess:function(){e.setState({isLoading:!1,src:c.get_thumb(r)})},onError:function(){e.setState({isLoading:!1})}}))}},r.prototype.unbindThumbStore=function(){this.bindingId&&(c.unbind_url(this.bindingId),this.bindingId=null)},r.prototype.getStateForTemplateUrl=function(e){var t=null;if(!e)return{isLoading:!1,src:null};var n=r.getThumbnailUrl(e);return n&&(t=c.get_thumb(n)),{isLoading:!!n&&!t,src:t,url:n}},r.getThumbnailUrl=function(e){if(e){var r=s.URI.parse(e);return r.updateQuery("size","178x178"),r.updateQuery("size_mode",l.THUMBNAIL_SIZE_MODE.EXACT.toString()),r.toString()}},r.prototype.render=function(){var e,r=this.props,t=r.alt,i=r.file,l=r.iconSize,s=r.className,c=this.state.src;return c?(e=["icon","thumbnail-image--loaded",s],o.createElement("img",{alt:t,className:n(e),src:c,onError:this.handleImageError})):(e=["icon","thumbnail-image--failed",s],o.createElement(a.OldFileIcon,{alt:t,className:n(e),filename:d.getFilename(i),size:l}))},r.displayName="ThumbnailIcon",r})(o.Component);r.ThumbnailIcon=u});
//# sourceMappingURL=pkg-shared_link_folder.min.js-vfl7OXKx3.map