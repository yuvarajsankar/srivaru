define(["require","exports","modules/clean/ajax","modules/clean/react/file_viewer/models","modules/clean/react/pass/constants","modules/clean/react/pass/action_timestamps"],function(e,n,t,s,i,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a={};a[i.EventTypes.PASS_SHOWN]="pass_shown",a[i.EventTypes.PASS_HOVER]="pass_hover",a[i.EventTypes.PASS_CLICK]="pass_click";var o=(function(){function e(){this.eventToHandlerStack={};for(var e=0,n=[i.EventTypes.PASS_SHOWN,i.EventTypes.PASS_HOVER,i.EventTypes.PASS_CLICK];e<n.length;e++){var t=n[e];this.eventToHandlerStack[t]=[]}}return e.prototype._log=function(e,n,i,o){var c=n?"BROWSE_FILE_FACEPILE":"PREVIEW_PAGE_FACEPILE",l={};if(!n){var _=s.FilePreviewSession.currentSession;o.file_viewer_session_id=_.fileViewerSession.id,o.file_preview_session_id=_.id,l=r.ActionTimestampsTracker.get(_.id)}var p=new Date,u={event_name:a[e],file_ns_id:i.ns_id,file_sjid:i.sjid,origin:c,extra:JSON.stringify(o),action_timestamps:JSON.stringify(l),client_ts:p.getTime()/1e3};t.SilentBackgroundRequest({url:"/log/pass_facepile",data:u})},e.prototype.listenTo=function(e){this._unlistenToTopOfHandlersStack(e),this._pushHandlers(),this._listenToTopOfHandlersStack(e)},e.prototype.unlistenTo=function(e){this._unlistenToTopOfHandlersStack(e),this._popHandlers(),this._listenToTopOfHandlersStack(e)},e.prototype._unlistenToTopOfHandlersStack=function(e){for(var n in this.eventToHandlerStack)if(this.eventToHandlerStack.hasOwnProperty(n)){if(0===this.eventToHandlerStack[n].length)continue;var t=this.eventToHandlerStack[n].slice(-1)[0];e.removeListener(n,t)}},e.prototype._listenToTopOfHandlersStack=function(e){for(var n in this.eventToHandlerStack)if(this.eventToHandlerStack.hasOwnProperty(n)){if(0===this.eventToHandlerStack[n].length)continue;var t=this.eventToHandlerStack[n].slice(-1)[0];e.addListener(n,t)}},e.prototype._pushHandlers=function(){for(var e in this.eventToHandlerStack)if(this.eventToHandlerStack.hasOwnProperty(e)){var n=this._createHandlerFn(e);this.eventToHandlerStack[e].push(n)}},e.prototype._popHandlers=function(){for(var e in this.eventToHandlerStack)this.eventToHandlerStack.hasOwnProperty(e)&&this.eventToHandlerStack[e].pop()},e.prototype._createHandlerFn=function(e){var n=this;return function(t,s,i){n._log(e,t,s,{num_accessors:i.numAccessors,num_current_viewers:i.numCurrentViewers,num_viewers:i.numViewers,num_guests:i.numGuests,num_in_team_editors:i.numInTeamEditors,num_in_team_viewers:i.numInTeamViewers,num_non_team_editors:i.numNonTeamEditors,num_non_team_viewers:i.numNonTeamViewers,can_see_viewer_history:i.canSeeViewerHistory})}},e})();n.passFacepileLogger=new o});
//# sourceMappingURL=pass_facepile_logger.min.js-vfl0t_ilv.map